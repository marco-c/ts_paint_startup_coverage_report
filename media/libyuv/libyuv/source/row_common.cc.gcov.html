<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - output.info - media/libyuv/libyuv/source/row_common.cc</title>
  <link rel="stylesheet" type="text/css" href="../../../../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../../../../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../../../../index.html">top level</a> - <a href="index.html">media/libyuv/libyuv/source</a> - row_common.cc<span style="font-size: 80%;"> (source / <a href="row_common.cc.func-sort-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">output.info</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntry">1388</td>
            <td class="headerCovTableEntryLo">0.0 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2017-07-14 16:53:18</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntry">119</td>
            <td class="headerCovTableEntryLo">0.0 %</td>
          </tr>
          <tr>
            <td class="headerItem">Legend:</td>
            <td class="headerValueLeg">            Lines:
            <span class="coverLegendCov">hit</span>
            <span class="coverLegendNoCov">not hit</span>
</td>
            <td></td>
          </tr>
          <tr><td><img src="../../../../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../../../../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">          Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>            : /*</a>
<span class="lineNum">       2 </span>            :  *  Copyright 2011 The LibYuv Project Authors. All rights reserved.
<span class="lineNum">       3 </span>            :  *
<span class="lineNum">       4 </span>            :  *  Use of this source code is governed by a BSD-style license
<span class="lineNum">       5 </span>            :  *  that can be found in the LICENSE file in the root of the source
<span class="lineNum">       6 </span>            :  *  tree. An additional intellectual property rights grant can be found
<span class="lineNum">       7 </span>            :  *  in the file PATENTS. All contributing project authors may
<span class="lineNum">       8 </span>            :  *  be found in the AUTHORS file in the root of the source tree.
<span class="lineNum">       9 </span>            :  */
<span class="lineNum">      10 </span>            : 
<span class="lineNum">      11 </span>            : #include &quot;libyuv/row.h&quot;
<span class="lineNum">      12 </span>            : 
<span class="lineNum">      13 </span>            : #include &lt;string.h&gt;  // For memcpy and memset.
<span class="lineNum">      14 </span>            : 
<span class="lineNum">      15 </span>            : #include &quot;libyuv/basic_types.h&quot;
<span class="lineNum">      16 </span>            : 
<span class="lineNum">      17 </span>            : #ifdef __cplusplus
<span class="lineNum">      18 </span>            : namespace libyuv {
<span class="lineNum">      19 </span>            : extern &quot;C&quot; {
<span class="lineNum">      20 </span>            : #endif
<span class="lineNum">      21 </span>            : 
<span class="lineNum">      22 </span>            : // llvm x86 is poor at ternary operator, so use branchless min/max.
<span class="lineNum">      23 </span>            : 
<a name="24"><span class="lineNum">      24 </span>            : #define USE_BRANCHLESS 1</a>
<span class="lineNum">      25 </span>            : #if USE_BRANCHLESS
<span class="lineNum">      26 </span><span class="lineNoCov">          0 : static __inline int32 clamp0(int32 v) {</span>
<span class="lineNum">      27 </span><span class="lineNoCov">          0 :   return ((-(v) &gt;&gt; 31) &amp; (v));</span>
<a name="28"><span class="lineNum">      28 </span>            : }</a>
<span class="lineNum">      29 </span>            : 
<span class="lineNum">      30 </span><span class="lineNoCov">          0 : static __inline int32 clamp255(int32 v) {</span>
<span class="lineNum">      31 </span><span class="lineNoCov">          0 :   return (((255 - (v)) &gt;&gt; 31) | (v)) &amp; 255;</span>
<a name="32"><span class="lineNum">      32 </span>            : }</a>
<span class="lineNum">      33 </span>            : 
<span class="lineNum">      34 </span><span class="lineNoCov">          0 : static __inline uint32 Clamp(int32 val) {</span>
<span class="lineNum">      35 </span><span class="lineNoCov">          0 :   int v = clamp0(val);</span>
<span class="lineNum">      36 </span><span class="lineNoCov">          0 :   return (uint32)(clamp255(v));</span>
<a name="37"><span class="lineNum">      37 </span>            : }</a>
<span class="lineNum">      38 </span>            : 
<span class="lineNum">      39 </span><span class="lineNoCov">          0 : static __inline uint32 Abs(int32 v) {</span>
<span class="lineNum">      40 </span><span class="lineNoCov">          0 :   int m = v &gt;&gt; 31;</span>
<span class="lineNum">      41 </span><span class="lineNoCov">          0 :   return (v + m) ^ m;</span>
<span class="lineNum">      42 </span>            : }
<span class="lineNum">      43 </span>            : #else   // USE_BRANCHLESS
<span class="lineNum">      44 </span>            : static __inline int32 clamp0(int32 v) {
<span class="lineNum">      45 </span>            :   return (v &lt; 0) ? 0 : v;
<span class="lineNum">      46 </span>            : }
<span class="lineNum">      47 </span>            : 
<span class="lineNum">      48 </span>            : static __inline int32 clamp255(int32 v) {
<span class="lineNum">      49 </span>            :   return (v &gt; 255) ? 255 : v;
<span class="lineNum">      50 </span>            : }
<span class="lineNum">      51 </span>            : 
<span class="lineNum">      52 </span>            : static __inline uint32 Clamp(int32 val) {
<span class="lineNum">      53 </span>            :   int v = clamp0(val);
<span class="lineNum">      54 </span>            :   return (uint32)(clamp255(v));
<span class="lineNum">      55 </span>            : }
<span class="lineNum">      56 </span>            : 
<span class="lineNum">      57 </span>            : static __inline uint32 Abs(int32 v) {
<span class="lineNum">      58 </span>            :   return (v &lt; 0) ? -v : v;
<span class="lineNum">      59 </span>            : }
<span class="lineNum">      60 </span>            : #endif  // USE_BRANCHLESS
<span class="lineNum">      61 </span>            : 
<span class="lineNum">      62 </span>            : #ifdef LIBYUV_LITTLE_ENDIAN
<span class="lineNum">      63 </span>            : #define WRITEWORD(p, v) *(uint32*)(p) = v
<span class="lineNum">      64 </span>            : #else
<span class="lineNum">      65 </span>            : static inline void WRITEWORD(uint8* p, uint32 v) {
<span class="lineNum">      66 </span>            :   p[0] = (uint8)(v &amp; 255);
<span class="lineNum">      67 </span>            :   p[1] = (uint8)((v &gt;&gt; 8) &amp; 255);
<span class="lineNum">      68 </span>            :   p[2] = (uint8)((v &gt;&gt; 16) &amp; 255);
<span class="lineNum">      69 </span>            :   p[3] = (uint8)((v &gt;&gt; 24) &amp; 255);
<span class="lineNum">      70 </span>            : }
<a name="71"><span class="lineNum">      71 </span>            : #endif</a>
<span class="lineNum">      72 </span>            : 
<span class="lineNum">      73 </span><span class="lineNoCov">          0 : void RGB24ToARGBRow_C(const uint8* src_rgb24, uint8* dst_argb, int width) {</span>
<span class="lineNum">      74 </span>            :   int x;
<span class="lineNum">      75 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width; ++x) {</span>
<span class="lineNum">      76 </span><span class="lineNoCov">          0 :     uint8 b = src_rgb24[0];</span>
<span class="lineNum">      77 </span><span class="lineNoCov">          0 :     uint8 g = src_rgb24[1];</span>
<span class="lineNum">      78 </span><span class="lineNoCov">          0 :     uint8 r = src_rgb24[2];</span>
<span class="lineNum">      79 </span><span class="lineNoCov">          0 :     dst_argb[0] = b;</span>
<span class="lineNum">      80 </span><span class="lineNoCov">          0 :     dst_argb[1] = g;</span>
<span class="lineNum">      81 </span><span class="lineNoCov">          0 :     dst_argb[2] = r;</span>
<span class="lineNum">      82 </span><span class="lineNoCov">          0 :     dst_argb[3] = 255u;</span>
<span class="lineNum">      83 </span><span class="lineNoCov">          0 :     dst_argb += 4;</span>
<span class="lineNum">      84 </span><span class="lineNoCov">          0 :     src_rgb24 += 3;</span>
<span class="lineNum">      85 </span>            :   }
<a name="86"><span class="lineNum">      86 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">      87 </span>            : 
<span class="lineNum">      88 </span><span class="lineNoCov">          0 : void RAWToARGBRow_C(const uint8* src_raw, uint8* dst_argb, int width) {</span>
<span class="lineNum">      89 </span>            :   int x;
<span class="lineNum">      90 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width; ++x) {</span>
<span class="lineNum">      91 </span><span class="lineNoCov">          0 :     uint8 r = src_raw[0];</span>
<span class="lineNum">      92 </span><span class="lineNoCov">          0 :     uint8 g = src_raw[1];</span>
<span class="lineNum">      93 </span><span class="lineNoCov">          0 :     uint8 b = src_raw[2];</span>
<span class="lineNum">      94 </span><span class="lineNoCov">          0 :     dst_argb[0] = b;</span>
<span class="lineNum">      95 </span><span class="lineNoCov">          0 :     dst_argb[1] = g;</span>
<span class="lineNum">      96 </span><span class="lineNoCov">          0 :     dst_argb[2] = r;</span>
<span class="lineNum">      97 </span><span class="lineNoCov">          0 :     dst_argb[3] = 255u;</span>
<span class="lineNum">      98 </span><span class="lineNoCov">          0 :     dst_argb += 4;</span>
<span class="lineNum">      99 </span><span class="lineNoCov">          0 :     src_raw += 3;</span>
<span class="lineNum">     100 </span>            :   }
<a name="101"><span class="lineNum">     101 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     102 </span>            : 
<span class="lineNum">     103 </span><span class="lineNoCov">          0 : void RAWToRGB24Row_C(const uint8* src_raw, uint8* dst_rgb24, int width) {</span>
<span class="lineNum">     104 </span>            :   int x;
<span class="lineNum">     105 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width; ++x) {</span>
<span class="lineNum">     106 </span><span class="lineNoCov">          0 :     uint8 r = src_raw[0];</span>
<span class="lineNum">     107 </span><span class="lineNoCov">          0 :     uint8 g = src_raw[1];</span>
<span class="lineNum">     108 </span><span class="lineNoCov">          0 :     uint8 b = src_raw[2];</span>
<span class="lineNum">     109 </span><span class="lineNoCov">          0 :     dst_rgb24[0] = b;</span>
<span class="lineNum">     110 </span><span class="lineNoCov">          0 :     dst_rgb24[1] = g;</span>
<span class="lineNum">     111 </span><span class="lineNoCov">          0 :     dst_rgb24[2] = r;</span>
<span class="lineNum">     112 </span><span class="lineNoCov">          0 :     dst_rgb24 += 3;</span>
<span class="lineNum">     113 </span><span class="lineNoCov">          0 :     src_raw += 3;</span>
<span class="lineNum">     114 </span>            :   }
<a name="115"><span class="lineNum">     115 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     116 </span>            : 
<span class="lineNum">     117 </span><span class="lineNoCov">          0 : void RGB565ToARGBRow_C(const uint8* src_rgb565, uint8* dst_argb, int width) {</span>
<span class="lineNum">     118 </span>            :   int x;
<span class="lineNum">     119 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width; ++x) {</span>
<span class="lineNum">     120 </span><span class="lineNoCov">          0 :     uint8 b = src_rgb565[0] &amp; 0x1f;</span>
<span class="lineNum">     121 </span><span class="lineNoCov">          0 :     uint8 g = (src_rgb565[0] &gt;&gt; 5) | ((src_rgb565[1] &amp; 0x07) &lt;&lt; 3);</span>
<span class="lineNum">     122 </span><span class="lineNoCov">          0 :     uint8 r = src_rgb565[1] &gt;&gt; 3;</span>
<span class="lineNum">     123 </span><span class="lineNoCov">          0 :     dst_argb[0] = (b &lt;&lt; 3) | (b &gt;&gt; 2);</span>
<span class="lineNum">     124 </span><span class="lineNoCov">          0 :     dst_argb[1] = (g &lt;&lt; 2) | (g &gt;&gt; 4);</span>
<span class="lineNum">     125 </span><span class="lineNoCov">          0 :     dst_argb[2] = (r &lt;&lt; 3) | (r &gt;&gt; 2);</span>
<span class="lineNum">     126 </span><span class="lineNoCov">          0 :     dst_argb[3] = 255u;</span>
<span class="lineNum">     127 </span><span class="lineNoCov">          0 :     dst_argb += 4;</span>
<span class="lineNum">     128 </span><span class="lineNoCov">          0 :     src_rgb565 += 2;</span>
<span class="lineNum">     129 </span>            :   }
<a name="130"><span class="lineNum">     130 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     131 </span>            : 
<span class="lineNum">     132 </span><span class="lineNoCov">          0 : void ARGB1555ToARGBRow_C(const uint8* src_argb1555,</span>
<span class="lineNum">     133 </span>            :                          uint8* dst_argb,
<span class="lineNum">     134 </span>            :                          int width) {
<span class="lineNum">     135 </span>            :   int x;
<span class="lineNum">     136 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width; ++x) {</span>
<span class="lineNum">     137 </span><span class="lineNoCov">          0 :     uint8 b = src_argb1555[0] &amp; 0x1f;</span>
<span class="lineNum">     138 </span><span class="lineNoCov">          0 :     uint8 g = (src_argb1555[0] &gt;&gt; 5) | ((src_argb1555[1] &amp; 0x03) &lt;&lt; 3);</span>
<span class="lineNum">     139 </span><span class="lineNoCov">          0 :     uint8 r = (src_argb1555[1] &amp; 0x7c) &gt;&gt; 2;</span>
<span class="lineNum">     140 </span><span class="lineNoCov">          0 :     uint8 a = src_argb1555[1] &gt;&gt; 7;</span>
<span class="lineNum">     141 </span><span class="lineNoCov">          0 :     dst_argb[0] = (b &lt;&lt; 3) | (b &gt;&gt; 2);</span>
<span class="lineNum">     142 </span><span class="lineNoCov">          0 :     dst_argb[1] = (g &lt;&lt; 3) | (g &gt;&gt; 2);</span>
<span class="lineNum">     143 </span><span class="lineNoCov">          0 :     dst_argb[2] = (r &lt;&lt; 3) | (r &gt;&gt; 2);</span>
<span class="lineNum">     144 </span><span class="lineNoCov">          0 :     dst_argb[3] = -a;</span>
<span class="lineNum">     145 </span><span class="lineNoCov">          0 :     dst_argb += 4;</span>
<span class="lineNum">     146 </span><span class="lineNoCov">          0 :     src_argb1555 += 2;</span>
<span class="lineNum">     147 </span>            :   }
<a name="148"><span class="lineNum">     148 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     149 </span>            : 
<span class="lineNum">     150 </span><span class="lineNoCov">          0 : void ARGB4444ToARGBRow_C(const uint8* src_argb4444,</span>
<span class="lineNum">     151 </span>            :                          uint8* dst_argb,
<span class="lineNum">     152 </span>            :                          int width) {
<span class="lineNum">     153 </span>            :   int x;
<span class="lineNum">     154 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width; ++x) {</span>
<span class="lineNum">     155 </span><span class="lineNoCov">          0 :     uint8 b = src_argb4444[0] &amp; 0x0f;</span>
<span class="lineNum">     156 </span><span class="lineNoCov">          0 :     uint8 g = src_argb4444[0] &gt;&gt; 4;</span>
<span class="lineNum">     157 </span><span class="lineNoCov">          0 :     uint8 r = src_argb4444[1] &amp; 0x0f;</span>
<span class="lineNum">     158 </span><span class="lineNoCov">          0 :     uint8 a = src_argb4444[1] &gt;&gt; 4;</span>
<span class="lineNum">     159 </span><span class="lineNoCov">          0 :     dst_argb[0] = (b &lt;&lt; 4) | b;</span>
<span class="lineNum">     160 </span><span class="lineNoCov">          0 :     dst_argb[1] = (g &lt;&lt; 4) | g;</span>
<span class="lineNum">     161 </span><span class="lineNoCov">          0 :     dst_argb[2] = (r &lt;&lt; 4) | r;</span>
<span class="lineNum">     162 </span><span class="lineNoCov">          0 :     dst_argb[3] = (a &lt;&lt; 4) | a;</span>
<span class="lineNum">     163 </span><span class="lineNoCov">          0 :     dst_argb += 4;</span>
<span class="lineNum">     164 </span><span class="lineNoCov">          0 :     src_argb4444 += 2;</span>
<span class="lineNum">     165 </span>            :   }
<a name="166"><span class="lineNum">     166 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     167 </span>            : 
<span class="lineNum">     168 </span><span class="lineNoCov">          0 : void ARGBToRGB24Row_C(const uint8* src_argb, uint8* dst_rgb, int width) {</span>
<span class="lineNum">     169 </span>            :   int x;
<span class="lineNum">     170 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width; ++x) {</span>
<span class="lineNum">     171 </span><span class="lineNoCov">          0 :     uint8 b = src_argb[0];</span>
<span class="lineNum">     172 </span><span class="lineNoCov">          0 :     uint8 g = src_argb[1];</span>
<span class="lineNum">     173 </span><span class="lineNoCov">          0 :     uint8 r = src_argb[2];</span>
<span class="lineNum">     174 </span><span class="lineNoCov">          0 :     dst_rgb[0] = b;</span>
<span class="lineNum">     175 </span><span class="lineNoCov">          0 :     dst_rgb[1] = g;</span>
<span class="lineNum">     176 </span><span class="lineNoCov">          0 :     dst_rgb[2] = r;</span>
<span class="lineNum">     177 </span><span class="lineNoCov">          0 :     dst_rgb += 3;</span>
<span class="lineNum">     178 </span><span class="lineNoCov">          0 :     src_argb += 4;</span>
<span class="lineNum">     179 </span>            :   }
<a name="180"><span class="lineNum">     180 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     181 </span>            : 
<span class="lineNum">     182 </span><span class="lineNoCov">          0 : void ARGBToRAWRow_C(const uint8* src_argb, uint8* dst_rgb, int width) {</span>
<span class="lineNum">     183 </span>            :   int x;
<span class="lineNum">     184 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width; ++x) {</span>
<span class="lineNum">     185 </span><span class="lineNoCov">          0 :     uint8 b = src_argb[0];</span>
<span class="lineNum">     186 </span><span class="lineNoCov">          0 :     uint8 g = src_argb[1];</span>
<span class="lineNum">     187 </span><span class="lineNoCov">          0 :     uint8 r = src_argb[2];</span>
<span class="lineNum">     188 </span><span class="lineNoCov">          0 :     dst_rgb[0] = r;</span>
<span class="lineNum">     189 </span><span class="lineNoCov">          0 :     dst_rgb[1] = g;</span>
<span class="lineNum">     190 </span><span class="lineNoCov">          0 :     dst_rgb[2] = b;</span>
<span class="lineNum">     191 </span><span class="lineNoCov">          0 :     dst_rgb += 3;</span>
<span class="lineNum">     192 </span><span class="lineNoCov">          0 :     src_argb += 4;</span>
<span class="lineNum">     193 </span>            :   }
<a name="194"><span class="lineNum">     194 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     195 </span>            : 
<span class="lineNum">     196 </span><span class="lineNoCov">          0 : void ARGBToRGB565Row_C(const uint8* src_argb, uint8* dst_rgb, int width) {</span>
<span class="lineNum">     197 </span>            :   int x;
<span class="lineNum">     198 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width - 1; x += 2) {</span>
<span class="lineNum">     199 </span><span class="lineNoCov">          0 :     uint8 b0 = src_argb[0] &gt;&gt; 3;</span>
<span class="lineNum">     200 </span><span class="lineNoCov">          0 :     uint8 g0 = src_argb[1] &gt;&gt; 2;</span>
<span class="lineNum">     201 </span><span class="lineNoCov">          0 :     uint8 r0 = src_argb[2] &gt;&gt; 3;</span>
<span class="lineNum">     202 </span><span class="lineNoCov">          0 :     uint8 b1 = src_argb[4] &gt;&gt; 3;</span>
<span class="lineNum">     203 </span><span class="lineNoCov">          0 :     uint8 g1 = src_argb[5] &gt;&gt; 2;</span>
<span class="lineNum">     204 </span><span class="lineNoCov">          0 :     uint8 r1 = src_argb[6] &gt;&gt; 3;</span>
<span class="lineNum">     205 </span><span class="lineNoCov">          0 :     WRITEWORD(dst_rgb, b0 | (g0 &lt;&lt; 5) | (r0 &lt;&lt; 11) | (b1 &lt;&lt; 16) | (g1 &lt;&lt; 21) |</span>
<span class="lineNum">     206 </span>            :                            (r1 &lt;&lt; 27));
<span class="lineNum">     207 </span><span class="lineNoCov">          0 :     dst_rgb += 4;</span>
<span class="lineNum">     208 </span><span class="lineNoCov">          0 :     src_argb += 8;</span>
<span class="lineNum">     209 </span>            :   }
<span class="lineNum">     210 </span><span class="lineNoCov">          0 :   if (width &amp; 1) {</span>
<span class="lineNum">     211 </span><span class="lineNoCov">          0 :     uint8 b0 = src_argb[0] &gt;&gt; 3;</span>
<span class="lineNum">     212 </span><span class="lineNoCov">          0 :     uint8 g0 = src_argb[1] &gt;&gt; 2;</span>
<span class="lineNum">     213 </span><span class="lineNoCov">          0 :     uint8 r0 = src_argb[2] &gt;&gt; 3;</span>
<span class="lineNum">     214 </span><span class="lineNoCov">          0 :     *(uint16*)(dst_rgb) = b0 | (g0 &lt;&lt; 5) | (r0 &lt;&lt; 11);</span>
<span class="lineNum">     215 </span>            :   }
<span class="lineNum">     216 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">     217 </span>            : 
<span class="lineNum">     218 </span>            : // dither4 is a row of 4 values from 4x4 dither matrix.
<span class="lineNum">     219 </span>            : // The 4x4 matrix contains values to increase RGB.  When converting to
<span class="lineNum">     220 </span>            : // fewer bits (565) this provides an ordered dither.
<span class="lineNum">     221 </span>            : // The order in the 4x4 matrix in first byte is upper left.
<span class="lineNum">     222 </span>            : // The 4 values are passed as an int, then referenced as an array, so
<span class="lineNum">     223 </span>            : // endian will not affect order of the original matrix.  But the dither4
<a name="224"><span class="lineNum">     224 </span>            : // will containing the first pixel in the lower byte for little endian</a>
<span class="lineNum">     225 </span>            : // or the upper byte for big endian.
<span class="lineNum">     226 </span><span class="lineNoCov">          0 : void ARGBToRGB565DitherRow_C(const uint8* src_argb,</span>
<span class="lineNum">     227 </span>            :                              uint8* dst_rgb,
<span class="lineNum">     228 </span>            :                              const uint32 dither4,
<span class="lineNum">     229 </span>            :                              int width) {
<span class="lineNum">     230 </span>            :   int x;
<span class="lineNum">     231 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width - 1; x += 2) {</span>
<span class="lineNum">     232 </span><span class="lineNoCov">          0 :     int dither0 = ((const unsigned char*)(&amp;dither4))[x &amp; 3];</span>
<span class="lineNum">     233 </span><span class="lineNoCov">          0 :     int dither1 = ((const unsigned char*)(&amp;dither4))[(x + 1) &amp; 3];</span>
<span class="lineNum">     234 </span><span class="lineNoCov">          0 :     uint8 b0 = clamp255(src_argb[0] + dither0) &gt;&gt; 3;</span>
<span class="lineNum">     235 </span><span class="lineNoCov">          0 :     uint8 g0 = clamp255(src_argb[1] + dither0) &gt;&gt; 2;</span>
<span class="lineNum">     236 </span><span class="lineNoCov">          0 :     uint8 r0 = clamp255(src_argb[2] + dither0) &gt;&gt; 3;</span>
<span class="lineNum">     237 </span><span class="lineNoCov">          0 :     uint8 b1 = clamp255(src_argb[4] + dither1) &gt;&gt; 3;</span>
<span class="lineNum">     238 </span><span class="lineNoCov">          0 :     uint8 g1 = clamp255(src_argb[5] + dither1) &gt;&gt; 2;</span>
<span class="lineNum">     239 </span><span class="lineNoCov">          0 :     uint8 r1 = clamp255(src_argb[6] + dither1) &gt;&gt; 3;</span>
<span class="lineNum">     240 </span><span class="lineNoCov">          0 :     WRITEWORD(dst_rgb, b0 | (g0 &lt;&lt; 5) | (r0 &lt;&lt; 11) | (b1 &lt;&lt; 16) | (g1 &lt;&lt; 21) |</span>
<span class="lineNum">     241 </span>            :                            (r1 &lt;&lt; 27));
<span class="lineNum">     242 </span><span class="lineNoCov">          0 :     dst_rgb += 4;</span>
<span class="lineNum">     243 </span><span class="lineNoCov">          0 :     src_argb += 8;</span>
<span class="lineNum">     244 </span>            :   }
<span class="lineNum">     245 </span><span class="lineNoCov">          0 :   if (width &amp; 1) {</span>
<span class="lineNum">     246 </span><span class="lineNoCov">          0 :     int dither0 = ((const unsigned char*)(&amp;dither4))[(width - 1) &amp; 3];</span>
<span class="lineNum">     247 </span><span class="lineNoCov">          0 :     uint8 b0 = clamp255(src_argb[0] + dither0) &gt;&gt; 3;</span>
<span class="lineNum">     248 </span><span class="lineNoCov">          0 :     uint8 g0 = clamp255(src_argb[1] + dither0) &gt;&gt; 2;</span>
<span class="lineNum">     249 </span><span class="lineNoCov">          0 :     uint8 r0 = clamp255(src_argb[2] + dither0) &gt;&gt; 3;</span>
<span class="lineNum">     250 </span><span class="lineNoCov">          0 :     *(uint16*)(dst_rgb) = b0 | (g0 &lt;&lt; 5) | (r0 &lt;&lt; 11);</span>
<span class="lineNum">     251 </span>            :   }
<a name="252"><span class="lineNum">     252 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     253 </span>            : 
<span class="lineNum">     254 </span><span class="lineNoCov">          0 : void ARGBToARGB1555Row_C(const uint8* src_argb, uint8* dst_rgb, int width) {</span>
<span class="lineNum">     255 </span>            :   int x;
<span class="lineNum">     256 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width - 1; x += 2) {</span>
<span class="lineNum">     257 </span><span class="lineNoCov">          0 :     uint8 b0 = src_argb[0] &gt;&gt; 3;</span>
<span class="lineNum">     258 </span><span class="lineNoCov">          0 :     uint8 g0 = src_argb[1] &gt;&gt; 3;</span>
<span class="lineNum">     259 </span><span class="lineNoCov">          0 :     uint8 r0 = src_argb[2] &gt;&gt; 3;</span>
<span class="lineNum">     260 </span><span class="lineNoCov">          0 :     uint8 a0 = src_argb[3] &gt;&gt; 7;</span>
<span class="lineNum">     261 </span><span class="lineNoCov">          0 :     uint8 b1 = src_argb[4] &gt;&gt; 3;</span>
<span class="lineNum">     262 </span><span class="lineNoCov">          0 :     uint8 g1 = src_argb[5] &gt;&gt; 3;</span>
<span class="lineNum">     263 </span><span class="lineNoCov">          0 :     uint8 r1 = src_argb[6] &gt;&gt; 3;</span>
<span class="lineNum">     264 </span><span class="lineNoCov">          0 :     uint8 a1 = src_argb[7] &gt;&gt; 7;</span>
<span class="lineNum">     265 </span><span class="lineNoCov">          0 :     *(uint32*)(dst_rgb) = b0 | (g0 &lt;&lt; 5) | (r0 &lt;&lt; 10) | (a0 &lt;&lt; 15) |</span>
<span class="lineNum">     266 </span><span class="lineNoCov">          0 :                           (b1 &lt;&lt; 16) | (g1 &lt;&lt; 21) | (r1 &lt;&lt; 26) | (a1 &lt;&lt; 31);</span>
<span class="lineNum">     267 </span><span class="lineNoCov">          0 :     dst_rgb += 4;</span>
<span class="lineNum">     268 </span><span class="lineNoCov">          0 :     src_argb += 8;</span>
<span class="lineNum">     269 </span>            :   }
<span class="lineNum">     270 </span><span class="lineNoCov">          0 :   if (width &amp; 1) {</span>
<span class="lineNum">     271 </span><span class="lineNoCov">          0 :     uint8 b0 = src_argb[0] &gt;&gt; 3;</span>
<span class="lineNum">     272 </span><span class="lineNoCov">          0 :     uint8 g0 = src_argb[1] &gt;&gt; 3;</span>
<span class="lineNum">     273 </span><span class="lineNoCov">          0 :     uint8 r0 = src_argb[2] &gt;&gt; 3;</span>
<span class="lineNum">     274 </span><span class="lineNoCov">          0 :     uint8 a0 = src_argb[3] &gt;&gt; 7;</span>
<span class="lineNum">     275 </span><span class="lineNoCov">          0 :     *(uint16*)(dst_rgb) = b0 | (g0 &lt;&lt; 5) | (r0 &lt;&lt; 10) | (a0 &lt;&lt; 15);</span>
<span class="lineNum">     276 </span>            :   }
<a name="277"><span class="lineNum">     277 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     278 </span>            : 
<span class="lineNum">     279 </span><span class="lineNoCov">          0 : void ARGBToARGB4444Row_C(const uint8* src_argb, uint8* dst_rgb, int width) {</span>
<span class="lineNum">     280 </span>            :   int x;
<span class="lineNum">     281 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width - 1; x += 2) {</span>
<span class="lineNum">     282 </span><span class="lineNoCov">          0 :     uint8 b0 = src_argb[0] &gt;&gt; 4;</span>
<span class="lineNum">     283 </span><span class="lineNoCov">          0 :     uint8 g0 = src_argb[1] &gt;&gt; 4;</span>
<span class="lineNum">     284 </span><span class="lineNoCov">          0 :     uint8 r0 = src_argb[2] &gt;&gt; 4;</span>
<span class="lineNum">     285 </span><span class="lineNoCov">          0 :     uint8 a0 = src_argb[3] &gt;&gt; 4;</span>
<span class="lineNum">     286 </span><span class="lineNoCov">          0 :     uint8 b1 = src_argb[4] &gt;&gt; 4;</span>
<span class="lineNum">     287 </span><span class="lineNoCov">          0 :     uint8 g1 = src_argb[5] &gt;&gt; 4;</span>
<span class="lineNum">     288 </span><span class="lineNoCov">          0 :     uint8 r1 = src_argb[6] &gt;&gt; 4;</span>
<span class="lineNum">     289 </span><span class="lineNoCov">          0 :     uint8 a1 = src_argb[7] &gt;&gt; 4;</span>
<span class="lineNum">     290 </span><span class="lineNoCov">          0 :     *(uint32*)(dst_rgb) = b0 | (g0 &lt;&lt; 4) | (r0 &lt;&lt; 8) | (a0 &lt;&lt; 12) | (b1 &lt;&lt; 16) |</span>
<span class="lineNum">     291 </span><span class="lineNoCov">          0 :                           (g1 &lt;&lt; 20) | (r1 &lt;&lt; 24) | (a1 &lt;&lt; 28);</span>
<span class="lineNum">     292 </span><span class="lineNoCov">          0 :     dst_rgb += 4;</span>
<span class="lineNum">     293 </span><span class="lineNoCov">          0 :     src_argb += 8;</span>
<span class="lineNum">     294 </span>            :   }
<span class="lineNum">     295 </span><span class="lineNoCov">          0 :   if (width &amp; 1) {</span>
<span class="lineNum">     296 </span><span class="lineNoCov">          0 :     uint8 b0 = src_argb[0] &gt;&gt; 4;</span>
<span class="lineNum">     297 </span><span class="lineNoCov">          0 :     uint8 g0 = src_argb[1] &gt;&gt; 4;</span>
<span class="lineNum">     298 </span><span class="lineNoCov">          0 :     uint8 r0 = src_argb[2] &gt;&gt; 4;</span>
<span class="lineNum">     299 </span><span class="lineNoCov">          0 :     uint8 a0 = src_argb[3] &gt;&gt; 4;</span>
<span class="lineNum">     300 </span><span class="lineNoCov">          0 :     *(uint16*)(dst_rgb) = b0 | (g0 &lt;&lt; 4) | (r0 &lt;&lt; 8) | (a0 &lt;&lt; 12);</span>
<span class="lineNum">     301 </span>            :   }
<a name="302"><span class="lineNum">     302 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     303 </span>            : 
<span class="lineNum">     304 </span><span class="lineNoCov">          0 : static __inline int RGBToY(uint8 r, uint8 g, uint8 b) {</span>
<span class="lineNum">     305 </span><span class="lineNoCov">          0 :   return (66 * r + 129 * g + 25 * b + 0x1080) &gt;&gt; 8;</span>
<a name="306"><span class="lineNum">     306 </span>            : }</a>
<span class="lineNum">     307 </span>            : 
<span class="lineNum">     308 </span><span class="lineNoCov">          0 : static __inline int RGBToU(uint8 r, uint8 g, uint8 b) {</span>
<a name="309"><span class="lineNum">     309 </span><span class="lineNoCov">          0 :   return (112 * b - 74 * g - 38 * r + 0x8080) &gt;&gt; 8;</span></a>
<span class="lineNum">     310 </span>            : }
<span class="lineNum">     311 </span><span class="lineNoCov">          0 : static __inline int RGBToV(uint8 r, uint8 g, uint8 b) {</span>
<span class="lineNum">     312 </span><span class="lineNoCov">          0 :   return (112 * r - 94 * g - 18 * b + 0x8080) &gt;&gt; 8;</span>
<span class="lineNum">     313 </span>            : }
<span class="lineNum">     314 </span>            : 
<span class="lineNum">     315 </span>            : // ARGBToY_C and ARGBToUV_C
<span class="lineNum">     316 </span>            : #define MAKEROWY(NAME, R, G, B, BPP)                                     \
<span class="lineNum">     317 </span>            :   void NAME##ToYRow_C(const uint8* src_argb0, uint8* dst_y, int width) { \
<span class="lineNum">     318 </span>            :     int x;                                                               \
<span class="lineNum">     319 </span>            :     for (x = 0; x &lt; width; ++x) {                                        \
<span class="lineNum">     320 </span>            :       dst_y[0] = RGBToY(src_argb0[R], src_argb0[G], src_argb0[B]);       \
<span class="lineNum">     321 </span>            :       src_argb0 += BPP;                                                  \
<span class="lineNum">     322 </span>            :       dst_y += 1;                                                        \
<span class="lineNum">     323 </span>            :     }                                                                    \
<span class="lineNum">     324 </span>            :   }                                                                      \
<span class="lineNum">     325 </span>            :   void NAME##ToUVRow_C(const uint8* src_rgb0, int src_stride_rgb,        \
<span class="lineNum">     326 </span>            :                        uint8* dst_u, uint8* dst_v, int width) {          \
<span class="lineNum">     327 </span>            :     const uint8* src_rgb1 = src_rgb0 + src_stride_rgb;                   \
<span class="lineNum">     328 </span>            :     int x;                                                               \
<span class="lineNum">     329 </span>            :     for (x = 0; x &lt; width - 1; x += 2) {                                 \
<span class="lineNum">     330 </span>            :       uint8 ab = (src_rgb0[B] + src_rgb0[B + BPP] + src_rgb1[B] +        \
<span class="lineNum">     331 </span>            :                   src_rgb1[B + BPP]) &gt;&gt;                                  \
<span class="lineNum">     332 </span>            :                  2;                                                      \
<span class="lineNum">     333 </span>            :       uint8 ag = (src_rgb0[G] + src_rgb0[G + BPP] + src_rgb1[G] +        \
<span class="lineNum">     334 </span>            :                   src_rgb1[G + BPP]) &gt;&gt;                                  \
<span class="lineNum">     335 </span>            :                  2;                                                      \
<span class="lineNum">     336 </span>            :       uint8 ar = (src_rgb0[R] + src_rgb0[R + BPP] + src_rgb1[R] +        \
<span class="lineNum">     337 </span>            :                   src_rgb1[R + BPP]) &gt;&gt;                                  \
<span class="lineNum">     338 </span>            :                  2;                                                      \
<span class="lineNum">     339 </span>            :       dst_u[0] = RGBToU(ar, ag, ab);                                     \
<span class="lineNum">     340 </span>            :       dst_v[0] = RGBToV(ar, ag, ab);                                     \
<span class="lineNum">     341 </span>            :       src_rgb0 += BPP * 2;                                               \
<span class="lineNum">     342 </span>            :       src_rgb1 += BPP * 2;                                               \
<span class="lineNum">     343 </span>            :       dst_u += 1;                                                        \
<span class="lineNum">     344 </span>            :       dst_v += 1;                                                        \
<span class="lineNum">     345 </span>            :     }                                                                    \
<span class="lineNum">     346 </span>            :     if (width &amp; 1) {                                                     \
<span class="lineNum">     347 </span>            :       uint8 ab = (src_rgb0[B] + src_rgb1[B]) &gt;&gt; 1;                       \
<span class="lineNum">     348 </span>            :       uint8 ag = (src_rgb0[G] + src_rgb1[G]) &gt;&gt; 1;                       \
<span class="lineNum">     349 </span>            :       uint8 ar = (src_rgb0[R] + src_rgb1[R]) &gt;&gt; 1;                       \
<span class="lineNum">     350 </span>            :       dst_u[0] = RGBToU(ar, ag, ab);                                     \
<span class="lineNum">     351 </span>            :       dst_v[0] = RGBToV(ar, ag, ab);                                     \
<span class="lineNum">     352 </span>            :     }                                                                    \
<a name="353"><span class="lineNum">     353 </span>            :   }</a>
<a name="354"><span class="lineNum">     354 </span>            : </a>
<a name="355"><span class="lineNum">     355 </span><span class="lineNoCov">          0 : MAKEROWY(ARGB, 2, 1, 0, 4)</span></a>
<a name="356"><span class="lineNum">     356 </span><span class="lineNoCov">          0 : MAKEROWY(BGRA, 1, 2, 3, 4)</span></a>
<a name="357"><span class="lineNum">     357 </span><span class="lineNoCov">          0 : MAKEROWY(ABGR, 0, 1, 2, 4)</span></a>
<a name="358"><span class="lineNum">     358 </span><span class="lineNoCov">          0 : MAKEROWY(RGBA, 3, 2, 1, 4)</span></a>
<span class="lineNum">     359 </span><span class="lineNoCov">          0 : MAKEROWY(RGB24, 2, 1, 0, 3)</span>
<span class="lineNum">     360 </span><span class="lineNoCov">          0 : MAKEROWY(RAW, 0, 1, 2, 3)</span>
<span class="lineNum">     361 </span>            : #undef MAKEROWY
<span class="lineNum">     362 </span>            : 
<span class="lineNum">     363 </span>            : // JPeg uses a variation on BT.601-1 full range
<span class="lineNum">     364 </span>            : // y =  0.29900 * r + 0.58700 * g + 0.11400 * b
<span class="lineNum">     365 </span>            : // u = -0.16874 * r - 0.33126 * g + 0.50000 * b  + center
<span class="lineNum">     366 </span>            : // v =  0.50000 * r - 0.41869 * g - 0.08131 * b  + center
<span class="lineNum">     367 </span>            : // BT.601 Mpeg range uses:
<span class="lineNum">     368 </span>            : // b 0.1016 * 255 = 25.908 = 25
<span class="lineNum">     369 </span>            : // g 0.5078 * 255 = 129.489 = 129
<span class="lineNum">     370 </span>            : // r 0.2578 * 255 = 65.739 = 66
<span class="lineNum">     371 </span>            : // JPeg 8 bit Y (not used):
<span class="lineNum">     372 </span>            : // b 0.11400 * 256 = 29.184 = 29
<span class="lineNum">     373 </span>            : // g 0.58700 * 256 = 150.272 = 150
<span class="lineNum">     374 </span>            : // r 0.29900 * 256 = 76.544 = 77
<span class="lineNum">     375 </span>            : // JPeg 7 bit Y:
<span class="lineNum">     376 </span>            : // b 0.11400 * 128 = 14.592 = 15
<span class="lineNum">     377 </span>            : // g 0.58700 * 128 = 75.136 = 75
<span class="lineNum">     378 </span>            : // r 0.29900 * 128 = 38.272 = 38
<span class="lineNum">     379 </span>            : // JPeg 8 bit U:
<span class="lineNum">     380 </span>            : // b  0.50000 * 255 = 127.5 = 127
<span class="lineNum">     381 </span>            : // g -0.33126 * 255 = -84.4713 = -84
<span class="lineNum">     382 </span>            : // r -0.16874 * 255 = -43.0287 = -43
<span class="lineNum">     383 </span>            : // JPeg 8 bit V:
<span class="lineNum">     384 </span>            : // b -0.08131 * 255 = -20.73405 = -20
<span class="lineNum">     385 </span>            : // g -0.41869 * 255 = -106.76595 = -107
<a name="386"><span class="lineNum">     386 </span>            : // r  0.50000 * 255 = 127.5 = 127</a>
<span class="lineNum">     387 </span>            : 
<span class="lineNum">     388 </span><span class="lineNoCov">          0 : static __inline int RGBToYJ(uint8 r, uint8 g, uint8 b) {</span>
<span class="lineNum">     389 </span><span class="lineNoCov">          0 :   return (38 * r + 75 * g + 15 * b + 64) &gt;&gt; 7;</span>
<a name="390"><span class="lineNum">     390 </span>            : }</a>
<span class="lineNum">     391 </span>            : 
<span class="lineNum">     392 </span><span class="lineNoCov">          0 : static __inline int RGBToUJ(uint8 r, uint8 g, uint8 b) {</span>
<a name="393"><span class="lineNum">     393 </span><span class="lineNoCov">          0 :   return (127 * b - 84 * g - 43 * r + 0x8080) &gt;&gt; 8;</span></a>
<span class="lineNum">     394 </span>            : }
<span class="lineNum">     395 </span><span class="lineNoCov">          0 : static __inline int RGBToVJ(uint8 r, uint8 g, uint8 b) {</span>
<span class="lineNum">     396 </span><span class="lineNoCov">          0 :   return (127 * r - 107 * g - 20 * b + 0x8080) &gt;&gt; 8;</span>
<span class="lineNum">     397 </span>            : }
<span class="lineNum">     398 </span>            : 
<span class="lineNum">     399 </span>            : #define AVGB(a, b) (((a) + (b) + 1) &gt;&gt; 1)
<span class="lineNum">     400 </span>            : 
<span class="lineNum">     401 </span>            : // ARGBToYJ_C and ARGBToUVJ_C
<span class="lineNum">     402 </span>            : #define MAKEROWYJ(NAME, R, G, B, BPP)                                     \
<span class="lineNum">     403 </span>            :   void NAME##ToYJRow_C(const uint8* src_argb0, uint8* dst_y, int width) { \
<span class="lineNum">     404 </span>            :     int x;                                                                \
<span class="lineNum">     405 </span>            :     for (x = 0; x &lt; width; ++x) {                                         \
<span class="lineNum">     406 </span>            :       dst_y[0] = RGBToYJ(src_argb0[R], src_argb0[G], src_argb0[B]);       \
<span class="lineNum">     407 </span>            :       src_argb0 += BPP;                                                   \
<span class="lineNum">     408 </span>            :       dst_y += 1;                                                         \
<span class="lineNum">     409 </span>            :     }                                                                     \
<span class="lineNum">     410 </span>            :   }                                                                       \
<span class="lineNum">     411 </span>            :   void NAME##ToUVJRow_C(const uint8* src_rgb0, int src_stride_rgb,        \
<span class="lineNum">     412 </span>            :                         uint8* dst_u, uint8* dst_v, int width) {          \
<span class="lineNum">     413 </span>            :     const uint8* src_rgb1 = src_rgb0 + src_stride_rgb;                    \
<span class="lineNum">     414 </span>            :     int x;                                                                \
<span class="lineNum">     415 </span>            :     for (x = 0; x &lt; width - 1; x += 2) {                                  \
<span class="lineNum">     416 </span>            :       uint8 ab = AVGB(AVGB(src_rgb0[B], src_rgb1[B]),                     \
<span class="lineNum">     417 </span>            :                       AVGB(src_rgb0[B + BPP], src_rgb1[B + BPP]));        \
<span class="lineNum">     418 </span>            :       uint8 ag = AVGB(AVGB(src_rgb0[G], src_rgb1[G]),                     \
<span class="lineNum">     419 </span>            :                       AVGB(src_rgb0[G + BPP], src_rgb1[G + BPP]));        \
<span class="lineNum">     420 </span>            :       uint8 ar = AVGB(AVGB(src_rgb0[R], src_rgb1[R]),                     \
<span class="lineNum">     421 </span>            :                       AVGB(src_rgb0[R + BPP], src_rgb1[R + BPP]));        \
<span class="lineNum">     422 </span>            :       dst_u[0] = RGBToUJ(ar, ag, ab);                                     \
<span class="lineNum">     423 </span>            :       dst_v[0] = RGBToVJ(ar, ag, ab);                                     \
<span class="lineNum">     424 </span>            :       src_rgb0 += BPP * 2;                                                \
<span class="lineNum">     425 </span>            :       src_rgb1 += BPP * 2;                                                \
<span class="lineNum">     426 </span>            :       dst_u += 1;                                                         \
<span class="lineNum">     427 </span>            :       dst_v += 1;                                                         \
<span class="lineNum">     428 </span>            :     }                                                                     \
<span class="lineNum">     429 </span>            :     if (width &amp; 1) {                                                      \
<span class="lineNum">     430 </span>            :       uint8 ab = AVGB(src_rgb0[B], src_rgb1[B]);                          \
<span class="lineNum">     431 </span>            :       uint8 ag = AVGB(src_rgb0[G], src_rgb1[G]);                          \
<span class="lineNum">     432 </span>            :       uint8 ar = AVGB(src_rgb0[R], src_rgb1[R]);                          \
<span class="lineNum">     433 </span>            :       dst_u[0] = RGBToUJ(ar, ag, ab);                                     \
<span class="lineNum">     434 </span>            :       dst_v[0] = RGBToVJ(ar, ag, ab);                                     \
<span class="lineNum">     435 </span>            :     }                                                                     \
<a name="436"><span class="lineNum">     436 </span>            :   }</a>
<span class="lineNum">     437 </span>            : 
<span class="lineNum">     438 </span><span class="lineNoCov">          0 : MAKEROWYJ(ARGB, 2, 1, 0, 4)</span>
<a name="439"><span class="lineNum">     439 </span>            : #undef MAKEROWYJ</a>
<span class="lineNum">     440 </span>            : 
<span class="lineNum">     441 </span><span class="lineNoCov">          0 : void RGB565ToYRow_C(const uint8* src_rgb565, uint8* dst_y, int width) {</span>
<span class="lineNum">     442 </span>            :   int x;
<span class="lineNum">     443 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width; ++x) {</span>
<span class="lineNum">     444 </span><span class="lineNoCov">          0 :     uint8 b = src_rgb565[0] &amp; 0x1f;</span>
<span class="lineNum">     445 </span><span class="lineNoCov">          0 :     uint8 g = (src_rgb565[0] &gt;&gt; 5) | ((src_rgb565[1] &amp; 0x07) &lt;&lt; 3);</span>
<span class="lineNum">     446 </span><span class="lineNoCov">          0 :     uint8 r = src_rgb565[1] &gt;&gt; 3;</span>
<span class="lineNum">     447 </span><span class="lineNoCov">          0 :     b = (b &lt;&lt; 3) | (b &gt;&gt; 2);</span>
<span class="lineNum">     448 </span><span class="lineNoCov">          0 :     g = (g &lt;&lt; 2) | (g &gt;&gt; 4);</span>
<span class="lineNum">     449 </span><span class="lineNoCov">          0 :     r = (r &lt;&lt; 3) | (r &gt;&gt; 2);</span>
<span class="lineNum">     450 </span><span class="lineNoCov">          0 :     dst_y[0] = RGBToY(r, g, b);</span>
<span class="lineNum">     451 </span><span class="lineNoCov">          0 :     src_rgb565 += 2;</span>
<span class="lineNum">     452 </span><span class="lineNoCov">          0 :     dst_y += 1;</span>
<span class="lineNum">     453 </span>            :   }
<a name="454"><span class="lineNum">     454 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     455 </span>            : 
<span class="lineNum">     456 </span><span class="lineNoCov">          0 : void ARGB1555ToYRow_C(const uint8* src_argb1555, uint8* dst_y, int width) {</span>
<span class="lineNum">     457 </span>            :   int x;
<span class="lineNum">     458 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width; ++x) {</span>
<span class="lineNum">     459 </span><span class="lineNoCov">          0 :     uint8 b = src_argb1555[0] &amp; 0x1f;</span>
<span class="lineNum">     460 </span><span class="lineNoCov">          0 :     uint8 g = (src_argb1555[0] &gt;&gt; 5) | ((src_argb1555[1] &amp; 0x03) &lt;&lt; 3);</span>
<span class="lineNum">     461 </span><span class="lineNoCov">          0 :     uint8 r = (src_argb1555[1] &amp; 0x7c) &gt;&gt; 2;</span>
<span class="lineNum">     462 </span><span class="lineNoCov">          0 :     b = (b &lt;&lt; 3) | (b &gt;&gt; 2);</span>
<span class="lineNum">     463 </span><span class="lineNoCov">          0 :     g = (g &lt;&lt; 3) | (g &gt;&gt; 2);</span>
<span class="lineNum">     464 </span><span class="lineNoCov">          0 :     r = (r &lt;&lt; 3) | (r &gt;&gt; 2);</span>
<span class="lineNum">     465 </span><span class="lineNoCov">          0 :     dst_y[0] = RGBToY(r, g, b);</span>
<span class="lineNum">     466 </span><span class="lineNoCov">          0 :     src_argb1555 += 2;</span>
<span class="lineNum">     467 </span><span class="lineNoCov">          0 :     dst_y += 1;</span>
<span class="lineNum">     468 </span>            :   }
<a name="469"><span class="lineNum">     469 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     470 </span>            : 
<span class="lineNum">     471 </span><span class="lineNoCov">          0 : void ARGB4444ToYRow_C(const uint8* src_argb4444, uint8* dst_y, int width) {</span>
<span class="lineNum">     472 </span>            :   int x;
<span class="lineNum">     473 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width; ++x) {</span>
<span class="lineNum">     474 </span><span class="lineNoCov">          0 :     uint8 b = src_argb4444[0] &amp; 0x0f;</span>
<span class="lineNum">     475 </span><span class="lineNoCov">          0 :     uint8 g = src_argb4444[0] &gt;&gt; 4;</span>
<span class="lineNum">     476 </span><span class="lineNoCov">          0 :     uint8 r = src_argb4444[1] &amp; 0x0f;</span>
<span class="lineNum">     477 </span><span class="lineNoCov">          0 :     b = (b &lt;&lt; 4) | b;</span>
<span class="lineNum">     478 </span><span class="lineNoCov">          0 :     g = (g &lt;&lt; 4) | g;</span>
<span class="lineNum">     479 </span><span class="lineNoCov">          0 :     r = (r &lt;&lt; 4) | r;</span>
<span class="lineNum">     480 </span><span class="lineNoCov">          0 :     dst_y[0] = RGBToY(r, g, b);</span>
<span class="lineNum">     481 </span><span class="lineNoCov">          0 :     src_argb4444 += 2;</span>
<span class="lineNum">     482 </span><span class="lineNoCov">          0 :     dst_y += 1;</span>
<span class="lineNum">     483 </span>            :   }
<a name="484"><span class="lineNum">     484 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     485 </span>            : 
<span class="lineNum">     486 </span><span class="lineNoCov">          0 : void RGB565ToUVRow_C(const uint8* src_rgb565,</span>
<span class="lineNum">     487 </span>            :                      int src_stride_rgb565,
<span class="lineNum">     488 </span>            :                      uint8* dst_u,
<span class="lineNum">     489 </span>            :                      uint8* dst_v,
<span class="lineNum">     490 </span>            :                      int width) {
<span class="lineNum">     491 </span><span class="lineNoCov">          0 :   const uint8* next_rgb565 = src_rgb565 + src_stride_rgb565;</span>
<span class="lineNum">     492 </span>            :   int x;
<span class="lineNum">     493 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width - 1; x += 2) {</span>
<span class="lineNum">     494 </span><span class="lineNoCov">          0 :     uint8 b0 = src_rgb565[0] &amp; 0x1f;</span>
<span class="lineNum">     495 </span><span class="lineNoCov">          0 :     uint8 g0 = (src_rgb565[0] &gt;&gt; 5) | ((src_rgb565[1] &amp; 0x07) &lt;&lt; 3);</span>
<span class="lineNum">     496 </span><span class="lineNoCov">          0 :     uint8 r0 = src_rgb565[1] &gt;&gt; 3;</span>
<span class="lineNum">     497 </span><span class="lineNoCov">          0 :     uint8 b1 = src_rgb565[2] &amp; 0x1f;</span>
<span class="lineNum">     498 </span><span class="lineNoCov">          0 :     uint8 g1 = (src_rgb565[2] &gt;&gt; 5) | ((src_rgb565[3] &amp; 0x07) &lt;&lt; 3);</span>
<span class="lineNum">     499 </span><span class="lineNoCov">          0 :     uint8 r1 = src_rgb565[3] &gt;&gt; 3;</span>
<span class="lineNum">     500 </span><span class="lineNoCov">          0 :     uint8 b2 = next_rgb565[0] &amp; 0x1f;</span>
<span class="lineNum">     501 </span><span class="lineNoCov">          0 :     uint8 g2 = (next_rgb565[0] &gt;&gt; 5) | ((next_rgb565[1] &amp; 0x07) &lt;&lt; 3);</span>
<span class="lineNum">     502 </span><span class="lineNoCov">          0 :     uint8 r2 = next_rgb565[1] &gt;&gt; 3;</span>
<span class="lineNum">     503 </span><span class="lineNoCov">          0 :     uint8 b3 = next_rgb565[2] &amp; 0x1f;</span>
<span class="lineNum">     504 </span><span class="lineNoCov">          0 :     uint8 g3 = (next_rgb565[2] &gt;&gt; 5) | ((next_rgb565[3] &amp; 0x07) &lt;&lt; 3);</span>
<span class="lineNum">     505 </span><span class="lineNoCov">          0 :     uint8 r3 = next_rgb565[3] &gt;&gt; 3;</span>
<span class="lineNum">     506 </span><span class="lineNoCov">          0 :     uint8 b = (b0 + b1 + b2 + b3);  // 565 * 4 = 787.</span>
<span class="lineNum">     507 </span><span class="lineNoCov">          0 :     uint8 g = (g0 + g1 + g2 + g3);</span>
<span class="lineNum">     508 </span><span class="lineNoCov">          0 :     uint8 r = (r0 + r1 + r2 + r3);</span>
<span class="lineNum">     509 </span><span class="lineNoCov">          0 :     b = (b &lt;&lt; 1) | (b &gt;&gt; 6);  // 787 -&gt; 888.</span>
<span class="lineNum">     510 </span><span class="lineNoCov">          0 :     r = (r &lt;&lt; 1) | (r &gt;&gt; 6);</span>
<span class="lineNum">     511 </span><span class="lineNoCov">          0 :     dst_u[0] = RGBToU(r, g, b);</span>
<span class="lineNum">     512 </span><span class="lineNoCov">          0 :     dst_v[0] = RGBToV(r, g, b);</span>
<span class="lineNum">     513 </span><span class="lineNoCov">          0 :     src_rgb565 += 4;</span>
<span class="lineNum">     514 </span><span class="lineNoCov">          0 :     next_rgb565 += 4;</span>
<span class="lineNum">     515 </span><span class="lineNoCov">          0 :     dst_u += 1;</span>
<span class="lineNum">     516 </span><span class="lineNoCov">          0 :     dst_v += 1;</span>
<span class="lineNum">     517 </span>            :   }
<span class="lineNum">     518 </span><span class="lineNoCov">          0 :   if (width &amp; 1) {</span>
<span class="lineNum">     519 </span><span class="lineNoCov">          0 :     uint8 b0 = src_rgb565[0] &amp; 0x1f;</span>
<span class="lineNum">     520 </span><span class="lineNoCov">          0 :     uint8 g0 = (src_rgb565[0] &gt;&gt; 5) | ((src_rgb565[1] &amp; 0x07) &lt;&lt; 3);</span>
<span class="lineNum">     521 </span><span class="lineNoCov">          0 :     uint8 r0 = src_rgb565[1] &gt;&gt; 3;</span>
<span class="lineNum">     522 </span><span class="lineNoCov">          0 :     uint8 b2 = next_rgb565[0] &amp; 0x1f;</span>
<span class="lineNum">     523 </span><span class="lineNoCov">          0 :     uint8 g2 = (next_rgb565[0] &gt;&gt; 5) | ((next_rgb565[1] &amp; 0x07) &lt;&lt; 3);</span>
<span class="lineNum">     524 </span><span class="lineNoCov">          0 :     uint8 r2 = next_rgb565[1] &gt;&gt; 3;</span>
<span class="lineNum">     525 </span><span class="lineNoCov">          0 :     uint8 b = (b0 + b2);  // 565 * 2 = 676.</span>
<span class="lineNum">     526 </span><span class="lineNoCov">          0 :     uint8 g = (g0 + g2);</span>
<span class="lineNum">     527 </span><span class="lineNoCov">          0 :     uint8 r = (r0 + r2);</span>
<span class="lineNum">     528 </span><span class="lineNoCov">          0 :     b = (b &lt;&lt; 2) | (b &gt;&gt; 4);  // 676 -&gt; 888</span>
<span class="lineNum">     529 </span><span class="lineNoCov">          0 :     g = (g &lt;&lt; 1) | (g &gt;&gt; 6);</span>
<span class="lineNum">     530 </span><span class="lineNoCov">          0 :     r = (r &lt;&lt; 2) | (r &gt;&gt; 4);</span>
<span class="lineNum">     531 </span><span class="lineNoCov">          0 :     dst_u[0] = RGBToU(r, g, b);</span>
<span class="lineNum">     532 </span><span class="lineNoCov">          0 :     dst_v[0] = RGBToV(r, g, b);</span>
<span class="lineNum">     533 </span>            :   }
<a name="534"><span class="lineNum">     534 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     535 </span>            : 
<span class="lineNum">     536 </span><span class="lineNoCov">          0 : void ARGB1555ToUVRow_C(const uint8* src_argb1555,</span>
<span class="lineNum">     537 </span>            :                        int src_stride_argb1555,
<span class="lineNum">     538 </span>            :                        uint8* dst_u,
<span class="lineNum">     539 </span>            :                        uint8* dst_v,
<span class="lineNum">     540 </span>            :                        int width) {
<span class="lineNum">     541 </span><span class="lineNoCov">          0 :   const uint8* next_argb1555 = src_argb1555 + src_stride_argb1555;</span>
<span class="lineNum">     542 </span>            :   int x;
<span class="lineNum">     543 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width - 1; x += 2) {</span>
<span class="lineNum">     544 </span><span class="lineNoCov">          0 :     uint8 b0 = src_argb1555[0] &amp; 0x1f;</span>
<span class="lineNum">     545 </span><span class="lineNoCov">          0 :     uint8 g0 = (src_argb1555[0] &gt;&gt; 5) | ((src_argb1555[1] &amp; 0x03) &lt;&lt; 3);</span>
<span class="lineNum">     546 </span><span class="lineNoCov">          0 :     uint8 r0 = (src_argb1555[1] &amp; 0x7c) &gt;&gt; 2;</span>
<span class="lineNum">     547 </span><span class="lineNoCov">          0 :     uint8 b1 = src_argb1555[2] &amp; 0x1f;</span>
<span class="lineNum">     548 </span><span class="lineNoCov">          0 :     uint8 g1 = (src_argb1555[2] &gt;&gt; 5) | ((src_argb1555[3] &amp; 0x03) &lt;&lt; 3);</span>
<span class="lineNum">     549 </span><span class="lineNoCov">          0 :     uint8 r1 = (src_argb1555[3] &amp; 0x7c) &gt;&gt; 2;</span>
<span class="lineNum">     550 </span><span class="lineNoCov">          0 :     uint8 b2 = next_argb1555[0] &amp; 0x1f;</span>
<span class="lineNum">     551 </span><span class="lineNoCov">          0 :     uint8 g2 = (next_argb1555[0] &gt;&gt; 5) | ((next_argb1555[1] &amp; 0x03) &lt;&lt; 3);</span>
<span class="lineNum">     552 </span><span class="lineNoCov">          0 :     uint8 r2 = (next_argb1555[1] &amp; 0x7c) &gt;&gt; 2;</span>
<span class="lineNum">     553 </span><span class="lineNoCov">          0 :     uint8 b3 = next_argb1555[2] &amp; 0x1f;</span>
<span class="lineNum">     554 </span><span class="lineNoCov">          0 :     uint8 g3 = (next_argb1555[2] &gt;&gt; 5) | ((next_argb1555[3] &amp; 0x03) &lt;&lt; 3);</span>
<span class="lineNum">     555 </span><span class="lineNoCov">          0 :     uint8 r3 = (next_argb1555[3] &amp; 0x7c) &gt;&gt; 2;</span>
<span class="lineNum">     556 </span><span class="lineNoCov">          0 :     uint8 b = (b0 + b1 + b2 + b3);  // 555 * 4 = 777.</span>
<span class="lineNum">     557 </span><span class="lineNoCov">          0 :     uint8 g = (g0 + g1 + g2 + g3);</span>
<span class="lineNum">     558 </span><span class="lineNoCov">          0 :     uint8 r = (r0 + r1 + r2 + r3);</span>
<span class="lineNum">     559 </span><span class="lineNoCov">          0 :     b = (b &lt;&lt; 1) | (b &gt;&gt; 6);  // 777 -&gt; 888.</span>
<span class="lineNum">     560 </span><span class="lineNoCov">          0 :     g = (g &lt;&lt; 1) | (g &gt;&gt; 6);</span>
<span class="lineNum">     561 </span><span class="lineNoCov">          0 :     r = (r &lt;&lt; 1) | (r &gt;&gt; 6);</span>
<span class="lineNum">     562 </span><span class="lineNoCov">          0 :     dst_u[0] = RGBToU(r, g, b);</span>
<span class="lineNum">     563 </span><span class="lineNoCov">          0 :     dst_v[0] = RGBToV(r, g, b);</span>
<span class="lineNum">     564 </span><span class="lineNoCov">          0 :     src_argb1555 += 4;</span>
<span class="lineNum">     565 </span><span class="lineNoCov">          0 :     next_argb1555 += 4;</span>
<span class="lineNum">     566 </span><span class="lineNoCov">          0 :     dst_u += 1;</span>
<span class="lineNum">     567 </span><span class="lineNoCov">          0 :     dst_v += 1;</span>
<span class="lineNum">     568 </span>            :   }
<span class="lineNum">     569 </span><span class="lineNoCov">          0 :   if (width &amp; 1) {</span>
<span class="lineNum">     570 </span><span class="lineNoCov">          0 :     uint8 b0 = src_argb1555[0] &amp; 0x1f;</span>
<span class="lineNum">     571 </span><span class="lineNoCov">          0 :     uint8 g0 = (src_argb1555[0] &gt;&gt; 5) | ((src_argb1555[1] &amp; 0x03) &lt;&lt; 3);</span>
<span class="lineNum">     572 </span><span class="lineNoCov">          0 :     uint8 r0 = (src_argb1555[1] &amp; 0x7c) &gt;&gt; 2;</span>
<span class="lineNum">     573 </span><span class="lineNoCov">          0 :     uint8 b2 = next_argb1555[0] &amp; 0x1f;</span>
<span class="lineNum">     574 </span><span class="lineNoCov">          0 :     uint8 g2 = (next_argb1555[0] &gt;&gt; 5) | ((next_argb1555[1] &amp; 0x03) &lt;&lt; 3);</span>
<span class="lineNum">     575 </span><span class="lineNoCov">          0 :     uint8 r2 = next_argb1555[1] &gt;&gt; 3;</span>
<span class="lineNum">     576 </span><span class="lineNoCov">          0 :     uint8 b = (b0 + b2);  // 555 * 2 = 666.</span>
<span class="lineNum">     577 </span><span class="lineNoCov">          0 :     uint8 g = (g0 + g2);</span>
<span class="lineNum">     578 </span><span class="lineNoCov">          0 :     uint8 r = (r0 + r2);</span>
<span class="lineNum">     579 </span><span class="lineNoCov">          0 :     b = (b &lt;&lt; 2) | (b &gt;&gt; 4);  // 666 -&gt; 888.</span>
<span class="lineNum">     580 </span><span class="lineNoCov">          0 :     g = (g &lt;&lt; 2) | (g &gt;&gt; 4);</span>
<span class="lineNum">     581 </span><span class="lineNoCov">          0 :     r = (r &lt;&lt; 2) | (r &gt;&gt; 4);</span>
<span class="lineNum">     582 </span><span class="lineNoCov">          0 :     dst_u[0] = RGBToU(r, g, b);</span>
<span class="lineNum">     583 </span><span class="lineNoCov">          0 :     dst_v[0] = RGBToV(r, g, b);</span>
<span class="lineNum">     584 </span>            :   }
<a name="585"><span class="lineNum">     585 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     586 </span>            : 
<span class="lineNum">     587 </span><span class="lineNoCov">          0 : void ARGB4444ToUVRow_C(const uint8* src_argb4444,</span>
<span class="lineNum">     588 </span>            :                        int src_stride_argb4444,
<span class="lineNum">     589 </span>            :                        uint8* dst_u,
<span class="lineNum">     590 </span>            :                        uint8* dst_v,
<span class="lineNum">     591 </span>            :                        int width) {
<span class="lineNum">     592 </span><span class="lineNoCov">          0 :   const uint8* next_argb4444 = src_argb4444 + src_stride_argb4444;</span>
<span class="lineNum">     593 </span>            :   int x;
<span class="lineNum">     594 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width - 1; x += 2) {</span>
<span class="lineNum">     595 </span><span class="lineNoCov">          0 :     uint8 b0 = src_argb4444[0] &amp; 0x0f;</span>
<span class="lineNum">     596 </span><span class="lineNoCov">          0 :     uint8 g0 = src_argb4444[0] &gt;&gt; 4;</span>
<span class="lineNum">     597 </span><span class="lineNoCov">          0 :     uint8 r0 = src_argb4444[1] &amp; 0x0f;</span>
<span class="lineNum">     598 </span><span class="lineNoCov">          0 :     uint8 b1 = src_argb4444[2] &amp; 0x0f;</span>
<span class="lineNum">     599 </span><span class="lineNoCov">          0 :     uint8 g1 = src_argb4444[2] &gt;&gt; 4;</span>
<span class="lineNum">     600 </span><span class="lineNoCov">          0 :     uint8 r1 = src_argb4444[3] &amp; 0x0f;</span>
<span class="lineNum">     601 </span><span class="lineNoCov">          0 :     uint8 b2 = next_argb4444[0] &amp; 0x0f;</span>
<span class="lineNum">     602 </span><span class="lineNoCov">          0 :     uint8 g2 = next_argb4444[0] &gt;&gt; 4;</span>
<span class="lineNum">     603 </span><span class="lineNoCov">          0 :     uint8 r2 = next_argb4444[1] &amp; 0x0f;</span>
<span class="lineNum">     604 </span><span class="lineNoCov">          0 :     uint8 b3 = next_argb4444[2] &amp; 0x0f;</span>
<span class="lineNum">     605 </span><span class="lineNoCov">          0 :     uint8 g3 = next_argb4444[2] &gt;&gt; 4;</span>
<span class="lineNum">     606 </span><span class="lineNoCov">          0 :     uint8 r3 = next_argb4444[3] &amp; 0x0f;</span>
<span class="lineNum">     607 </span><span class="lineNoCov">          0 :     uint8 b = (b0 + b1 + b2 + b3);  // 444 * 4 = 666.</span>
<span class="lineNum">     608 </span><span class="lineNoCov">          0 :     uint8 g = (g0 + g1 + g2 + g3);</span>
<span class="lineNum">     609 </span><span class="lineNoCov">          0 :     uint8 r = (r0 + r1 + r2 + r3);</span>
<span class="lineNum">     610 </span><span class="lineNoCov">          0 :     b = (b &lt;&lt; 2) | (b &gt;&gt; 4);  // 666 -&gt; 888.</span>
<span class="lineNum">     611 </span><span class="lineNoCov">          0 :     g = (g &lt;&lt; 2) | (g &gt;&gt; 4);</span>
<span class="lineNum">     612 </span><span class="lineNoCov">          0 :     r = (r &lt;&lt; 2) | (r &gt;&gt; 4);</span>
<span class="lineNum">     613 </span><span class="lineNoCov">          0 :     dst_u[0] = RGBToU(r, g, b);</span>
<span class="lineNum">     614 </span><span class="lineNoCov">          0 :     dst_v[0] = RGBToV(r, g, b);</span>
<span class="lineNum">     615 </span><span class="lineNoCov">          0 :     src_argb4444 += 4;</span>
<span class="lineNum">     616 </span><span class="lineNoCov">          0 :     next_argb4444 += 4;</span>
<span class="lineNum">     617 </span><span class="lineNoCov">          0 :     dst_u += 1;</span>
<span class="lineNum">     618 </span><span class="lineNoCov">          0 :     dst_v += 1;</span>
<span class="lineNum">     619 </span>            :   }
<span class="lineNum">     620 </span><span class="lineNoCov">          0 :   if (width &amp; 1) {</span>
<span class="lineNum">     621 </span><span class="lineNoCov">          0 :     uint8 b0 = src_argb4444[0] &amp; 0x0f;</span>
<span class="lineNum">     622 </span><span class="lineNoCov">          0 :     uint8 g0 = src_argb4444[0] &gt;&gt; 4;</span>
<span class="lineNum">     623 </span><span class="lineNoCov">          0 :     uint8 r0 = src_argb4444[1] &amp; 0x0f;</span>
<span class="lineNum">     624 </span><span class="lineNoCov">          0 :     uint8 b2 = next_argb4444[0] &amp; 0x0f;</span>
<span class="lineNum">     625 </span><span class="lineNoCov">          0 :     uint8 g2 = next_argb4444[0] &gt;&gt; 4;</span>
<span class="lineNum">     626 </span><span class="lineNoCov">          0 :     uint8 r2 = next_argb4444[1] &amp; 0x0f;</span>
<span class="lineNum">     627 </span><span class="lineNoCov">          0 :     uint8 b = (b0 + b2);  // 444 * 2 = 555.</span>
<span class="lineNum">     628 </span><span class="lineNoCov">          0 :     uint8 g = (g0 + g2);</span>
<span class="lineNum">     629 </span><span class="lineNoCov">          0 :     uint8 r = (r0 + r2);</span>
<span class="lineNum">     630 </span><span class="lineNoCov">          0 :     b = (b &lt;&lt; 3) | (b &gt;&gt; 2);  // 555 -&gt; 888.</span>
<span class="lineNum">     631 </span><span class="lineNoCov">          0 :     g = (g &lt;&lt; 3) | (g &gt;&gt; 2);</span>
<span class="lineNum">     632 </span><span class="lineNoCov">          0 :     r = (r &lt;&lt; 3) | (r &gt;&gt; 2);</span>
<span class="lineNum">     633 </span><span class="lineNoCov">          0 :     dst_u[0] = RGBToU(r, g, b);</span>
<span class="lineNum">     634 </span><span class="lineNoCov">          0 :     dst_v[0] = RGBToV(r, g, b);</span>
<span class="lineNum">     635 </span>            :   }
<a name="636"><span class="lineNum">     636 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     637 </span>            : 
<span class="lineNum">     638 </span><span class="lineNoCov">          0 : void ARGBToUV444Row_C(const uint8* src_argb,</span>
<span class="lineNum">     639 </span>            :                       uint8* dst_u,
<span class="lineNum">     640 </span>            :                       uint8* dst_v,
<span class="lineNum">     641 </span>            :                       int width) {
<span class="lineNum">     642 </span>            :   int x;
<span class="lineNum">     643 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width; ++x) {</span>
<span class="lineNum">     644 </span><span class="lineNoCov">          0 :     uint8 ab = src_argb[0];</span>
<span class="lineNum">     645 </span><span class="lineNoCov">          0 :     uint8 ag = src_argb[1];</span>
<span class="lineNum">     646 </span><span class="lineNoCov">          0 :     uint8 ar = src_argb[2];</span>
<span class="lineNum">     647 </span><span class="lineNoCov">          0 :     dst_u[0] = RGBToU(ar, ag, ab);</span>
<span class="lineNum">     648 </span><span class="lineNoCov">          0 :     dst_v[0] = RGBToV(ar, ag, ab);</span>
<span class="lineNum">     649 </span><span class="lineNoCov">          0 :     src_argb += 4;</span>
<span class="lineNum">     650 </span><span class="lineNoCov">          0 :     dst_u += 1;</span>
<span class="lineNum">     651 </span><span class="lineNoCov">          0 :     dst_v += 1;</span>
<span class="lineNum">     652 </span>            :   }
<a name="653"><span class="lineNum">     653 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     654 </span>            : 
<span class="lineNum">     655 </span><span class="lineNoCov">          0 : void ARGBGrayRow_C(const uint8* src_argb, uint8* dst_argb, int width) {</span>
<span class="lineNum">     656 </span>            :   int x;
<span class="lineNum">     657 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width; ++x) {</span>
<span class="lineNum">     658 </span><span class="lineNoCov">          0 :     uint8 y = RGBToYJ(src_argb[2], src_argb[1], src_argb[0]);</span>
<span class="lineNum">     659 </span><span class="lineNoCov">          0 :     dst_argb[2] = dst_argb[1] = dst_argb[0] = y;</span>
<span class="lineNum">     660 </span><span class="lineNoCov">          0 :     dst_argb[3] = src_argb[3];</span>
<span class="lineNum">     661 </span><span class="lineNoCov">          0 :     dst_argb += 4;</span>
<span class="lineNum">     662 </span><span class="lineNoCov">          0 :     src_argb += 4;</span>
<span class="lineNum">     663 </span>            :   }
<span class="lineNum">     664 </span><span class="lineNoCov">          0 : }</span>
<a name="665"><span class="lineNum">     665 </span>            : </a>
<span class="lineNum">     666 </span>            : // Convert a row of image to Sepia tone.
<span class="lineNum">     667 </span><span class="lineNoCov">          0 : void ARGBSepiaRow_C(uint8* dst_argb, int width) {</span>
<span class="lineNum">     668 </span>            :   int x;
<span class="lineNum">     669 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width; ++x) {</span>
<span class="lineNum">     670 </span><span class="lineNoCov">          0 :     int b = dst_argb[0];</span>
<span class="lineNum">     671 </span><span class="lineNoCov">          0 :     int g = dst_argb[1];</span>
<span class="lineNum">     672 </span><span class="lineNoCov">          0 :     int r = dst_argb[2];</span>
<span class="lineNum">     673 </span><span class="lineNoCov">          0 :     int sb = (b * 17 + g * 68 + r * 35) &gt;&gt; 7;</span>
<span class="lineNum">     674 </span><span class="lineNoCov">          0 :     int sg = (b * 22 + g * 88 + r * 45) &gt;&gt; 7;</span>
<span class="lineNum">     675 </span><span class="lineNoCov">          0 :     int sr = (b * 24 + g * 98 + r * 50) &gt;&gt; 7;</span>
<span class="lineNum">     676 </span>            :     // b does not over flow. a is preserved from original.
<span class="lineNum">     677 </span><span class="lineNoCov">          0 :     dst_argb[0] = sb;</span>
<span class="lineNum">     678 </span><span class="lineNoCov">          0 :     dst_argb[1] = clamp255(sg);</span>
<span class="lineNum">     679 </span><span class="lineNoCov">          0 :     dst_argb[2] = clamp255(sr);</span>
<span class="lineNum">     680 </span><span class="lineNoCov">          0 :     dst_argb += 4;</span>
<span class="lineNum">     681 </span>            :   }
<span class="lineNum">     682 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">     683 </span>            : 
<a name="684"><span class="lineNum">     684 </span>            : // Apply color matrix to a row of image. Matrix is signed.</a>
<span class="lineNum">     685 </span>            : // TODO(fbarchard): Consider adding rounding (+32).
<span class="lineNum">     686 </span><span class="lineNoCov">          0 : void ARGBColorMatrixRow_C(const uint8* src_argb,</span>
<span class="lineNum">     687 </span>            :                           uint8* dst_argb,
<span class="lineNum">     688 </span>            :                           const int8* matrix_argb,
<span class="lineNum">     689 </span>            :                           int width) {
<span class="lineNum">     690 </span>            :   int x;
<span class="lineNum">     691 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width; ++x) {</span>
<span class="lineNum">     692 </span><span class="lineNoCov">          0 :     int b = src_argb[0];</span>
<span class="lineNum">     693 </span><span class="lineNoCov">          0 :     int g = src_argb[1];</span>
<span class="lineNum">     694 </span><span class="lineNoCov">          0 :     int r = src_argb[2];</span>
<span class="lineNum">     695 </span><span class="lineNoCov">          0 :     int a = src_argb[3];</span>
<span class="lineNum">     696 </span><span class="lineNoCov">          0 :     int sb = (b * matrix_argb[0] + g * matrix_argb[1] + r * matrix_argb[2] +</span>
<span class="lineNum">     697 </span><span class="lineNoCov">          0 :               a * matrix_argb[3]) &gt;&gt;</span>
<span class="lineNum">     698 </span><span class="lineNoCov">          0 :              6;</span>
<span class="lineNum">     699 </span><span class="lineNoCov">          0 :     int sg = (b * matrix_argb[4] + g * matrix_argb[5] + r * matrix_argb[6] +</span>
<span class="lineNum">     700 </span><span class="lineNoCov">          0 :               a * matrix_argb[7]) &gt;&gt;</span>
<span class="lineNum">     701 </span><span class="lineNoCov">          0 :              6;</span>
<span class="lineNum">     702 </span><span class="lineNoCov">          0 :     int sr = (b * matrix_argb[8] + g * matrix_argb[9] + r * matrix_argb[10] +</span>
<span class="lineNum">     703 </span><span class="lineNoCov">          0 :               a * matrix_argb[11]) &gt;&gt;</span>
<span class="lineNum">     704 </span><span class="lineNoCov">          0 :              6;</span>
<span class="lineNum">     705 </span><span class="lineNoCov">          0 :     int sa = (b * matrix_argb[12] + g * matrix_argb[13] + r * matrix_argb[14] +</span>
<span class="lineNum">     706 </span><span class="lineNoCov">          0 :               a * matrix_argb[15]) &gt;&gt;</span>
<span class="lineNum">     707 </span><span class="lineNoCov">          0 :              6;</span>
<span class="lineNum">     708 </span><span class="lineNoCov">          0 :     dst_argb[0] = Clamp(sb);</span>
<span class="lineNum">     709 </span><span class="lineNoCov">          0 :     dst_argb[1] = Clamp(sg);</span>
<span class="lineNum">     710 </span><span class="lineNoCov">          0 :     dst_argb[2] = Clamp(sr);</span>
<span class="lineNum">     711 </span><span class="lineNoCov">          0 :     dst_argb[3] = Clamp(sa);</span>
<span class="lineNum">     712 </span><span class="lineNoCov">          0 :     src_argb += 4;</span>
<span class="lineNum">     713 </span><span class="lineNoCov">          0 :     dst_argb += 4;</span>
<span class="lineNum">     714 </span>            :   }
<span class="lineNum">     715 </span><span class="lineNoCov">          0 : }</span>
<a name="716"><span class="lineNum">     716 </span>            : </a>
<span class="lineNum">     717 </span>            : // Apply color table to a row of image.
<span class="lineNum">     718 </span><span class="lineNoCov">          0 : void ARGBColorTableRow_C(uint8* dst_argb, const uint8* table_argb, int width) {</span>
<span class="lineNum">     719 </span>            :   int x;
<span class="lineNum">     720 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width; ++x) {</span>
<span class="lineNum">     721 </span><span class="lineNoCov">          0 :     int b = dst_argb[0];</span>
<span class="lineNum">     722 </span><span class="lineNoCov">          0 :     int g = dst_argb[1];</span>
<span class="lineNum">     723 </span><span class="lineNoCov">          0 :     int r = dst_argb[2];</span>
<span class="lineNum">     724 </span><span class="lineNoCov">          0 :     int a = dst_argb[3];</span>
<span class="lineNum">     725 </span><span class="lineNoCov">          0 :     dst_argb[0] = table_argb[b * 4 + 0];</span>
<span class="lineNum">     726 </span><span class="lineNoCov">          0 :     dst_argb[1] = table_argb[g * 4 + 1];</span>
<span class="lineNum">     727 </span><span class="lineNoCov">          0 :     dst_argb[2] = table_argb[r * 4 + 2];</span>
<span class="lineNum">     728 </span><span class="lineNoCov">          0 :     dst_argb[3] = table_argb[a * 4 + 3];</span>
<span class="lineNum">     729 </span><span class="lineNoCov">          0 :     dst_argb += 4;</span>
<span class="lineNum">     730 </span>            :   }
<span class="lineNum">     731 </span><span class="lineNoCov">          0 : }</span>
<a name="732"><span class="lineNum">     732 </span>            : </a>
<span class="lineNum">     733 </span>            : // Apply color table to a row of image.
<span class="lineNum">     734 </span><span class="lineNoCov">          0 : void RGBColorTableRow_C(uint8* dst_argb, const uint8* table_argb, int width) {</span>
<span class="lineNum">     735 </span>            :   int x;
<span class="lineNum">     736 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width; ++x) {</span>
<span class="lineNum">     737 </span><span class="lineNoCov">          0 :     int b = dst_argb[0];</span>
<span class="lineNum">     738 </span><span class="lineNoCov">          0 :     int g = dst_argb[1];</span>
<span class="lineNum">     739 </span><span class="lineNoCov">          0 :     int r = dst_argb[2];</span>
<span class="lineNum">     740 </span><span class="lineNoCov">          0 :     dst_argb[0] = table_argb[b * 4 + 0];</span>
<span class="lineNum">     741 </span><span class="lineNoCov">          0 :     dst_argb[1] = table_argb[g * 4 + 1];</span>
<span class="lineNum">     742 </span><span class="lineNoCov">          0 :     dst_argb[2] = table_argb[r * 4 + 2];</span>
<span class="lineNum">     743 </span><span class="lineNoCov">          0 :     dst_argb += 4;</span>
<span class="lineNum">     744 </span>            :   }
<a name="745"><span class="lineNum">     745 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     746 </span>            : 
<span class="lineNum">     747 </span><span class="lineNoCov">          0 : void ARGBQuantizeRow_C(uint8* dst_argb,</span>
<span class="lineNum">     748 </span>            :                        int scale,
<span class="lineNum">     749 </span>            :                        int interval_size,
<span class="lineNum">     750 </span>            :                        int interval_offset,
<span class="lineNum">     751 </span>            :                        int width) {
<span class="lineNum">     752 </span>            :   int x;
<span class="lineNum">     753 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width; ++x) {</span>
<span class="lineNum">     754 </span><span class="lineNoCov">          0 :     int b = dst_argb[0];</span>
<span class="lineNum">     755 </span><span class="lineNoCov">          0 :     int g = dst_argb[1];</span>
<span class="lineNum">     756 </span><span class="lineNoCov">          0 :     int r = dst_argb[2];</span>
<span class="lineNum">     757 </span><span class="lineNoCov">          0 :     dst_argb[0] = (b * scale &gt;&gt; 16) * interval_size + interval_offset;</span>
<span class="lineNum">     758 </span><span class="lineNoCov">          0 :     dst_argb[1] = (g * scale &gt;&gt; 16) * interval_size + interval_offset;</span>
<span class="lineNum">     759 </span><span class="lineNoCov">          0 :     dst_argb[2] = (r * scale &gt;&gt; 16) * interval_size + interval_offset;</span>
<span class="lineNum">     760 </span><span class="lineNoCov">          0 :     dst_argb += 4;</span>
<span class="lineNum">     761 </span>            :   }
<span class="lineNum">     762 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">     763 </span>            : 
<span class="lineNum">     764 </span>            : #define REPEAT8(v) (v) | ((v) &lt;&lt; 8)
<a name="765"><span class="lineNum">     765 </span>            : #define SHADE(f, v) v* f &gt;&gt; 24</a>
<span class="lineNum">     766 </span>            : 
<span class="lineNum">     767 </span><span class="lineNoCov">          0 : void ARGBShadeRow_C(const uint8* src_argb,</span>
<span class="lineNum">     768 </span>            :                     uint8* dst_argb,
<span class="lineNum">     769 </span>            :                     int width,
<span class="lineNum">     770 </span>            :                     uint32 value) {
<span class="lineNum">     771 </span><span class="lineNoCov">          0 :   const uint32 b_scale = REPEAT8(value &amp; 0xff);</span>
<span class="lineNum">     772 </span><span class="lineNoCov">          0 :   const uint32 g_scale = REPEAT8((value &gt;&gt; 8) &amp; 0xff);</span>
<span class="lineNum">     773 </span><span class="lineNoCov">          0 :   const uint32 r_scale = REPEAT8((value &gt;&gt; 16) &amp; 0xff);</span>
<span class="lineNum">     774 </span><span class="lineNoCov">          0 :   const uint32 a_scale = REPEAT8(value &gt;&gt; 24);</span>
<span class="lineNum">     775 </span>            : 
<span class="lineNum">     776 </span>            :   int i;
<span class="lineNum">     777 </span><span class="lineNoCov">          0 :   for (i = 0; i &lt; width; ++i) {</span>
<span class="lineNum">     778 </span><span class="lineNoCov">          0 :     const uint32 b = REPEAT8(src_argb[0]);</span>
<span class="lineNum">     779 </span><span class="lineNoCov">          0 :     const uint32 g = REPEAT8(src_argb[1]);</span>
<span class="lineNum">     780 </span><span class="lineNoCov">          0 :     const uint32 r = REPEAT8(src_argb[2]);</span>
<span class="lineNum">     781 </span><span class="lineNoCov">          0 :     const uint32 a = REPEAT8(src_argb[3]);</span>
<span class="lineNum">     782 </span><span class="lineNoCov">          0 :     dst_argb[0] = SHADE(b, b_scale);</span>
<span class="lineNum">     783 </span><span class="lineNoCov">          0 :     dst_argb[1] = SHADE(g, g_scale);</span>
<span class="lineNum">     784 </span><span class="lineNoCov">          0 :     dst_argb[2] = SHADE(r, r_scale);</span>
<span class="lineNum">     785 </span><span class="lineNoCov">          0 :     dst_argb[3] = SHADE(a, a_scale);</span>
<span class="lineNum">     786 </span><span class="lineNoCov">          0 :     src_argb += 4;</span>
<span class="lineNum">     787 </span><span class="lineNoCov">          0 :     dst_argb += 4;</span>
<span class="lineNum">     788 </span>            :   }
<span class="lineNum">     789 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">     790 </span>            : #undef REPEAT8
<span class="lineNum">     791 </span>            : #undef SHADE
<span class="lineNum">     792 </span>            : 
<span class="lineNum">     793 </span>            : #define REPEAT8(v) (v) | ((v) &lt;&lt; 8)
<a name="794"><span class="lineNum">     794 </span>            : #define SHADE(f, v) v* f &gt;&gt; 16</a>
<span class="lineNum">     795 </span>            : 
<span class="lineNum">     796 </span><span class="lineNoCov">          0 : void ARGBMultiplyRow_C(const uint8* src_argb0,</span>
<span class="lineNum">     797 </span>            :                        const uint8* src_argb1,
<span class="lineNum">     798 </span>            :                        uint8* dst_argb,
<span class="lineNum">     799 </span>            :                        int width) {
<span class="lineNum">     800 </span>            :   int i;
<span class="lineNum">     801 </span><span class="lineNoCov">          0 :   for (i = 0; i &lt; width; ++i) {</span>
<span class="lineNum">     802 </span><span class="lineNoCov">          0 :     const uint32 b = REPEAT8(src_argb0[0]);</span>
<span class="lineNum">     803 </span><span class="lineNoCov">          0 :     const uint32 g = REPEAT8(src_argb0[1]);</span>
<span class="lineNum">     804 </span><span class="lineNoCov">          0 :     const uint32 r = REPEAT8(src_argb0[2]);</span>
<span class="lineNum">     805 </span><span class="lineNoCov">          0 :     const uint32 a = REPEAT8(src_argb0[3]);</span>
<span class="lineNum">     806 </span><span class="lineNoCov">          0 :     const uint32 b_scale = src_argb1[0];</span>
<span class="lineNum">     807 </span><span class="lineNoCov">          0 :     const uint32 g_scale = src_argb1[1];</span>
<span class="lineNum">     808 </span><span class="lineNoCov">          0 :     const uint32 r_scale = src_argb1[2];</span>
<span class="lineNum">     809 </span><span class="lineNoCov">          0 :     const uint32 a_scale = src_argb1[3];</span>
<span class="lineNum">     810 </span><span class="lineNoCov">          0 :     dst_argb[0] = SHADE(b, b_scale);</span>
<span class="lineNum">     811 </span><span class="lineNoCov">          0 :     dst_argb[1] = SHADE(g, g_scale);</span>
<span class="lineNum">     812 </span><span class="lineNoCov">          0 :     dst_argb[2] = SHADE(r, r_scale);</span>
<span class="lineNum">     813 </span><span class="lineNoCov">          0 :     dst_argb[3] = SHADE(a, a_scale);</span>
<span class="lineNum">     814 </span><span class="lineNoCov">          0 :     src_argb0 += 4;</span>
<span class="lineNum">     815 </span><span class="lineNoCov">          0 :     src_argb1 += 4;</span>
<span class="lineNum">     816 </span><span class="lineNoCov">          0 :     dst_argb += 4;</span>
<span class="lineNum">     817 </span>            :   }
<span class="lineNum">     818 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">     819 </span>            : #undef REPEAT8
<span class="lineNum">     820 </span>            : #undef SHADE
<span class="lineNum">     821 </span>            : 
<a name="822"><span class="lineNum">     822 </span>            : #define SHADE(f, v) clamp255(v + f)</a>
<span class="lineNum">     823 </span>            : 
<span class="lineNum">     824 </span><span class="lineNoCov">          0 : void ARGBAddRow_C(const uint8* src_argb0,</span>
<span class="lineNum">     825 </span>            :                   const uint8* src_argb1,
<span class="lineNum">     826 </span>            :                   uint8* dst_argb,
<span class="lineNum">     827 </span>            :                   int width) {
<span class="lineNum">     828 </span>            :   int i;
<span class="lineNum">     829 </span><span class="lineNoCov">          0 :   for (i = 0; i &lt; width; ++i) {</span>
<span class="lineNum">     830 </span><span class="lineNoCov">          0 :     const int b = src_argb0[0];</span>
<span class="lineNum">     831 </span><span class="lineNoCov">          0 :     const int g = src_argb0[1];</span>
<span class="lineNum">     832 </span><span class="lineNoCov">          0 :     const int r = src_argb0[2];</span>
<span class="lineNum">     833 </span><span class="lineNoCov">          0 :     const int a = src_argb0[3];</span>
<span class="lineNum">     834 </span><span class="lineNoCov">          0 :     const int b_add = src_argb1[0];</span>
<span class="lineNum">     835 </span><span class="lineNoCov">          0 :     const int g_add = src_argb1[1];</span>
<span class="lineNum">     836 </span><span class="lineNoCov">          0 :     const int r_add = src_argb1[2];</span>
<span class="lineNum">     837 </span><span class="lineNoCov">          0 :     const int a_add = src_argb1[3];</span>
<span class="lineNum">     838 </span><span class="lineNoCov">          0 :     dst_argb[0] = SHADE(b, b_add);</span>
<span class="lineNum">     839 </span><span class="lineNoCov">          0 :     dst_argb[1] = SHADE(g, g_add);</span>
<span class="lineNum">     840 </span><span class="lineNoCov">          0 :     dst_argb[2] = SHADE(r, r_add);</span>
<span class="lineNum">     841 </span><span class="lineNoCov">          0 :     dst_argb[3] = SHADE(a, a_add);</span>
<span class="lineNum">     842 </span><span class="lineNoCov">          0 :     src_argb0 += 4;</span>
<span class="lineNum">     843 </span><span class="lineNoCov">          0 :     src_argb1 += 4;</span>
<span class="lineNum">     844 </span><span class="lineNoCov">          0 :     dst_argb += 4;</span>
<span class="lineNum">     845 </span>            :   }
<span class="lineNum">     846 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">     847 </span>            : #undef SHADE
<span class="lineNum">     848 </span>            : 
<a name="849"><span class="lineNum">     849 </span>            : #define SHADE(f, v) clamp0(f - v)</a>
<span class="lineNum">     850 </span>            : 
<span class="lineNum">     851 </span><span class="lineNoCov">          0 : void ARGBSubtractRow_C(const uint8* src_argb0,</span>
<span class="lineNum">     852 </span>            :                        const uint8* src_argb1,
<span class="lineNum">     853 </span>            :                        uint8* dst_argb,
<span class="lineNum">     854 </span>            :                        int width) {
<span class="lineNum">     855 </span>            :   int i;
<span class="lineNum">     856 </span><span class="lineNoCov">          0 :   for (i = 0; i &lt; width; ++i) {</span>
<span class="lineNum">     857 </span><span class="lineNoCov">          0 :     const int b = src_argb0[0];</span>
<span class="lineNum">     858 </span><span class="lineNoCov">          0 :     const int g = src_argb0[1];</span>
<span class="lineNum">     859 </span><span class="lineNoCov">          0 :     const int r = src_argb0[2];</span>
<span class="lineNum">     860 </span><span class="lineNoCov">          0 :     const int a = src_argb0[3];</span>
<span class="lineNum">     861 </span><span class="lineNoCov">          0 :     const int b_sub = src_argb1[0];</span>
<span class="lineNum">     862 </span><span class="lineNoCov">          0 :     const int g_sub = src_argb1[1];</span>
<span class="lineNum">     863 </span><span class="lineNoCov">          0 :     const int r_sub = src_argb1[2];</span>
<span class="lineNum">     864 </span><span class="lineNoCov">          0 :     const int a_sub = src_argb1[3];</span>
<span class="lineNum">     865 </span><span class="lineNoCov">          0 :     dst_argb[0] = SHADE(b, b_sub);</span>
<span class="lineNum">     866 </span><span class="lineNoCov">          0 :     dst_argb[1] = SHADE(g, g_sub);</span>
<span class="lineNum">     867 </span><span class="lineNoCov">          0 :     dst_argb[2] = SHADE(r, r_sub);</span>
<span class="lineNum">     868 </span><span class="lineNoCov">          0 :     dst_argb[3] = SHADE(a, a_sub);</span>
<span class="lineNum">     869 </span><span class="lineNoCov">          0 :     src_argb0 += 4;</span>
<span class="lineNum">     870 </span><span class="lineNoCov">          0 :     src_argb1 += 4;</span>
<span class="lineNum">     871 </span><span class="lineNoCov">          0 :     dst_argb += 4;</span>
<span class="lineNum">     872 </span>            :   }
<span class="lineNum">     873 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">     874 </span>            : #undef SHADE
<a name="875"><span class="lineNum">     875 </span>            : </a>
<span class="lineNum">     876 </span>            : // Sobel functions which mimics SSSE3.
<span class="lineNum">     877 </span><span class="lineNoCov">          0 : void SobelXRow_C(const uint8* src_y0,</span>
<span class="lineNum">     878 </span>            :                  const uint8* src_y1,
<span class="lineNum">     879 </span>            :                  const uint8* src_y2,
<span class="lineNum">     880 </span>            :                  uint8* dst_sobelx,
<span class="lineNum">     881 </span>            :                  int width) {
<span class="lineNum">     882 </span>            :   int i;
<span class="lineNum">     883 </span><span class="lineNoCov">          0 :   for (i = 0; i &lt; width; ++i) {</span>
<span class="lineNum">     884 </span><span class="lineNoCov">          0 :     int a = src_y0[i];</span>
<span class="lineNum">     885 </span><span class="lineNoCov">          0 :     int b = src_y1[i];</span>
<span class="lineNum">     886 </span><span class="lineNoCov">          0 :     int c = src_y2[i];</span>
<span class="lineNum">     887 </span><span class="lineNoCov">          0 :     int a_sub = src_y0[i + 2];</span>
<span class="lineNum">     888 </span><span class="lineNoCov">          0 :     int b_sub = src_y1[i + 2];</span>
<span class="lineNum">     889 </span><span class="lineNoCov">          0 :     int c_sub = src_y2[i + 2];</span>
<span class="lineNum">     890 </span><span class="lineNoCov">          0 :     int a_diff = a - a_sub;</span>
<span class="lineNum">     891 </span><span class="lineNoCov">          0 :     int b_diff = b - b_sub;</span>
<span class="lineNum">     892 </span><span class="lineNoCov">          0 :     int c_diff = c - c_sub;</span>
<span class="lineNum">     893 </span><span class="lineNoCov">          0 :     int sobel = Abs(a_diff + b_diff * 2 + c_diff);</span>
<span class="lineNum">     894 </span><span class="lineNoCov">          0 :     dst_sobelx[i] = (uint8)(clamp255(sobel));</span>
<span class="lineNum">     895 </span>            :   }
<a name="896"><span class="lineNum">     896 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     897 </span>            : 
<span class="lineNum">     898 </span><span class="lineNoCov">          0 : void SobelYRow_C(const uint8* src_y0,</span>
<span class="lineNum">     899 </span>            :                  const uint8* src_y1,
<span class="lineNum">     900 </span>            :                  uint8* dst_sobely,
<span class="lineNum">     901 </span>            :                  int width) {
<span class="lineNum">     902 </span>            :   int i;
<span class="lineNum">     903 </span><span class="lineNoCov">          0 :   for (i = 0; i &lt; width; ++i) {</span>
<span class="lineNum">     904 </span><span class="lineNoCov">          0 :     int a = src_y0[i + 0];</span>
<span class="lineNum">     905 </span><span class="lineNoCov">          0 :     int b = src_y0[i + 1];</span>
<span class="lineNum">     906 </span><span class="lineNoCov">          0 :     int c = src_y0[i + 2];</span>
<span class="lineNum">     907 </span><span class="lineNoCov">          0 :     int a_sub = src_y1[i + 0];</span>
<span class="lineNum">     908 </span><span class="lineNoCov">          0 :     int b_sub = src_y1[i + 1];</span>
<span class="lineNum">     909 </span><span class="lineNoCov">          0 :     int c_sub = src_y1[i + 2];</span>
<span class="lineNum">     910 </span><span class="lineNoCov">          0 :     int a_diff = a - a_sub;</span>
<span class="lineNum">     911 </span><span class="lineNoCov">          0 :     int b_diff = b - b_sub;</span>
<span class="lineNum">     912 </span><span class="lineNoCov">          0 :     int c_diff = c - c_sub;</span>
<span class="lineNum">     913 </span><span class="lineNoCov">          0 :     int sobel = Abs(a_diff + b_diff * 2 + c_diff);</span>
<span class="lineNum">     914 </span><span class="lineNoCov">          0 :     dst_sobely[i] = (uint8)(clamp255(sobel));</span>
<span class="lineNum">     915 </span>            :   }
<a name="916"><span class="lineNum">     916 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     917 </span>            : 
<span class="lineNum">     918 </span><span class="lineNoCov">          0 : void SobelRow_C(const uint8* src_sobelx,</span>
<span class="lineNum">     919 </span>            :                 const uint8* src_sobely,
<span class="lineNum">     920 </span>            :                 uint8* dst_argb,
<span class="lineNum">     921 </span>            :                 int width) {
<span class="lineNum">     922 </span>            :   int i;
<span class="lineNum">     923 </span><span class="lineNoCov">          0 :   for (i = 0; i &lt; width; ++i) {</span>
<span class="lineNum">     924 </span><span class="lineNoCov">          0 :     int r = src_sobelx[i];</span>
<span class="lineNum">     925 </span><span class="lineNoCov">          0 :     int b = src_sobely[i];</span>
<span class="lineNum">     926 </span><span class="lineNoCov">          0 :     int s = clamp255(r + b);</span>
<span class="lineNum">     927 </span><span class="lineNoCov">          0 :     dst_argb[0] = (uint8)(s);</span>
<span class="lineNum">     928 </span><span class="lineNoCov">          0 :     dst_argb[1] = (uint8)(s);</span>
<span class="lineNum">     929 </span><span class="lineNoCov">          0 :     dst_argb[2] = (uint8)(s);</span>
<span class="lineNum">     930 </span><span class="lineNoCov">          0 :     dst_argb[3] = (uint8)(255u);</span>
<span class="lineNum">     931 </span><span class="lineNoCov">          0 :     dst_argb += 4;</span>
<span class="lineNum">     932 </span>            :   }
<a name="933"><span class="lineNum">     933 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     934 </span>            : 
<span class="lineNum">     935 </span><span class="lineNoCov">          0 : void SobelToPlaneRow_C(const uint8* src_sobelx,</span>
<span class="lineNum">     936 </span>            :                        const uint8* src_sobely,
<span class="lineNum">     937 </span>            :                        uint8* dst_y,
<span class="lineNum">     938 </span>            :                        int width) {
<span class="lineNum">     939 </span>            :   int i;
<span class="lineNum">     940 </span><span class="lineNoCov">          0 :   for (i = 0; i &lt; width; ++i) {</span>
<span class="lineNum">     941 </span><span class="lineNoCov">          0 :     int r = src_sobelx[i];</span>
<span class="lineNum">     942 </span><span class="lineNoCov">          0 :     int b = src_sobely[i];</span>
<span class="lineNum">     943 </span><span class="lineNoCov">          0 :     int s = clamp255(r + b);</span>
<span class="lineNum">     944 </span><span class="lineNoCov">          0 :     dst_y[i] = (uint8)(s);</span>
<span class="lineNum">     945 </span>            :   }
<a name="946"><span class="lineNum">     946 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     947 </span>            : 
<span class="lineNum">     948 </span><span class="lineNoCov">          0 : void SobelXYRow_C(const uint8* src_sobelx,</span>
<span class="lineNum">     949 </span>            :                   const uint8* src_sobely,
<span class="lineNum">     950 </span>            :                   uint8* dst_argb,
<span class="lineNum">     951 </span>            :                   int width) {
<span class="lineNum">     952 </span>            :   int i;
<span class="lineNum">     953 </span><span class="lineNoCov">          0 :   for (i = 0; i &lt; width; ++i) {</span>
<span class="lineNum">     954 </span><span class="lineNoCov">          0 :     int r = src_sobelx[i];</span>
<span class="lineNum">     955 </span><span class="lineNoCov">          0 :     int b = src_sobely[i];</span>
<span class="lineNum">     956 </span><span class="lineNoCov">          0 :     int g = clamp255(r + b);</span>
<span class="lineNum">     957 </span><span class="lineNoCov">          0 :     dst_argb[0] = (uint8)(b);</span>
<span class="lineNum">     958 </span><span class="lineNoCov">          0 :     dst_argb[1] = (uint8)(g);</span>
<span class="lineNum">     959 </span><span class="lineNoCov">          0 :     dst_argb[2] = (uint8)(r);</span>
<span class="lineNum">     960 </span><span class="lineNoCov">          0 :     dst_argb[3] = (uint8)(255u);</span>
<span class="lineNum">     961 </span><span class="lineNoCov">          0 :     dst_argb += 4;</span>
<span class="lineNum">     962 </span>            :   }
<a name="963"><span class="lineNum">     963 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     964 </span>            : 
<span class="lineNum">     965 </span><span class="lineNoCov">          0 : void J400ToARGBRow_C(const uint8* src_y, uint8* dst_argb, int width) {</span>
<span class="lineNum">     966 </span>            :   // Copy a Y to RGB.
<span class="lineNum">     967 </span>            :   int x;
<span class="lineNum">     968 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width; ++x) {</span>
<span class="lineNum">     969 </span><span class="lineNoCov">          0 :     uint8 y = src_y[0];</span>
<span class="lineNum">     970 </span><span class="lineNoCov">          0 :     dst_argb[2] = dst_argb[1] = dst_argb[0] = y;</span>
<span class="lineNum">     971 </span><span class="lineNoCov">          0 :     dst_argb[3] = 255u;</span>
<span class="lineNum">     972 </span><span class="lineNoCov">          0 :     dst_argb += 4;</span>
<span class="lineNum">     973 </span><span class="lineNoCov">          0 :     ++src_y;</span>
<span class="lineNum">     974 </span>            :   }
<span class="lineNum">     975 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">     976 </span>            : 
<span class="lineNum">     977 </span>            : // TODO(fbarchard): Unify these structures to be platform independent.
<span class="lineNum">     978 </span>            : // TODO(fbarchard): Generate SIMD structures from float matrix.
<span class="lineNum">     979 </span>            : 
<span class="lineNum">     980 </span>            : // BT.601 YUV to RGB reference
<span class="lineNum">     981 </span>            : //  R = (Y - 16) * 1.164              - V * -1.596
<span class="lineNum">     982 </span>            : //  G = (Y - 16) * 1.164 - U *  0.391 - V *  0.813
<span class="lineNum">     983 </span>            : //  B = (Y - 16) * 1.164 - U * -2.018
<span class="lineNum">     984 </span>            : 
<span class="lineNum">     985 </span>            : // Y contribution to R,G,B.  Scale and bias.
<span class="lineNum">     986 </span>            : #define YG 18997  /* round(1.164 * 64 * 256 * 256 / 257) */
<span class="lineNum">     987 </span>            : #define YGB -1160 /* 1.164 * 64 * -16 + 64 / 2 */
<span class="lineNum">     988 </span>            : 
<span class="lineNum">     989 </span>            : // U and V contributions to R,G,B.
<span class="lineNum">     990 </span>            : #define UB -128 /* max(-128, round(-2.018 * 64)) */
<span class="lineNum">     991 </span>            : #define UG 25   /* round(0.391 * 64) */
<span class="lineNum">     992 </span>            : #define VG 52   /* round(0.813 * 64) */
<span class="lineNum">     993 </span>            : #define VR -102 /* round(-1.596 * 64) */
<span class="lineNum">     994 </span>            : 
<span class="lineNum">     995 </span>            : // Bias values to subtract 16 from Y and 128 from U and V.
<span class="lineNum">     996 </span>            : #define BB (UB * 128 + YGB)
<span class="lineNum">     997 </span>            : #define BG (UG * 128 + VG * 128 + YGB)
<span class="lineNum">     998 </span>            : #define BR (VR * 128 + YGB)
<span class="lineNum">     999 </span>            : 
<span class="lineNum">    1000 </span>            : #if defined(__aarch64__)  // 64 bit arm
<span class="lineNum">    1001 </span>            : const struct YuvConstants SIMD_ALIGNED(kYuvI601Constants) = {
<span class="lineNum">    1002 </span>            :     {-UB, -VR, -UB, -VR, -UB, -VR, -UB, -VR},
<span class="lineNum">    1003 </span>            :     {-UB, -VR, -UB, -VR, -UB, -VR, -UB, -VR},
<span class="lineNum">    1004 </span>            :     {UG, VG, UG, VG, UG, VG, UG, VG},
<span class="lineNum">    1005 </span>            :     {UG, VG, UG, VG, UG, VG, UG, VG},
<span class="lineNum">    1006 </span>            :     {BB, BG, BR, 0, 0, 0, 0, 0},
<span class="lineNum">    1007 </span>            :     {0x0101 * YG, 0, 0, 0}};
<span class="lineNum">    1008 </span>            : const struct YuvConstants SIMD_ALIGNED(kYvuI601Constants) = {
<span class="lineNum">    1009 </span>            :     {-VR, -UB, -VR, -UB, -VR, -UB, -VR, -UB},
<span class="lineNum">    1010 </span>            :     {-VR, -UB, -VR, -UB, -VR, -UB, -VR, -UB},
<span class="lineNum">    1011 </span>            :     {VG, UG, VG, UG, VG, UG, VG, UG},
<span class="lineNum">    1012 </span>            :     {VG, UG, VG, UG, VG, UG, VG, UG},
<span class="lineNum">    1013 </span>            :     {BR, BG, BB, 0, 0, 0, 0, 0},
<span class="lineNum">    1014 </span>            :     {0x0101 * YG, 0, 0, 0}};
<span class="lineNum">    1015 </span>            : #elif defined(__arm__)  // 32 bit arm
<span class="lineNum">    1016 </span>            : const struct YuvConstants SIMD_ALIGNED(kYuvI601Constants) = {
<span class="lineNum">    1017 </span>            :     {-UB, -UB, -UB, -UB, -VR, -VR, -VR, -VR, 0, 0, 0, 0, 0, 0, 0, 0},
<span class="lineNum">    1018 </span>            :     {UG, UG, UG, UG, VG, VG, VG, VG, 0, 0, 0, 0, 0, 0, 0, 0},
<span class="lineNum">    1019 </span>            :     {BB, BG, BR, 0, 0, 0, 0, 0},
<span class="lineNum">    1020 </span>            :     {0x0101 * YG, 0, 0, 0}};
<span class="lineNum">    1021 </span>            : const struct YuvConstants SIMD_ALIGNED(kYvuI601Constants) = {
<span class="lineNum">    1022 </span>            :     {-VR, -VR, -VR, -VR, -UB, -UB, -UB, -UB, 0, 0, 0, 0, 0, 0, 0, 0},
<span class="lineNum">    1023 </span>            :     {VG, VG, VG, VG, UG, UG, UG, UG, 0, 0, 0, 0, 0, 0, 0, 0},
<span class="lineNum">    1024 </span>            :     {BR, BG, BB, 0, 0, 0, 0, 0},
<span class="lineNum">    1025 </span>            :     {0x0101 * YG, 0, 0, 0}};
<span class="lineNum">    1026 </span>            : #else
<span class="lineNum">    1027 </span>            : const struct YuvConstants SIMD_ALIGNED(kYuvI601Constants) = {
<span class="lineNum">    1028 </span>            :     {UB, 0, UB, 0, UB, 0, UB, 0, UB, 0, UB, 0, UB, 0, UB, 0,
<span class="lineNum">    1029 </span>            :      UB, 0, UB, 0, UB, 0, UB, 0, UB, 0, UB, 0, UB, 0, UB, 0},
<span class="lineNum">    1030 </span>            :     {UG, VG, UG, VG, UG, VG, UG, VG, UG, VG, UG, VG, UG, VG, UG, VG,
<span class="lineNum">    1031 </span>            :      UG, VG, UG, VG, UG, VG, UG, VG, UG, VG, UG, VG, UG, VG, UG, VG},
<span class="lineNum">    1032 </span>            :     {0, VR, 0, VR, 0, VR, 0, VR, 0, VR, 0, VR, 0, VR, 0, VR,
<span class="lineNum">    1033 </span>            :      0, VR, 0, VR, 0, VR, 0, VR, 0, VR, 0, VR, 0, VR, 0, VR},
<span class="lineNum">    1034 </span>            :     {BB, BB, BB, BB, BB, BB, BB, BB, BB, BB, BB, BB, BB, BB, BB, BB},
<span class="lineNum">    1035 </span>            :     {BG, BG, BG, BG, BG, BG, BG, BG, BG, BG, BG, BG, BG, BG, BG, BG},
<span class="lineNum">    1036 </span>            :     {BR, BR, BR, BR, BR, BR, BR, BR, BR, BR, BR, BR, BR, BR, BR, BR},
<span class="lineNum">    1037 </span>            :     {YG, YG, YG, YG, YG, YG, YG, YG, YG, YG, YG, YG, YG, YG, YG, YG}};
<span class="lineNum">    1038 </span>            : const struct YuvConstants SIMD_ALIGNED(kYvuI601Constants) = {
<span class="lineNum">    1039 </span>            :     {VR, 0, VR, 0, VR, 0, VR, 0, VR, 0, VR, 0, VR, 0, VR, 0,
<span class="lineNum">    1040 </span>            :      VR, 0, VR, 0, VR, 0, VR, 0, VR, 0, VR, 0, VR, 0, VR, 0},
<span class="lineNum">    1041 </span>            :     {VG, UG, VG, UG, VG, UG, VG, UG, VG, UG, VG, UG, VG, UG, VG, UG,
<span class="lineNum">    1042 </span>            :      VG, UG, VG, UG, VG, UG, VG, UG, VG, UG, VG, UG, VG, UG, VG, UG},
<span class="lineNum">    1043 </span>            :     {0, UB, 0, UB, 0, UB, 0, UB, 0, UB, 0, UB, 0, UB, 0, UB,
<span class="lineNum">    1044 </span>            :      0, UB, 0, UB, 0, UB, 0, UB, 0, UB, 0, UB, 0, UB, 0, UB},
<span class="lineNum">    1045 </span>            :     {BR, BR, BR, BR, BR, BR, BR, BR, BR, BR, BR, BR, BR, BR, BR, BR},
<span class="lineNum">    1046 </span>            :     {BG, BG, BG, BG, BG, BG, BG, BG, BG, BG, BG, BG, BG, BG, BG, BG},
<span class="lineNum">    1047 </span>            :     {BB, BB, BB, BB, BB, BB, BB, BB, BB, BB, BB, BB, BB, BB, BB, BB},
<span class="lineNum">    1048 </span>            :     {YG, YG, YG, YG, YG, YG, YG, YG, YG, YG, YG, YG, YG, YG, YG, YG}};
<span class="lineNum">    1049 </span>            : #endif
<span class="lineNum">    1050 </span>            : 
<span class="lineNum">    1051 </span>            : #undef BB
<span class="lineNum">    1052 </span>            : #undef BG
<span class="lineNum">    1053 </span>            : #undef BR
<span class="lineNum">    1054 </span>            : #undef YGB
<span class="lineNum">    1055 </span>            : #undef UB
<span class="lineNum">    1056 </span>            : #undef UG
<span class="lineNum">    1057 </span>            : #undef VG
<span class="lineNum">    1058 </span>            : #undef VR
<span class="lineNum">    1059 </span>            : #undef YG
<span class="lineNum">    1060 </span>            : 
<span class="lineNum">    1061 </span>            : // JPEG YUV to RGB reference
<span class="lineNum">    1062 </span>            : // *  R = Y                - V * -1.40200
<span class="lineNum">    1063 </span>            : // *  G = Y - U *  0.34414 - V *  0.71414
<span class="lineNum">    1064 </span>            : // *  B = Y - U * -1.77200
<span class="lineNum">    1065 </span>            : 
<span class="lineNum">    1066 </span>            : // Y contribution to R,G,B.  Scale and bias.
<span class="lineNum">    1067 </span>            : #define YG 16320 /* round(1.000 * 64 * 256 * 256 / 257) */
<span class="lineNum">    1068 </span>            : #define YGB 32   /* 64 / 2 */
<span class="lineNum">    1069 </span>            : 
<span class="lineNum">    1070 </span>            : // U and V contributions to R,G,B.
<span class="lineNum">    1071 </span>            : #define UB -113 /* round(-1.77200 * 64) */
<span class="lineNum">    1072 </span>            : #define UG 22   /* round(0.34414 * 64) */
<span class="lineNum">    1073 </span>            : #define VG 46   /* round(0.71414  * 64) */
<span class="lineNum">    1074 </span>            : #define VR -90  /* round(-1.40200 * 64) */
<span class="lineNum">    1075 </span>            : 
<span class="lineNum">    1076 </span>            : // Bias values to round, and subtract 128 from U and V.
<span class="lineNum">    1077 </span>            : #define BB (UB * 128 + YGB)
<span class="lineNum">    1078 </span>            : #define BG (UG * 128 + VG * 128 + YGB)
<span class="lineNum">    1079 </span>            : #define BR (VR * 128 + YGB)
<span class="lineNum">    1080 </span>            : 
<span class="lineNum">    1081 </span>            : #if defined(__aarch64__)
<span class="lineNum">    1082 </span>            : const struct YuvConstants SIMD_ALIGNED(kYuvJPEGConstants) = {
<span class="lineNum">    1083 </span>            :     {-UB, -VR, -UB, -VR, -UB, -VR, -UB, -VR},
<span class="lineNum">    1084 </span>            :     {-UB, -VR, -UB, -VR, -UB, -VR, -UB, -VR},
<span class="lineNum">    1085 </span>            :     {UG, VG, UG, VG, UG, VG, UG, VG},
<span class="lineNum">    1086 </span>            :     {UG, VG, UG, VG, UG, VG, UG, VG},
<span class="lineNum">    1087 </span>            :     {BB, BG, BR, 0, 0, 0, 0, 0},
<span class="lineNum">    1088 </span>            :     {0x0101 * YG, 0, 0, 0}};
<span class="lineNum">    1089 </span>            : const struct YuvConstants SIMD_ALIGNED(kYvuJPEGConstants) = {
<span class="lineNum">    1090 </span>            :     {-VR, -UB, -VR, -UB, -VR, -UB, -VR, -UB},
<span class="lineNum">    1091 </span>            :     {-VR, -UB, -VR, -UB, -VR, -UB, -VR, -UB},
<span class="lineNum">    1092 </span>            :     {VG, UG, VG, UG, VG, UG, VG, UG},
<span class="lineNum">    1093 </span>            :     {VG, UG, VG, UG, VG, UG, VG, UG},
<span class="lineNum">    1094 </span>            :     {BR, BG, BB, 0, 0, 0, 0, 0},
<span class="lineNum">    1095 </span>            :     {0x0101 * YG, 0, 0, 0}};
<span class="lineNum">    1096 </span>            : #elif defined(__arm__)
<span class="lineNum">    1097 </span>            : const struct YuvConstants SIMD_ALIGNED(kYuvJPEGConstants) = {
<span class="lineNum">    1098 </span>            :     {-UB, -UB, -UB, -UB, -VR, -VR, -VR, -VR, 0, 0, 0, 0, 0, 0, 0, 0},
<span class="lineNum">    1099 </span>            :     {UG, UG, UG, UG, VG, VG, VG, VG, 0, 0, 0, 0, 0, 0, 0, 0},
<span class="lineNum">    1100 </span>            :     {BB, BG, BR, 0, 0, 0, 0, 0},
<span class="lineNum">    1101 </span>            :     {0x0101 * YG, 0, 0, 0}};
<span class="lineNum">    1102 </span>            : const struct YuvConstants SIMD_ALIGNED(kYvuJPEGConstants) = {
<span class="lineNum">    1103 </span>            :     {-VR, -VR, -VR, -VR, -UB, -UB, -UB, -UB, 0, 0, 0, 0, 0, 0, 0, 0},
<span class="lineNum">    1104 </span>            :     {VG, VG, VG, VG, UG, UG, UG, UG, 0, 0, 0, 0, 0, 0, 0, 0},
<span class="lineNum">    1105 </span>            :     {BR, BG, BB, 0, 0, 0, 0, 0},
<span class="lineNum">    1106 </span>            :     {0x0101 * YG, 0, 0, 0}};
<span class="lineNum">    1107 </span>            : #else
<span class="lineNum">    1108 </span>            : const struct YuvConstants SIMD_ALIGNED(kYuvJPEGConstants) = {
<span class="lineNum">    1109 </span>            :     {UB, 0, UB, 0, UB, 0, UB, 0, UB, 0, UB, 0, UB, 0, UB, 0,
<span class="lineNum">    1110 </span>            :      UB, 0, UB, 0, UB, 0, UB, 0, UB, 0, UB, 0, UB, 0, UB, 0},
<span class="lineNum">    1111 </span>            :     {UG, VG, UG, VG, UG, VG, UG, VG, UG, VG, UG, VG, UG, VG, UG, VG,
<span class="lineNum">    1112 </span>            :      UG, VG, UG, VG, UG, VG, UG, VG, UG, VG, UG, VG, UG, VG, UG, VG},
<span class="lineNum">    1113 </span>            :     {0, VR, 0, VR, 0, VR, 0, VR, 0, VR, 0, VR, 0, VR, 0, VR,
<span class="lineNum">    1114 </span>            :      0, VR, 0, VR, 0, VR, 0, VR, 0, VR, 0, VR, 0, VR, 0, VR},
<span class="lineNum">    1115 </span>            :     {BB, BB, BB, BB, BB, BB, BB, BB, BB, BB, BB, BB, BB, BB, BB, BB},
<span class="lineNum">    1116 </span>            :     {BG, BG, BG, BG, BG, BG, BG, BG, BG, BG, BG, BG, BG, BG, BG, BG},
<span class="lineNum">    1117 </span>            :     {BR, BR, BR, BR, BR, BR, BR, BR, BR, BR, BR, BR, BR, BR, BR, BR},
<span class="lineNum">    1118 </span>            :     {YG, YG, YG, YG, YG, YG, YG, YG, YG, YG, YG, YG, YG, YG, YG, YG}};
<span class="lineNum">    1119 </span>            : const struct YuvConstants SIMD_ALIGNED(kYvuJPEGConstants) = {
<span class="lineNum">    1120 </span>            :     {VR, 0, VR, 0, VR, 0, VR, 0, VR, 0, VR, 0, VR, 0, VR, 0,
<span class="lineNum">    1121 </span>            :      VR, 0, VR, 0, VR, 0, VR, 0, VR, 0, VR, 0, VR, 0, VR, 0},
<span class="lineNum">    1122 </span>            :     {VG, UG, VG, UG, VG, UG, VG, UG, VG, UG, VG, UG, VG, UG, VG, UG,
<span class="lineNum">    1123 </span>            :      VG, UG, VG, UG, VG, UG, VG, UG, VG, UG, VG, UG, VG, UG, VG, UG},
<span class="lineNum">    1124 </span>            :     {0, UB, 0, UB, 0, UB, 0, UB, 0, UB, 0, UB, 0, UB, 0, UB,
<span class="lineNum">    1125 </span>            :      0, UB, 0, UB, 0, UB, 0, UB, 0, UB, 0, UB, 0, UB, 0, UB},
<span class="lineNum">    1126 </span>            :     {BR, BR, BR, BR, BR, BR, BR, BR, BR, BR, BR, BR, BR, BR, BR, BR},
<span class="lineNum">    1127 </span>            :     {BG, BG, BG, BG, BG, BG, BG, BG, BG, BG, BG, BG, BG, BG, BG, BG},
<span class="lineNum">    1128 </span>            :     {BB, BB, BB, BB, BB, BB, BB, BB, BB, BB, BB, BB, BB, BB, BB, BB},
<span class="lineNum">    1129 </span>            :     {YG, YG, YG, YG, YG, YG, YG, YG, YG, YG, YG, YG, YG, YG, YG, YG}};
<span class="lineNum">    1130 </span>            : #endif
<span class="lineNum">    1131 </span>            : 
<span class="lineNum">    1132 </span>            : #undef BB
<span class="lineNum">    1133 </span>            : #undef BG
<span class="lineNum">    1134 </span>            : #undef BR
<span class="lineNum">    1135 </span>            : #undef YGB
<span class="lineNum">    1136 </span>            : #undef UB
<span class="lineNum">    1137 </span>            : #undef UG
<span class="lineNum">    1138 </span>            : #undef VG
<span class="lineNum">    1139 </span>            : #undef VR
<span class="lineNum">    1140 </span>            : #undef YG
<span class="lineNum">    1141 </span>            : 
<span class="lineNum">    1142 </span>            : // BT.709 YUV to RGB reference
<span class="lineNum">    1143 </span>            : //  R = (Y - 16) * 1.164              - V * -1.793
<span class="lineNum">    1144 </span>            : //  G = (Y - 16) * 1.164 - U *  0.213 - V *  0.533
<span class="lineNum">    1145 </span>            : //  B = (Y - 16) * 1.164 - U * -2.112
<span class="lineNum">    1146 </span>            : // See also http://www.equasys.de/colorconversion.html
<span class="lineNum">    1147 </span>            : 
<span class="lineNum">    1148 </span>            : // Y contribution to R,G,B.  Scale and bias.
<span class="lineNum">    1149 </span>            : #define YG 18997  /* round(1.164 * 64 * 256 * 256 / 257) */
<span class="lineNum">    1150 </span>            : #define YGB -1160 /* 1.164 * 64 * -16 + 64 / 2 */
<span class="lineNum">    1151 </span>            : 
<span class="lineNum">    1152 </span>            : // TODO(fbarchard): Find way to express 2.112 instead of 2.0.
<span class="lineNum">    1153 </span>            : // U and V contributions to R,G,B.
<span class="lineNum">    1154 </span>            : #define UB -128 /* max(-128, round(-2.112 * 64)) */
<span class="lineNum">    1155 </span>            : #define UG 14   /* round(0.213 * 64) */
<span class="lineNum">    1156 </span>            : #define VG 34   /* round(0.533  * 64) */
<span class="lineNum">    1157 </span>            : #define VR -115 /* round(-1.793 * 64) */
<span class="lineNum">    1158 </span>            : 
<span class="lineNum">    1159 </span>            : // Bias values to round, and subtract 128 from U and V.
<span class="lineNum">    1160 </span>            : #define BB (UB * 128 + YGB)
<span class="lineNum">    1161 </span>            : #define BG (UG * 128 + VG * 128 + YGB)
<span class="lineNum">    1162 </span>            : #define BR (VR * 128 + YGB)
<span class="lineNum">    1163 </span>            : 
<span class="lineNum">    1164 </span>            : #if defined(__aarch64__)
<span class="lineNum">    1165 </span>            : const struct YuvConstants SIMD_ALIGNED(kYuvH709Constants) = {
<span class="lineNum">    1166 </span>            :     {-UB, -VR, -UB, -VR, -UB, -VR, -UB, -VR},
<span class="lineNum">    1167 </span>            :     {-UB, -VR, -UB, -VR, -UB, -VR, -UB, -VR},
<span class="lineNum">    1168 </span>            :     {UG, VG, UG, VG, UG, VG, UG, VG},
<span class="lineNum">    1169 </span>            :     {UG, VG, UG, VG, UG, VG, UG, VG},
<span class="lineNum">    1170 </span>            :     {BB, BG, BR, 0, 0, 0, 0, 0},
<span class="lineNum">    1171 </span>            :     {0x0101 * YG, 0, 0, 0}};
<span class="lineNum">    1172 </span>            : const struct YuvConstants SIMD_ALIGNED(kYvuH709Constants) = {
<span class="lineNum">    1173 </span>            :     {-VR, -UB, -VR, -UB, -VR, -UB, -VR, -UB},
<span class="lineNum">    1174 </span>            :     {-VR, -UB, -VR, -UB, -VR, -UB, -VR, -UB},
<span class="lineNum">    1175 </span>            :     {VG, UG, VG, UG, VG, UG, VG, UG},
<span class="lineNum">    1176 </span>            :     {VG, UG, VG, UG, VG, UG, VG, UG},
<span class="lineNum">    1177 </span>            :     {BR, BG, BB, 0, 0, 0, 0, 0},
<span class="lineNum">    1178 </span>            :     {0x0101 * YG, 0, 0, 0}};
<span class="lineNum">    1179 </span>            : #elif defined(__arm__)
<span class="lineNum">    1180 </span>            : const struct YuvConstants SIMD_ALIGNED(kYuvH709Constants) = {
<span class="lineNum">    1181 </span>            :     {-UB, -UB, -UB, -UB, -VR, -VR, -VR, -VR, 0, 0, 0, 0, 0, 0, 0, 0},
<span class="lineNum">    1182 </span>            :     {UG, UG, UG, UG, VG, VG, VG, VG, 0, 0, 0, 0, 0, 0, 0, 0},
<span class="lineNum">    1183 </span>            :     {BB, BG, BR, 0, 0, 0, 0, 0},
<span class="lineNum">    1184 </span>            :     {0x0101 * YG, 0, 0, 0}};
<span class="lineNum">    1185 </span>            : const struct YuvConstants SIMD_ALIGNED(kYvuH709Constants) = {
<span class="lineNum">    1186 </span>            :     {-VR, -VR, -VR, -VR, -UB, -UB, -UB, -UB, 0, 0, 0, 0, 0, 0, 0, 0},
<span class="lineNum">    1187 </span>            :     {VG, VG, VG, VG, UG, UG, UG, UG, 0, 0, 0, 0, 0, 0, 0, 0},
<span class="lineNum">    1188 </span>            :     {BR, BG, BB, 0, 0, 0, 0, 0},
<span class="lineNum">    1189 </span>            :     {0x0101 * YG, 0, 0, 0}};
<span class="lineNum">    1190 </span>            : #else
<span class="lineNum">    1191 </span>            : const struct YuvConstants SIMD_ALIGNED(kYuvH709Constants) = {
<span class="lineNum">    1192 </span>            :     {UB, 0, UB, 0, UB, 0, UB, 0, UB, 0, UB, 0, UB, 0, UB, 0,
<span class="lineNum">    1193 </span>            :      UB, 0, UB, 0, UB, 0, UB, 0, UB, 0, UB, 0, UB, 0, UB, 0},
<span class="lineNum">    1194 </span>            :     {UG, VG, UG, VG, UG, VG, UG, VG, UG, VG, UG, VG, UG, VG, UG, VG,
<span class="lineNum">    1195 </span>            :      UG, VG, UG, VG, UG, VG, UG, VG, UG, VG, UG, VG, UG, VG, UG, VG},
<span class="lineNum">    1196 </span>            :     {0, VR, 0, VR, 0, VR, 0, VR, 0, VR, 0, VR, 0, VR, 0, VR,
<span class="lineNum">    1197 </span>            :      0, VR, 0, VR, 0, VR, 0, VR, 0, VR, 0, VR, 0, VR, 0, VR},
<span class="lineNum">    1198 </span>            :     {BB, BB, BB, BB, BB, BB, BB, BB, BB, BB, BB, BB, BB, BB, BB, BB},
<span class="lineNum">    1199 </span>            :     {BG, BG, BG, BG, BG, BG, BG, BG, BG, BG, BG, BG, BG, BG, BG, BG},
<span class="lineNum">    1200 </span>            :     {BR, BR, BR, BR, BR, BR, BR, BR, BR, BR, BR, BR, BR, BR, BR, BR},
<span class="lineNum">    1201 </span>            :     {YG, YG, YG, YG, YG, YG, YG, YG, YG, YG, YG, YG, YG, YG, YG, YG}};
<span class="lineNum">    1202 </span>            : const struct YuvConstants SIMD_ALIGNED(kYvuH709Constants) = {
<span class="lineNum">    1203 </span>            :     {VR, 0, VR, 0, VR, 0, VR, 0, VR, 0, VR, 0, VR, 0, VR, 0,
<span class="lineNum">    1204 </span>            :      VR, 0, VR, 0, VR, 0, VR, 0, VR, 0, VR, 0, VR, 0, VR, 0},
<span class="lineNum">    1205 </span>            :     {VG, UG, VG, UG, VG, UG, VG, UG, VG, UG, VG, UG, VG, UG, VG, UG,
<span class="lineNum">    1206 </span>            :      VG, UG, VG, UG, VG, UG, VG, UG, VG, UG, VG, UG, VG, UG, VG, UG},
<span class="lineNum">    1207 </span>            :     {0, UB, 0, UB, 0, UB, 0, UB, 0, UB, 0, UB, 0, UB, 0, UB,
<span class="lineNum">    1208 </span>            :      0, UB, 0, UB, 0, UB, 0, UB, 0, UB, 0, UB, 0, UB, 0, UB},
<span class="lineNum">    1209 </span>            :     {BR, BR, BR, BR, BR, BR, BR, BR, BR, BR, BR, BR, BR, BR, BR, BR},
<span class="lineNum">    1210 </span>            :     {BG, BG, BG, BG, BG, BG, BG, BG, BG, BG, BG, BG, BG, BG, BG, BG},
<span class="lineNum">    1211 </span>            :     {BB, BB, BB, BB, BB, BB, BB, BB, BB, BB, BB, BB, BB, BB, BB, BB},
<span class="lineNum">    1212 </span>            :     {YG, YG, YG, YG, YG, YG, YG, YG, YG, YG, YG, YG, YG, YG, YG, YG}};
<span class="lineNum">    1213 </span>            : #endif
<span class="lineNum">    1214 </span>            : 
<span class="lineNum">    1215 </span>            : #undef BB
<span class="lineNum">    1216 </span>            : #undef BG
<span class="lineNum">    1217 </span>            : #undef BR
<span class="lineNum">    1218 </span>            : #undef YGB
<span class="lineNum">    1219 </span>            : #undef UB
<span class="lineNum">    1220 </span>            : #undef UG
<span class="lineNum">    1221 </span>            : #undef VG
<span class="lineNum">    1222 </span>            : #undef VR
<span class="lineNum">    1223 </span>            : #undef YG
<a name="1224"><span class="lineNum">    1224 </span>            : </a>
<span class="lineNum">    1225 </span>            : // C reference code that mimics the YUV assembly.
<span class="lineNum">    1226 </span><span class="lineNoCov">          0 : static __inline void YuvPixel(uint8 y,</span>
<span class="lineNum">    1227 </span>            :                               uint8 u,
<span class="lineNum">    1228 </span>            :                               uint8 v,
<span class="lineNum">    1229 </span>            :                               uint8* b,
<span class="lineNum">    1230 </span>            :                               uint8* g,
<span class="lineNum">    1231 </span>            :                               uint8* r,
<span class="lineNum">    1232 </span>            :                               const struct YuvConstants* yuvconstants) {
<span class="lineNum">    1233 </span>            : #if defined(__aarch64__)
<span class="lineNum">    1234 </span>            :   int ub = -yuvconstants-&gt;kUVToRB[0];
<span class="lineNum">    1235 </span>            :   int ug = yuvconstants-&gt;kUVToG[0];
<span class="lineNum">    1236 </span>            :   int vg = yuvconstants-&gt;kUVToG[1];
<span class="lineNum">    1237 </span>            :   int vr = -yuvconstants-&gt;kUVToRB[1];
<span class="lineNum">    1238 </span>            :   int bb = yuvconstants-&gt;kUVBiasBGR[0];
<span class="lineNum">    1239 </span>            :   int bg = yuvconstants-&gt;kUVBiasBGR[1];
<span class="lineNum">    1240 </span>            :   int br = yuvconstants-&gt;kUVBiasBGR[2];
<span class="lineNum">    1241 </span>            :   int yg = yuvconstants-&gt;kYToRgb[0] / 0x0101;
<span class="lineNum">    1242 </span>            : #elif defined(__arm__)
<span class="lineNum">    1243 </span>            :   int ub = -yuvconstants-&gt;kUVToRB[0];
<span class="lineNum">    1244 </span>            :   int ug = yuvconstants-&gt;kUVToG[0];
<span class="lineNum">    1245 </span>            :   int vg = yuvconstants-&gt;kUVToG[4];
<span class="lineNum">    1246 </span>            :   int vr = -yuvconstants-&gt;kUVToRB[4];
<span class="lineNum">    1247 </span>            :   int bb = yuvconstants-&gt;kUVBiasBGR[0];
<span class="lineNum">    1248 </span>            :   int bg = yuvconstants-&gt;kUVBiasBGR[1];
<span class="lineNum">    1249 </span>            :   int br = yuvconstants-&gt;kUVBiasBGR[2];
<span class="lineNum">    1250 </span>            :   int yg = yuvconstants-&gt;kYToRgb[0] / 0x0101;
<span class="lineNum">    1251 </span>            : #else
<span class="lineNum">    1252 </span><span class="lineNoCov">          0 :   int ub = yuvconstants-&gt;kUVToB[0];</span>
<span class="lineNum">    1253 </span><span class="lineNoCov">          0 :   int ug = yuvconstants-&gt;kUVToG[0];</span>
<span class="lineNum">    1254 </span><span class="lineNoCov">          0 :   int vg = yuvconstants-&gt;kUVToG[1];</span>
<span class="lineNum">    1255 </span><span class="lineNoCov">          0 :   int vr = yuvconstants-&gt;kUVToR[1];</span>
<span class="lineNum">    1256 </span><span class="lineNoCov">          0 :   int bb = yuvconstants-&gt;kUVBiasB[0];</span>
<span class="lineNum">    1257 </span><span class="lineNoCov">          0 :   int bg = yuvconstants-&gt;kUVBiasG[0];</span>
<span class="lineNum">    1258 </span><span class="lineNoCov">          0 :   int br = yuvconstants-&gt;kUVBiasR[0];</span>
<span class="lineNum">    1259 </span><span class="lineNoCov">          0 :   int yg = yuvconstants-&gt;kYToRgb[0];</span>
<span class="lineNum">    1260 </span>            : #endif
<span class="lineNum">    1261 </span>            : 
<span class="lineNum">    1262 </span><span class="lineNoCov">          0 :   uint32 y1 = (uint32)(y * 0x0101 * yg) &gt;&gt; 16;</span>
<span class="lineNum">    1263 </span><span class="lineNoCov">          0 :   *b = Clamp((int32)(-(u * ub) + y1 + bb) &gt;&gt; 6);</span>
<span class="lineNum">    1264 </span><span class="lineNoCov">          0 :   *g = Clamp((int32)(-(u * ug + v * vg) + y1 + bg) &gt;&gt; 6);</span>
<span class="lineNum">    1265 </span><span class="lineNoCov">          0 :   *r = Clamp((int32)(-(v * vr) + y1 + br) &gt;&gt; 6);</span>
<span class="lineNum">    1266 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">    1267 </span>            : 
<span class="lineNum">    1268 </span>            : // Y contribution to R,G,B.  Scale and bias.
<span class="lineNum">    1269 </span>            : #define YG 18997  /* round(1.164 * 64 * 256 * 256 / 257) */
<span class="lineNum">    1270 </span>            : #define YGB -1160 /* 1.164 * 64 * -16 + 64 / 2 */
<a name="1271"><span class="lineNum">    1271 </span>            : </a>
<span class="lineNum">    1272 </span>            : // C reference code that mimics the YUV assembly.
<span class="lineNum">    1273 </span><span class="lineNoCov">          0 : static __inline void YPixel(uint8 y, uint8* b, uint8* g, uint8* r) {</span>
<span class="lineNum">    1274 </span><span class="lineNoCov">          0 :   uint32 y1 = (uint32)(y * 0x0101 * YG) &gt;&gt; 16;</span>
<span class="lineNum">    1275 </span><span class="lineNoCov">          0 :   *b = Clamp((int32)(y1 + YGB) &gt;&gt; 6);</span>
<span class="lineNum">    1276 </span><span class="lineNoCov">          0 :   *g = Clamp((int32)(y1 + YGB) &gt;&gt; 6);</span>
<span class="lineNum">    1277 </span><span class="lineNoCov">          0 :   *r = Clamp((int32)(y1 + YGB) &gt;&gt; 6);</span>
<span class="lineNum">    1278 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">    1279 </span>            : 
<span class="lineNum">    1280 </span>            : #undef YG
<span class="lineNum">    1281 </span>            : #undef YGB
<span class="lineNum">    1282 </span>            : 
<span class="lineNum">    1283 </span>            : #if !defined(LIBYUV_DISABLE_NEON) &amp;&amp; \
<span class="lineNum">    1284 </span>            :     (defined(__ARM_NEON__) || defined(__aarch64__) || defined(LIBYUV_NEON))
<span class="lineNum">    1285 </span>            : // C mimic assembly.
<span class="lineNum">    1286 </span>            : // TODO(fbarchard): Remove subsampling from Neon.
<span class="lineNum">    1287 </span>            : void I444ToARGBRow_C(const uint8* src_y,
<span class="lineNum">    1288 </span>            :                      const uint8* src_u,
<span class="lineNum">    1289 </span>            :                      const uint8* src_v,
<span class="lineNum">    1290 </span>            :                      uint8* rgb_buf,
<span class="lineNum">    1291 </span>            :                      const struct YuvConstants* yuvconstants,
<span class="lineNum">    1292 </span>            :                      int width) {
<span class="lineNum">    1293 </span>            :   int x;
<span class="lineNum">    1294 </span>            :   for (x = 0; x &lt; width - 1; x += 2) {
<span class="lineNum">    1295 </span>            :     uint8 u = (src_u[0] + src_u[1] + 1) &gt;&gt; 1;
<span class="lineNum">    1296 </span>            :     uint8 v = (src_v[0] + src_v[1] + 1) &gt;&gt; 1;
<span class="lineNum">    1297 </span>            :     YuvPixel(src_y[0], u, v, rgb_buf + 0, rgb_buf + 1, rgb_buf + 2,
<span class="lineNum">    1298 </span>            :              yuvconstants);
<span class="lineNum">    1299 </span>            :     rgb_buf[3] = 255;
<span class="lineNum">    1300 </span>            :     YuvPixel(src_y[1], u, v, rgb_buf + 4, rgb_buf + 5, rgb_buf + 6,
<span class="lineNum">    1301 </span>            :              yuvconstants);
<span class="lineNum">    1302 </span>            :     rgb_buf[7] = 255;
<span class="lineNum">    1303 </span>            :     src_y += 2;
<span class="lineNum">    1304 </span>            :     src_u += 2;
<span class="lineNum">    1305 </span>            :     src_v += 2;
<span class="lineNum">    1306 </span>            :     rgb_buf += 8;  // Advance 2 pixels.
<span class="lineNum">    1307 </span>            :   }
<span class="lineNum">    1308 </span>            :   if (width &amp; 1) {
<span class="lineNum">    1309 </span>            :     YuvPixel(src_y[0], src_u[0], src_v[0], rgb_buf + 0, rgb_buf + 1,
<span class="lineNum">    1310 </span>            :              rgb_buf + 2, yuvconstants);
<span class="lineNum">    1311 </span>            :     rgb_buf[3] = 255;
<span class="lineNum">    1312 </span>            :   }
<a name="1313"><span class="lineNum">    1313 </span>            : }</a>
<span class="lineNum">    1314 </span>            : #else
<span class="lineNum">    1315 </span><span class="lineNoCov">          0 : void I444ToARGBRow_C(const uint8* src_y,</span>
<span class="lineNum">    1316 </span>            :                      const uint8* src_u,
<span class="lineNum">    1317 </span>            :                      const uint8* src_v,
<span class="lineNum">    1318 </span>            :                      uint8* rgb_buf,
<span class="lineNum">    1319 </span>            :                      const struct YuvConstants* yuvconstants,
<span class="lineNum">    1320 </span>            :                      int width) {
<span class="lineNum">    1321 </span>            :   int x;
<span class="lineNum">    1322 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width; ++x) {</span>
<span class="lineNum">    1323 </span><span class="lineNoCov">          0 :     YuvPixel(src_y[0], src_u[0], src_v[0], rgb_buf + 0, rgb_buf + 1,</span>
<span class="lineNum">    1324 </span><span class="lineNoCov">          0 :              rgb_buf + 2, yuvconstants);</span>
<span class="lineNum">    1325 </span><span class="lineNoCov">          0 :     rgb_buf[3] = 255;</span>
<span class="lineNum">    1326 </span><span class="lineNoCov">          0 :     src_y += 1;</span>
<span class="lineNum">    1327 </span><span class="lineNoCov">          0 :     src_u += 1;</span>
<span class="lineNum">    1328 </span><span class="lineNoCov">          0 :     src_v += 1;</span>
<span class="lineNum">    1329 </span><span class="lineNoCov">          0 :     rgb_buf += 4;  // Advance 1 pixel.</span>
<span class="lineNum">    1330 </span>            :   }
<span class="lineNum">    1331 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">    1332 </span>            : #endif
<a name="1333"><span class="lineNum">    1333 </span>            : </a>
<span class="lineNum">    1334 </span>            : // Also used for 420
<span class="lineNum">    1335 </span><span class="lineNoCov">          0 : void I422ToARGBRow_C(const uint8* src_y,</span>
<span class="lineNum">    1336 </span>            :                      const uint8* src_u,
<span class="lineNum">    1337 </span>            :                      const uint8* src_v,
<span class="lineNum">    1338 </span>            :                      uint8* rgb_buf,
<span class="lineNum">    1339 </span>            :                      const struct YuvConstants* yuvconstants,
<span class="lineNum">    1340 </span>            :                      int width) {
<span class="lineNum">    1341 </span>            :   int x;
<span class="lineNum">    1342 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width - 1; x += 2) {</span>
<span class="lineNum">    1343 </span><span class="lineNoCov">          0 :     YuvPixel(src_y[0], src_u[0], src_v[0], rgb_buf + 0, rgb_buf + 1,</span>
<span class="lineNum">    1344 </span><span class="lineNoCov">          0 :              rgb_buf + 2, yuvconstants);</span>
<span class="lineNum">    1345 </span><span class="lineNoCov">          0 :     rgb_buf[3] = 255;</span>
<span class="lineNum">    1346 </span><span class="lineNoCov">          0 :     YuvPixel(src_y[1], src_u[0], src_v[0], rgb_buf + 4, rgb_buf + 5,</span>
<span class="lineNum">    1347 </span><span class="lineNoCov">          0 :              rgb_buf + 6, yuvconstants);</span>
<span class="lineNum">    1348 </span><span class="lineNoCov">          0 :     rgb_buf[7] = 255;</span>
<span class="lineNum">    1349 </span><span class="lineNoCov">          0 :     src_y += 2;</span>
<span class="lineNum">    1350 </span><span class="lineNoCov">          0 :     src_u += 1;</span>
<span class="lineNum">    1351 </span><span class="lineNoCov">          0 :     src_v += 1;</span>
<span class="lineNum">    1352 </span><span class="lineNoCov">          0 :     rgb_buf += 8;  // Advance 2 pixels.</span>
<span class="lineNum">    1353 </span>            :   }
<span class="lineNum">    1354 </span><span class="lineNoCov">          0 :   if (width &amp; 1) {</span>
<span class="lineNum">    1355 </span><span class="lineNoCov">          0 :     YuvPixel(src_y[0], src_u[0], src_v[0], rgb_buf + 0, rgb_buf + 1,</span>
<span class="lineNum">    1356 </span><span class="lineNoCov">          0 :              rgb_buf + 2, yuvconstants);</span>
<span class="lineNum">    1357 </span><span class="lineNoCov">          0 :     rgb_buf[3] = 255;</span>
<span class="lineNum">    1358 </span>            :   }
<a name="1359"><span class="lineNum">    1359 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1360 </span>            : 
<span class="lineNum">    1361 </span><span class="lineNoCov">          0 : void I422AlphaToARGBRow_C(const uint8* src_y,</span>
<span class="lineNum">    1362 </span>            :                           const uint8* src_u,
<span class="lineNum">    1363 </span>            :                           const uint8* src_v,
<span class="lineNum">    1364 </span>            :                           const uint8* src_a,
<span class="lineNum">    1365 </span>            :                           uint8* rgb_buf,
<span class="lineNum">    1366 </span>            :                           const struct YuvConstants* yuvconstants,
<span class="lineNum">    1367 </span>            :                           int width) {
<span class="lineNum">    1368 </span>            :   int x;
<span class="lineNum">    1369 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width - 1; x += 2) {</span>
<span class="lineNum">    1370 </span><span class="lineNoCov">          0 :     YuvPixel(src_y[0], src_u[0], src_v[0], rgb_buf + 0, rgb_buf + 1,</span>
<span class="lineNum">    1371 </span><span class="lineNoCov">          0 :              rgb_buf + 2, yuvconstants);</span>
<span class="lineNum">    1372 </span><span class="lineNoCov">          0 :     rgb_buf[3] = src_a[0];</span>
<span class="lineNum">    1373 </span><span class="lineNoCov">          0 :     YuvPixel(src_y[1], src_u[0], src_v[0], rgb_buf + 4, rgb_buf + 5,</span>
<span class="lineNum">    1374 </span><span class="lineNoCov">          0 :              rgb_buf + 6, yuvconstants);</span>
<span class="lineNum">    1375 </span><span class="lineNoCov">          0 :     rgb_buf[7] = src_a[1];</span>
<span class="lineNum">    1376 </span><span class="lineNoCov">          0 :     src_y += 2;</span>
<span class="lineNum">    1377 </span><span class="lineNoCov">          0 :     src_u += 1;</span>
<span class="lineNum">    1378 </span><span class="lineNoCov">          0 :     src_v += 1;</span>
<span class="lineNum">    1379 </span><span class="lineNoCov">          0 :     src_a += 2;</span>
<span class="lineNum">    1380 </span><span class="lineNoCov">          0 :     rgb_buf += 8;  // Advance 2 pixels.</span>
<span class="lineNum">    1381 </span>            :   }
<span class="lineNum">    1382 </span><span class="lineNoCov">          0 :   if (width &amp; 1) {</span>
<span class="lineNum">    1383 </span><span class="lineNoCov">          0 :     YuvPixel(src_y[0], src_u[0], src_v[0], rgb_buf + 0, rgb_buf + 1,</span>
<span class="lineNum">    1384 </span><span class="lineNoCov">          0 :              rgb_buf + 2, yuvconstants);</span>
<span class="lineNum">    1385 </span><span class="lineNoCov">          0 :     rgb_buf[3] = src_a[0];</span>
<span class="lineNum">    1386 </span>            :   }
<a name="1387"><span class="lineNum">    1387 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1388 </span>            : 
<span class="lineNum">    1389 </span><span class="lineNoCov">          0 : void I422ToRGB24Row_C(const uint8* src_y,</span>
<span class="lineNum">    1390 </span>            :                       const uint8* src_u,
<span class="lineNum">    1391 </span>            :                       const uint8* src_v,
<span class="lineNum">    1392 </span>            :                       uint8* rgb_buf,
<span class="lineNum">    1393 </span>            :                       const struct YuvConstants* yuvconstants,
<span class="lineNum">    1394 </span>            :                       int width) {
<span class="lineNum">    1395 </span>            :   int x;
<span class="lineNum">    1396 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width - 1; x += 2) {</span>
<span class="lineNum">    1397 </span><span class="lineNoCov">          0 :     YuvPixel(src_y[0], src_u[0], src_v[0], rgb_buf + 0, rgb_buf + 1,</span>
<span class="lineNum">    1398 </span><span class="lineNoCov">          0 :              rgb_buf + 2, yuvconstants);</span>
<span class="lineNum">    1399 </span><span class="lineNoCov">          0 :     YuvPixel(src_y[1], src_u[0], src_v[0], rgb_buf + 3, rgb_buf + 4,</span>
<span class="lineNum">    1400 </span><span class="lineNoCov">          0 :              rgb_buf + 5, yuvconstants);</span>
<span class="lineNum">    1401 </span><span class="lineNoCov">          0 :     src_y += 2;</span>
<span class="lineNum">    1402 </span><span class="lineNoCov">          0 :     src_u += 1;</span>
<span class="lineNum">    1403 </span><span class="lineNoCov">          0 :     src_v += 1;</span>
<span class="lineNum">    1404 </span><span class="lineNoCov">          0 :     rgb_buf += 6;  // Advance 2 pixels.</span>
<span class="lineNum">    1405 </span>            :   }
<span class="lineNum">    1406 </span><span class="lineNoCov">          0 :   if (width &amp; 1) {</span>
<span class="lineNum">    1407 </span><span class="lineNoCov">          0 :     YuvPixel(src_y[0], src_u[0], src_v[0], rgb_buf + 0, rgb_buf + 1,</span>
<span class="lineNum">    1408 </span><span class="lineNoCov">          0 :              rgb_buf + 2, yuvconstants);</span>
<span class="lineNum">    1409 </span>            :   }
<a name="1410"><span class="lineNum">    1410 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1411 </span>            : 
<span class="lineNum">    1412 </span><span class="lineNoCov">          0 : void I422ToARGB4444Row_C(const uint8* src_y,</span>
<span class="lineNum">    1413 </span>            :                          const uint8* src_u,
<span class="lineNum">    1414 </span>            :                          const uint8* src_v,
<span class="lineNum">    1415 </span>            :                          uint8* dst_argb4444,
<span class="lineNum">    1416 </span>            :                          const struct YuvConstants* yuvconstants,
<span class="lineNum">    1417 </span>            :                          int width) {
<span class="lineNum">    1418 </span>            :   uint8 b0;
<span class="lineNum">    1419 </span>            :   uint8 g0;
<span class="lineNum">    1420 </span>            :   uint8 r0;
<span class="lineNum">    1421 </span>            :   uint8 b1;
<span class="lineNum">    1422 </span>            :   uint8 g1;
<span class="lineNum">    1423 </span>            :   uint8 r1;
<span class="lineNum">    1424 </span>            :   int x;
<span class="lineNum">    1425 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width - 1; x += 2) {</span>
<span class="lineNum">    1426 </span><span class="lineNoCov">          0 :     YuvPixel(src_y[0], src_u[0], src_v[0], &amp;b0, &amp;g0, &amp;r0, yuvconstants);</span>
<span class="lineNum">    1427 </span><span class="lineNoCov">          0 :     YuvPixel(src_y[1], src_u[0], src_v[0], &amp;b1, &amp;g1, &amp;r1, yuvconstants);</span>
<span class="lineNum">    1428 </span><span class="lineNoCov">          0 :     b0 = b0 &gt;&gt; 4;</span>
<span class="lineNum">    1429 </span><span class="lineNoCov">          0 :     g0 = g0 &gt;&gt; 4;</span>
<span class="lineNum">    1430 </span><span class="lineNoCov">          0 :     r0 = r0 &gt;&gt; 4;</span>
<span class="lineNum">    1431 </span><span class="lineNoCov">          0 :     b1 = b1 &gt;&gt; 4;</span>
<span class="lineNum">    1432 </span><span class="lineNoCov">          0 :     g1 = g1 &gt;&gt; 4;</span>
<span class="lineNum">    1433 </span><span class="lineNoCov">          0 :     r1 = r1 &gt;&gt; 4;</span>
<span class="lineNum">    1434 </span><span class="lineNoCov">          0 :     *(uint32*)(dst_argb4444) = b0 | (g0 &lt;&lt; 4) | (r0 &lt;&lt; 8) | (b1 &lt;&lt; 16) |</span>
<span class="lineNum">    1435 </span><span class="lineNoCov">          0 :                                (g1 &lt;&lt; 20) | (r1 &lt;&lt; 24) | 0xf000f000;</span>
<span class="lineNum">    1436 </span><span class="lineNoCov">          0 :     src_y += 2;</span>
<span class="lineNum">    1437 </span><span class="lineNoCov">          0 :     src_u += 1;</span>
<span class="lineNum">    1438 </span><span class="lineNoCov">          0 :     src_v += 1;</span>
<span class="lineNum">    1439 </span><span class="lineNoCov">          0 :     dst_argb4444 += 4;  // Advance 2 pixels.</span>
<span class="lineNum">    1440 </span>            :   }
<span class="lineNum">    1441 </span><span class="lineNoCov">          0 :   if (width &amp; 1) {</span>
<span class="lineNum">    1442 </span><span class="lineNoCov">          0 :     YuvPixel(src_y[0], src_u[0], src_v[0], &amp;b0, &amp;g0, &amp;r0, yuvconstants);</span>
<span class="lineNum">    1443 </span><span class="lineNoCov">          0 :     b0 = b0 &gt;&gt; 4;</span>
<span class="lineNum">    1444 </span><span class="lineNoCov">          0 :     g0 = g0 &gt;&gt; 4;</span>
<span class="lineNum">    1445 </span><span class="lineNoCov">          0 :     r0 = r0 &gt;&gt; 4;</span>
<span class="lineNum">    1446 </span><span class="lineNoCov">          0 :     *(uint16*)(dst_argb4444) = b0 | (g0 &lt;&lt; 4) | (r0 &lt;&lt; 8) | 0xf000;</span>
<span class="lineNum">    1447 </span>            :   }
<a name="1448"><span class="lineNum">    1448 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1449 </span>            : 
<span class="lineNum">    1450 </span><span class="lineNoCov">          0 : void I422ToARGB1555Row_C(const uint8* src_y,</span>
<span class="lineNum">    1451 </span>            :                          const uint8* src_u,
<span class="lineNum">    1452 </span>            :                          const uint8* src_v,
<span class="lineNum">    1453 </span>            :                          uint8* dst_argb1555,
<span class="lineNum">    1454 </span>            :                          const struct YuvConstants* yuvconstants,
<span class="lineNum">    1455 </span>            :                          int width) {
<span class="lineNum">    1456 </span>            :   uint8 b0;
<span class="lineNum">    1457 </span>            :   uint8 g0;
<span class="lineNum">    1458 </span>            :   uint8 r0;
<span class="lineNum">    1459 </span>            :   uint8 b1;
<span class="lineNum">    1460 </span>            :   uint8 g1;
<span class="lineNum">    1461 </span>            :   uint8 r1;
<span class="lineNum">    1462 </span>            :   int x;
<span class="lineNum">    1463 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width - 1; x += 2) {</span>
<span class="lineNum">    1464 </span><span class="lineNoCov">          0 :     YuvPixel(src_y[0], src_u[0], src_v[0], &amp;b0, &amp;g0, &amp;r0, yuvconstants);</span>
<span class="lineNum">    1465 </span><span class="lineNoCov">          0 :     YuvPixel(src_y[1], src_u[0], src_v[0], &amp;b1, &amp;g1, &amp;r1, yuvconstants);</span>
<span class="lineNum">    1466 </span><span class="lineNoCov">          0 :     b0 = b0 &gt;&gt; 3;</span>
<span class="lineNum">    1467 </span><span class="lineNoCov">          0 :     g0 = g0 &gt;&gt; 3;</span>
<span class="lineNum">    1468 </span><span class="lineNoCov">          0 :     r0 = r0 &gt;&gt; 3;</span>
<span class="lineNum">    1469 </span><span class="lineNoCov">          0 :     b1 = b1 &gt;&gt; 3;</span>
<span class="lineNum">    1470 </span><span class="lineNoCov">          0 :     g1 = g1 &gt;&gt; 3;</span>
<span class="lineNum">    1471 </span><span class="lineNoCov">          0 :     r1 = r1 &gt;&gt; 3;</span>
<span class="lineNum">    1472 </span><span class="lineNoCov">          0 :     *(uint32*)(dst_argb1555) = b0 | (g0 &lt;&lt; 5) | (r0 &lt;&lt; 10) | (b1 &lt;&lt; 16) |</span>
<span class="lineNum">    1473 </span><span class="lineNoCov">          0 :                                (g1 &lt;&lt; 21) | (r1 &lt;&lt; 26) | 0x80008000;</span>
<span class="lineNum">    1474 </span><span class="lineNoCov">          0 :     src_y += 2;</span>
<span class="lineNum">    1475 </span><span class="lineNoCov">          0 :     src_u += 1;</span>
<span class="lineNum">    1476 </span><span class="lineNoCov">          0 :     src_v += 1;</span>
<span class="lineNum">    1477 </span><span class="lineNoCov">          0 :     dst_argb1555 += 4;  // Advance 2 pixels.</span>
<span class="lineNum">    1478 </span>            :   }
<span class="lineNum">    1479 </span><span class="lineNoCov">          0 :   if (width &amp; 1) {</span>
<span class="lineNum">    1480 </span><span class="lineNoCov">          0 :     YuvPixel(src_y[0], src_u[0], src_v[0], &amp;b0, &amp;g0, &amp;r0, yuvconstants);</span>
<span class="lineNum">    1481 </span><span class="lineNoCov">          0 :     b0 = b0 &gt;&gt; 3;</span>
<span class="lineNum">    1482 </span><span class="lineNoCov">          0 :     g0 = g0 &gt;&gt; 3;</span>
<span class="lineNum">    1483 </span><span class="lineNoCov">          0 :     r0 = r0 &gt;&gt; 3;</span>
<span class="lineNum">    1484 </span><span class="lineNoCov">          0 :     *(uint16*)(dst_argb1555) = b0 | (g0 &lt;&lt; 5) | (r0 &lt;&lt; 10) | 0x8000;</span>
<span class="lineNum">    1485 </span>            :   }
<a name="1486"><span class="lineNum">    1486 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1487 </span>            : 
<span class="lineNum">    1488 </span><span class="lineNoCov">          0 : void I422ToRGB565Row_C(const uint8* src_y,</span>
<span class="lineNum">    1489 </span>            :                        const uint8* src_u,
<span class="lineNum">    1490 </span>            :                        const uint8* src_v,
<span class="lineNum">    1491 </span>            :                        uint8* dst_rgb565,
<span class="lineNum">    1492 </span>            :                        const struct YuvConstants* yuvconstants,
<span class="lineNum">    1493 </span>            :                        int width) {
<span class="lineNum">    1494 </span>            :   uint8 b0;
<span class="lineNum">    1495 </span>            :   uint8 g0;
<span class="lineNum">    1496 </span>            :   uint8 r0;
<span class="lineNum">    1497 </span>            :   uint8 b1;
<span class="lineNum">    1498 </span>            :   uint8 g1;
<span class="lineNum">    1499 </span>            :   uint8 r1;
<span class="lineNum">    1500 </span>            :   int x;
<span class="lineNum">    1501 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width - 1; x += 2) {</span>
<span class="lineNum">    1502 </span><span class="lineNoCov">          0 :     YuvPixel(src_y[0], src_u[0], src_v[0], &amp;b0, &amp;g0, &amp;r0, yuvconstants);</span>
<span class="lineNum">    1503 </span><span class="lineNoCov">          0 :     YuvPixel(src_y[1], src_u[0], src_v[0], &amp;b1, &amp;g1, &amp;r1, yuvconstants);</span>
<span class="lineNum">    1504 </span><span class="lineNoCov">          0 :     b0 = b0 &gt;&gt; 3;</span>
<span class="lineNum">    1505 </span><span class="lineNoCov">          0 :     g0 = g0 &gt;&gt; 2;</span>
<span class="lineNum">    1506 </span><span class="lineNoCov">          0 :     r0 = r0 &gt;&gt; 3;</span>
<span class="lineNum">    1507 </span><span class="lineNoCov">          0 :     b1 = b1 &gt;&gt; 3;</span>
<span class="lineNum">    1508 </span><span class="lineNoCov">          0 :     g1 = g1 &gt;&gt; 2;</span>
<span class="lineNum">    1509 </span><span class="lineNoCov">          0 :     r1 = r1 &gt;&gt; 3;</span>
<span class="lineNum">    1510 </span><span class="lineNoCov">          0 :     *(uint32*)(dst_rgb565) =</span>
<span class="lineNum">    1511 </span><span class="lineNoCov">          0 :         b0 | (g0 &lt;&lt; 5) | (r0 &lt;&lt; 11) | (b1 &lt;&lt; 16) | (g1 &lt;&lt; 21) | (r1 &lt;&lt; 27);</span>
<span class="lineNum">    1512 </span><span class="lineNoCov">          0 :     src_y += 2;</span>
<span class="lineNum">    1513 </span><span class="lineNoCov">          0 :     src_u += 1;</span>
<span class="lineNum">    1514 </span><span class="lineNoCov">          0 :     src_v += 1;</span>
<span class="lineNum">    1515 </span><span class="lineNoCov">          0 :     dst_rgb565 += 4;  // Advance 2 pixels.</span>
<span class="lineNum">    1516 </span>            :   }
<span class="lineNum">    1517 </span><span class="lineNoCov">          0 :   if (width &amp; 1) {</span>
<span class="lineNum">    1518 </span><span class="lineNoCov">          0 :     YuvPixel(src_y[0], src_u[0], src_v[0], &amp;b0, &amp;g0, &amp;r0, yuvconstants);</span>
<span class="lineNum">    1519 </span><span class="lineNoCov">          0 :     b0 = b0 &gt;&gt; 3;</span>
<span class="lineNum">    1520 </span><span class="lineNoCov">          0 :     g0 = g0 &gt;&gt; 2;</span>
<span class="lineNum">    1521 </span><span class="lineNoCov">          0 :     r0 = r0 &gt;&gt; 3;</span>
<span class="lineNum">    1522 </span><span class="lineNoCov">          0 :     *(uint16*)(dst_rgb565) = b0 | (g0 &lt;&lt; 5) | (r0 &lt;&lt; 11);</span>
<span class="lineNum">    1523 </span>            :   }
<a name="1524"><span class="lineNum">    1524 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1525 </span>            : 
<span class="lineNum">    1526 </span><span class="lineNoCov">          0 : void NV12ToARGBRow_C(const uint8* src_y,</span>
<span class="lineNum">    1527 </span>            :                      const uint8* src_uv,
<span class="lineNum">    1528 </span>            :                      uint8* rgb_buf,
<span class="lineNum">    1529 </span>            :                      const struct YuvConstants* yuvconstants,
<span class="lineNum">    1530 </span>            :                      int width) {
<span class="lineNum">    1531 </span>            :   int x;
<span class="lineNum">    1532 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width - 1; x += 2) {</span>
<span class="lineNum">    1533 </span><span class="lineNoCov">          0 :     YuvPixel(src_y[0], src_uv[0], src_uv[1], rgb_buf + 0, rgb_buf + 1,</span>
<span class="lineNum">    1534 </span><span class="lineNoCov">          0 :              rgb_buf + 2, yuvconstants);</span>
<span class="lineNum">    1535 </span><span class="lineNoCov">          0 :     rgb_buf[3] = 255;</span>
<span class="lineNum">    1536 </span><span class="lineNoCov">          0 :     YuvPixel(src_y[1], src_uv[0], src_uv[1], rgb_buf + 4, rgb_buf + 5,</span>
<span class="lineNum">    1537 </span><span class="lineNoCov">          0 :              rgb_buf + 6, yuvconstants);</span>
<span class="lineNum">    1538 </span><span class="lineNoCov">          0 :     rgb_buf[7] = 255;</span>
<span class="lineNum">    1539 </span><span class="lineNoCov">          0 :     src_y += 2;</span>
<span class="lineNum">    1540 </span><span class="lineNoCov">          0 :     src_uv += 2;</span>
<span class="lineNum">    1541 </span><span class="lineNoCov">          0 :     rgb_buf += 8;  // Advance 2 pixels.</span>
<span class="lineNum">    1542 </span>            :   }
<span class="lineNum">    1543 </span><span class="lineNoCov">          0 :   if (width &amp; 1) {</span>
<span class="lineNum">    1544 </span><span class="lineNoCov">          0 :     YuvPixel(src_y[0], src_uv[0], src_uv[1], rgb_buf + 0, rgb_buf + 1,</span>
<span class="lineNum">    1545 </span><span class="lineNoCov">          0 :              rgb_buf + 2, yuvconstants);</span>
<span class="lineNum">    1546 </span><span class="lineNoCov">          0 :     rgb_buf[3] = 255;</span>
<span class="lineNum">    1547 </span>            :   }
<a name="1548"><span class="lineNum">    1548 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1549 </span>            : 
<span class="lineNum">    1550 </span><span class="lineNoCov">          0 : void NV21ToARGBRow_C(const uint8* src_y,</span>
<span class="lineNum">    1551 </span>            :                      const uint8* src_vu,
<span class="lineNum">    1552 </span>            :                      uint8* rgb_buf,
<span class="lineNum">    1553 </span>            :                      const struct YuvConstants* yuvconstants,
<span class="lineNum">    1554 </span>            :                      int width) {
<span class="lineNum">    1555 </span>            :   int x;
<span class="lineNum">    1556 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width - 1; x += 2) {</span>
<span class="lineNum">    1557 </span><span class="lineNoCov">          0 :     YuvPixel(src_y[0], src_vu[1], src_vu[0], rgb_buf + 0, rgb_buf + 1,</span>
<span class="lineNum">    1558 </span><span class="lineNoCov">          0 :              rgb_buf + 2, yuvconstants);</span>
<span class="lineNum">    1559 </span><span class="lineNoCov">          0 :     rgb_buf[3] = 255;</span>
<span class="lineNum">    1560 </span><span class="lineNoCov">          0 :     YuvPixel(src_y[1], src_vu[1], src_vu[0], rgb_buf + 4, rgb_buf + 5,</span>
<span class="lineNum">    1561 </span><span class="lineNoCov">          0 :              rgb_buf + 6, yuvconstants);</span>
<span class="lineNum">    1562 </span><span class="lineNoCov">          0 :     rgb_buf[7] = 255;</span>
<span class="lineNum">    1563 </span><span class="lineNoCov">          0 :     src_y += 2;</span>
<span class="lineNum">    1564 </span><span class="lineNoCov">          0 :     src_vu += 2;</span>
<span class="lineNum">    1565 </span><span class="lineNoCov">          0 :     rgb_buf += 8;  // Advance 2 pixels.</span>
<span class="lineNum">    1566 </span>            :   }
<span class="lineNum">    1567 </span><span class="lineNoCov">          0 :   if (width &amp; 1) {</span>
<span class="lineNum">    1568 </span><span class="lineNoCov">          0 :     YuvPixel(src_y[0], src_vu[1], src_vu[0], rgb_buf + 0, rgb_buf + 1,</span>
<span class="lineNum">    1569 </span><span class="lineNoCov">          0 :              rgb_buf + 2, yuvconstants);</span>
<span class="lineNum">    1570 </span><span class="lineNoCov">          0 :     rgb_buf[3] = 255;</span>
<span class="lineNum">    1571 </span>            :   }
<a name="1572"><span class="lineNum">    1572 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1573 </span>            : 
<span class="lineNum">    1574 </span><span class="lineNoCov">          0 : void NV12ToRGB565Row_C(const uint8* src_y,</span>
<span class="lineNum">    1575 </span>            :                        const uint8* src_uv,
<span class="lineNum">    1576 </span>            :                        uint8* dst_rgb565,
<span class="lineNum">    1577 </span>            :                        const struct YuvConstants* yuvconstants,
<span class="lineNum">    1578 </span>            :                        int width) {
<span class="lineNum">    1579 </span>            :   uint8 b0;
<span class="lineNum">    1580 </span>            :   uint8 g0;
<span class="lineNum">    1581 </span>            :   uint8 r0;
<span class="lineNum">    1582 </span>            :   uint8 b1;
<span class="lineNum">    1583 </span>            :   uint8 g1;
<span class="lineNum">    1584 </span>            :   uint8 r1;
<span class="lineNum">    1585 </span>            :   int x;
<span class="lineNum">    1586 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width - 1; x += 2) {</span>
<span class="lineNum">    1587 </span><span class="lineNoCov">          0 :     YuvPixel(src_y[0], src_uv[0], src_uv[1], &amp;b0, &amp;g0, &amp;r0, yuvconstants);</span>
<span class="lineNum">    1588 </span><span class="lineNoCov">          0 :     YuvPixel(src_y[1], src_uv[0], src_uv[1], &amp;b1, &amp;g1, &amp;r1, yuvconstants);</span>
<span class="lineNum">    1589 </span><span class="lineNoCov">          0 :     b0 = b0 &gt;&gt; 3;</span>
<span class="lineNum">    1590 </span><span class="lineNoCov">          0 :     g0 = g0 &gt;&gt; 2;</span>
<span class="lineNum">    1591 </span><span class="lineNoCov">          0 :     r0 = r0 &gt;&gt; 3;</span>
<span class="lineNum">    1592 </span><span class="lineNoCov">          0 :     b1 = b1 &gt;&gt; 3;</span>
<span class="lineNum">    1593 </span><span class="lineNoCov">          0 :     g1 = g1 &gt;&gt; 2;</span>
<span class="lineNum">    1594 </span><span class="lineNoCov">          0 :     r1 = r1 &gt;&gt; 3;</span>
<span class="lineNum">    1595 </span><span class="lineNoCov">          0 :     *(uint32*)(dst_rgb565) =</span>
<span class="lineNum">    1596 </span><span class="lineNoCov">          0 :         b0 | (g0 &lt;&lt; 5) | (r0 &lt;&lt; 11) | (b1 &lt;&lt; 16) | (g1 &lt;&lt; 21) | (r1 &lt;&lt; 27);</span>
<span class="lineNum">    1597 </span><span class="lineNoCov">          0 :     src_y += 2;</span>
<span class="lineNum">    1598 </span><span class="lineNoCov">          0 :     src_uv += 2;</span>
<span class="lineNum">    1599 </span><span class="lineNoCov">          0 :     dst_rgb565 += 4;  // Advance 2 pixels.</span>
<span class="lineNum">    1600 </span>            :   }
<span class="lineNum">    1601 </span><span class="lineNoCov">          0 :   if (width &amp; 1) {</span>
<span class="lineNum">    1602 </span><span class="lineNoCov">          0 :     YuvPixel(src_y[0], src_uv[0], src_uv[1], &amp;b0, &amp;g0, &amp;r0, yuvconstants);</span>
<span class="lineNum">    1603 </span><span class="lineNoCov">          0 :     b0 = b0 &gt;&gt; 3;</span>
<span class="lineNum">    1604 </span><span class="lineNoCov">          0 :     g0 = g0 &gt;&gt; 2;</span>
<span class="lineNum">    1605 </span><span class="lineNoCov">          0 :     r0 = r0 &gt;&gt; 3;</span>
<span class="lineNum">    1606 </span><span class="lineNoCov">          0 :     *(uint16*)(dst_rgb565) = b0 | (g0 &lt;&lt; 5) | (r0 &lt;&lt; 11);</span>
<span class="lineNum">    1607 </span>            :   }
<a name="1608"><span class="lineNum">    1608 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1609 </span>            : 
<span class="lineNum">    1610 </span><span class="lineNoCov">          0 : void YUY2ToARGBRow_C(const uint8* src_yuy2,</span>
<span class="lineNum">    1611 </span>            :                      uint8* rgb_buf,
<span class="lineNum">    1612 </span>            :                      const struct YuvConstants* yuvconstants,
<span class="lineNum">    1613 </span>            :                      int width) {
<span class="lineNum">    1614 </span>            :   int x;
<span class="lineNum">    1615 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width - 1; x += 2) {</span>
<span class="lineNum">    1616 </span><span class="lineNoCov">          0 :     YuvPixel(src_yuy2[0], src_yuy2[1], src_yuy2[3], rgb_buf + 0, rgb_buf + 1,</span>
<span class="lineNum">    1617 </span><span class="lineNoCov">          0 :              rgb_buf + 2, yuvconstants);</span>
<span class="lineNum">    1618 </span><span class="lineNoCov">          0 :     rgb_buf[3] = 255;</span>
<span class="lineNum">    1619 </span><span class="lineNoCov">          0 :     YuvPixel(src_yuy2[2], src_yuy2[1], src_yuy2[3], rgb_buf + 4, rgb_buf + 5,</span>
<span class="lineNum">    1620 </span><span class="lineNoCov">          0 :              rgb_buf + 6, yuvconstants);</span>
<span class="lineNum">    1621 </span><span class="lineNoCov">          0 :     rgb_buf[7] = 255;</span>
<span class="lineNum">    1622 </span><span class="lineNoCov">          0 :     src_yuy2 += 4;</span>
<span class="lineNum">    1623 </span><span class="lineNoCov">          0 :     rgb_buf += 8;  // Advance 2 pixels.</span>
<span class="lineNum">    1624 </span>            :   }
<span class="lineNum">    1625 </span><span class="lineNoCov">          0 :   if (width &amp; 1) {</span>
<span class="lineNum">    1626 </span><span class="lineNoCov">          0 :     YuvPixel(src_yuy2[0], src_yuy2[1], src_yuy2[3], rgb_buf + 0, rgb_buf + 1,</span>
<span class="lineNum">    1627 </span><span class="lineNoCov">          0 :              rgb_buf + 2, yuvconstants);</span>
<span class="lineNum">    1628 </span><span class="lineNoCov">          0 :     rgb_buf[3] = 255;</span>
<span class="lineNum">    1629 </span>            :   }
<a name="1630"><span class="lineNum">    1630 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1631 </span>            : 
<span class="lineNum">    1632 </span><span class="lineNoCov">          0 : void UYVYToARGBRow_C(const uint8* src_uyvy,</span>
<span class="lineNum">    1633 </span>            :                      uint8* rgb_buf,
<span class="lineNum">    1634 </span>            :                      const struct YuvConstants* yuvconstants,
<span class="lineNum">    1635 </span>            :                      int width) {
<span class="lineNum">    1636 </span>            :   int x;
<span class="lineNum">    1637 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width - 1; x += 2) {</span>
<span class="lineNum">    1638 </span><span class="lineNoCov">          0 :     YuvPixel(src_uyvy[1], src_uyvy[0], src_uyvy[2], rgb_buf + 0, rgb_buf + 1,</span>
<span class="lineNum">    1639 </span><span class="lineNoCov">          0 :              rgb_buf + 2, yuvconstants);</span>
<span class="lineNum">    1640 </span><span class="lineNoCov">          0 :     rgb_buf[3] = 255;</span>
<span class="lineNum">    1641 </span><span class="lineNoCov">          0 :     YuvPixel(src_uyvy[3], src_uyvy[0], src_uyvy[2], rgb_buf + 4, rgb_buf + 5,</span>
<span class="lineNum">    1642 </span><span class="lineNoCov">          0 :              rgb_buf + 6, yuvconstants);</span>
<span class="lineNum">    1643 </span><span class="lineNoCov">          0 :     rgb_buf[7] = 255;</span>
<span class="lineNum">    1644 </span><span class="lineNoCov">          0 :     src_uyvy += 4;</span>
<span class="lineNum">    1645 </span><span class="lineNoCov">          0 :     rgb_buf += 8;  // Advance 2 pixels.</span>
<span class="lineNum">    1646 </span>            :   }
<span class="lineNum">    1647 </span><span class="lineNoCov">          0 :   if (width &amp; 1) {</span>
<span class="lineNum">    1648 </span><span class="lineNoCov">          0 :     YuvPixel(src_uyvy[1], src_uyvy[0], src_uyvy[2], rgb_buf + 0, rgb_buf + 1,</span>
<span class="lineNum">    1649 </span><span class="lineNoCov">          0 :              rgb_buf + 2, yuvconstants);</span>
<span class="lineNum">    1650 </span><span class="lineNoCov">          0 :     rgb_buf[3] = 255;</span>
<span class="lineNum">    1651 </span>            :   }
<a name="1652"><span class="lineNum">    1652 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1653 </span>            : 
<span class="lineNum">    1654 </span><span class="lineNoCov">          0 : void I422ToRGBARow_C(const uint8* src_y,</span>
<span class="lineNum">    1655 </span>            :                      const uint8* src_u,
<span class="lineNum">    1656 </span>            :                      const uint8* src_v,
<span class="lineNum">    1657 </span>            :                      uint8* rgb_buf,
<span class="lineNum">    1658 </span>            :                      const struct YuvConstants* yuvconstants,
<span class="lineNum">    1659 </span>            :                      int width) {
<span class="lineNum">    1660 </span>            :   int x;
<span class="lineNum">    1661 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width - 1; x += 2) {</span>
<span class="lineNum">    1662 </span><span class="lineNoCov">          0 :     YuvPixel(src_y[0], src_u[0], src_v[0], rgb_buf + 1, rgb_buf + 2,</span>
<span class="lineNum">    1663 </span><span class="lineNoCov">          0 :              rgb_buf + 3, yuvconstants);</span>
<span class="lineNum">    1664 </span><span class="lineNoCov">          0 :     rgb_buf[0] = 255;</span>
<span class="lineNum">    1665 </span><span class="lineNoCov">          0 :     YuvPixel(src_y[1], src_u[0], src_v[0], rgb_buf + 5, rgb_buf + 6,</span>
<span class="lineNum">    1666 </span><span class="lineNoCov">          0 :              rgb_buf + 7, yuvconstants);</span>
<span class="lineNum">    1667 </span><span class="lineNoCov">          0 :     rgb_buf[4] = 255;</span>
<span class="lineNum">    1668 </span><span class="lineNoCov">          0 :     src_y += 2;</span>
<span class="lineNum">    1669 </span><span class="lineNoCov">          0 :     src_u += 1;</span>
<span class="lineNum">    1670 </span><span class="lineNoCov">          0 :     src_v += 1;</span>
<span class="lineNum">    1671 </span><span class="lineNoCov">          0 :     rgb_buf += 8;  // Advance 2 pixels.</span>
<span class="lineNum">    1672 </span>            :   }
<span class="lineNum">    1673 </span><span class="lineNoCov">          0 :   if (width &amp; 1) {</span>
<span class="lineNum">    1674 </span><span class="lineNoCov">          0 :     YuvPixel(src_y[0], src_u[0], src_v[0], rgb_buf + 1, rgb_buf + 2,</span>
<span class="lineNum">    1675 </span><span class="lineNoCov">          0 :              rgb_buf + 3, yuvconstants);</span>
<span class="lineNum">    1676 </span><span class="lineNoCov">          0 :     rgb_buf[0] = 255;</span>
<span class="lineNum">    1677 </span>            :   }
<a name="1678"><span class="lineNum">    1678 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1679 </span>            : 
<span class="lineNum">    1680 </span><span class="lineNoCov">          0 : void I400ToARGBRow_C(const uint8* src_y, uint8* rgb_buf, int width) {</span>
<span class="lineNum">    1681 </span>            :   int x;
<span class="lineNum">    1682 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width - 1; x += 2) {</span>
<span class="lineNum">    1683 </span><span class="lineNoCov">          0 :     YPixel(src_y[0], rgb_buf + 0, rgb_buf + 1, rgb_buf + 2);</span>
<span class="lineNum">    1684 </span><span class="lineNoCov">          0 :     rgb_buf[3] = 255;</span>
<span class="lineNum">    1685 </span><span class="lineNoCov">          0 :     YPixel(src_y[1], rgb_buf + 4, rgb_buf + 5, rgb_buf + 6);</span>
<span class="lineNum">    1686 </span><span class="lineNoCov">          0 :     rgb_buf[7] = 255;</span>
<span class="lineNum">    1687 </span><span class="lineNoCov">          0 :     src_y += 2;</span>
<span class="lineNum">    1688 </span><span class="lineNoCov">          0 :     rgb_buf += 8;  // Advance 2 pixels.</span>
<span class="lineNum">    1689 </span>            :   }
<span class="lineNum">    1690 </span><span class="lineNoCov">          0 :   if (width &amp; 1) {</span>
<span class="lineNum">    1691 </span><span class="lineNoCov">          0 :     YPixel(src_y[0], rgb_buf + 0, rgb_buf + 1, rgb_buf + 2);</span>
<span class="lineNum">    1692 </span><span class="lineNoCov">          0 :     rgb_buf[3] = 255;</span>
<span class="lineNum">    1693 </span>            :   }
<a name="1694"><span class="lineNum">    1694 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1695 </span>            : 
<span class="lineNum">    1696 </span><span class="lineNoCov">          0 : void MirrorRow_C(const uint8* src, uint8* dst, int width) {</span>
<span class="lineNum">    1697 </span>            :   int x;
<span class="lineNum">    1698 </span><span class="lineNoCov">          0 :   src += width - 1;</span>
<span class="lineNum">    1699 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width - 1; x += 2) {</span>
<span class="lineNum">    1700 </span><span class="lineNoCov">          0 :     dst[x] = src[0];</span>
<span class="lineNum">    1701 </span><span class="lineNoCov">          0 :     dst[x + 1] = src[-1];</span>
<span class="lineNum">    1702 </span><span class="lineNoCov">          0 :     src -= 2;</span>
<span class="lineNum">    1703 </span>            :   }
<span class="lineNum">    1704 </span><span class="lineNoCov">          0 :   if (width &amp; 1) {</span>
<span class="lineNum">    1705 </span><span class="lineNoCov">          0 :     dst[width - 1] = src[0];</span>
<span class="lineNum">    1706 </span>            :   }
<a name="1707"><span class="lineNum">    1707 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1708 </span>            : 
<span class="lineNum">    1709 </span><span class="lineNoCov">          0 : void MirrorUVRow_C(const uint8* src_uv, uint8* dst_u, uint8* dst_v, int width) {</span>
<span class="lineNum">    1710 </span>            :   int x;
<span class="lineNum">    1711 </span><span class="lineNoCov">          0 :   src_uv += (width - 1) &lt;&lt; 1;</span>
<span class="lineNum">    1712 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width - 1; x += 2) {</span>
<span class="lineNum">    1713 </span><span class="lineNoCov">          0 :     dst_u[x] = src_uv[0];</span>
<span class="lineNum">    1714 </span><span class="lineNoCov">          0 :     dst_u[x + 1] = src_uv[-2];</span>
<span class="lineNum">    1715 </span><span class="lineNoCov">          0 :     dst_v[x] = src_uv[1];</span>
<span class="lineNum">    1716 </span><span class="lineNoCov">          0 :     dst_v[x + 1] = src_uv[-2 + 1];</span>
<span class="lineNum">    1717 </span><span class="lineNoCov">          0 :     src_uv -= 4;</span>
<span class="lineNum">    1718 </span>            :   }
<span class="lineNum">    1719 </span><span class="lineNoCov">          0 :   if (width &amp; 1) {</span>
<span class="lineNum">    1720 </span><span class="lineNoCov">          0 :     dst_u[width - 1] = src_uv[0];</span>
<span class="lineNum">    1721 </span><span class="lineNoCov">          0 :     dst_v[width - 1] = src_uv[1];</span>
<span class="lineNum">    1722 </span>            :   }
<a name="1723"><span class="lineNum">    1723 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1724 </span>            : 
<span class="lineNum">    1725 </span><span class="lineNoCov">          0 : void ARGBMirrorRow_C(const uint8* src, uint8* dst, int width) {</span>
<span class="lineNum">    1726 </span>            :   int x;
<span class="lineNum">    1727 </span><span class="lineNoCov">          0 :   const uint32* src32 = (const uint32*)(src);</span>
<span class="lineNum">    1728 </span><span class="lineNoCov">          0 :   uint32* dst32 = (uint32*)(dst);</span>
<span class="lineNum">    1729 </span><span class="lineNoCov">          0 :   src32 += width - 1;</span>
<span class="lineNum">    1730 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width - 1; x += 2) {</span>
<span class="lineNum">    1731 </span><span class="lineNoCov">          0 :     dst32[x] = src32[0];</span>
<span class="lineNum">    1732 </span><span class="lineNoCov">          0 :     dst32[x + 1] = src32[-1];</span>
<span class="lineNum">    1733 </span><span class="lineNoCov">          0 :     src32 -= 2;</span>
<span class="lineNum">    1734 </span>            :   }
<span class="lineNum">    1735 </span><span class="lineNoCov">          0 :   if (width &amp; 1) {</span>
<span class="lineNum">    1736 </span><span class="lineNoCov">          0 :     dst32[width - 1] = src32[0];</span>
<span class="lineNum">    1737 </span>            :   }
<a name="1738"><span class="lineNum">    1738 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1739 </span>            : 
<span class="lineNum">    1740 </span><span class="lineNoCov">          0 : void SplitUVRow_C(const uint8* src_uv, uint8* dst_u, uint8* dst_v, int width) {</span>
<span class="lineNum">    1741 </span>            :   int x;
<span class="lineNum">    1742 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width - 1; x += 2) {</span>
<span class="lineNum">    1743 </span><span class="lineNoCov">          0 :     dst_u[x] = src_uv[0];</span>
<span class="lineNum">    1744 </span><span class="lineNoCov">          0 :     dst_u[x + 1] = src_uv[2];</span>
<span class="lineNum">    1745 </span><span class="lineNoCov">          0 :     dst_v[x] = src_uv[1];</span>
<span class="lineNum">    1746 </span><span class="lineNoCov">          0 :     dst_v[x + 1] = src_uv[3];</span>
<span class="lineNum">    1747 </span><span class="lineNoCov">          0 :     src_uv += 4;</span>
<span class="lineNum">    1748 </span>            :   }
<span class="lineNum">    1749 </span><span class="lineNoCov">          0 :   if (width &amp; 1) {</span>
<span class="lineNum">    1750 </span><span class="lineNoCov">          0 :     dst_u[width - 1] = src_uv[0];</span>
<span class="lineNum">    1751 </span><span class="lineNoCov">          0 :     dst_v[width - 1] = src_uv[1];</span>
<span class="lineNum">    1752 </span>            :   }
<a name="1753"><span class="lineNum">    1753 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1754 </span>            : 
<span class="lineNum">    1755 </span><span class="lineNoCov">          0 : void MergeUVRow_C(const uint8* src_u,</span>
<span class="lineNum">    1756 </span>            :                   const uint8* src_v,
<span class="lineNum">    1757 </span>            :                   uint8* dst_uv,
<span class="lineNum">    1758 </span>            :                   int width) {
<span class="lineNum">    1759 </span>            :   int x;
<span class="lineNum">    1760 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width - 1; x += 2) {</span>
<span class="lineNum">    1761 </span><span class="lineNoCov">          0 :     dst_uv[0] = src_u[x];</span>
<span class="lineNum">    1762 </span><span class="lineNoCov">          0 :     dst_uv[1] = src_v[x];</span>
<span class="lineNum">    1763 </span><span class="lineNoCov">          0 :     dst_uv[2] = src_u[x + 1];</span>
<span class="lineNum">    1764 </span><span class="lineNoCov">          0 :     dst_uv[3] = src_v[x + 1];</span>
<span class="lineNum">    1765 </span><span class="lineNoCov">          0 :     dst_uv += 4;</span>
<span class="lineNum">    1766 </span>            :   }
<span class="lineNum">    1767 </span><span class="lineNoCov">          0 :   if (width &amp; 1) {</span>
<span class="lineNum">    1768 </span><span class="lineNoCov">          0 :     dst_uv[0] = src_u[width - 1];</span>
<span class="lineNum">    1769 </span><span class="lineNoCov">          0 :     dst_uv[1] = src_v[width - 1];</span>
<span class="lineNum">    1770 </span>            :   }
<a name="1771"><span class="lineNum">    1771 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1772 </span>            : 
<span class="lineNum">    1773 </span><span class="lineNoCov">          0 : void CopyRow_C(const uint8* src, uint8* dst, int count) {</span>
<span class="lineNum">    1774 </span><span class="lineNoCov">          0 :   memcpy(dst, src, count);</span>
<a name="1775"><span class="lineNum">    1775 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1776 </span>            : 
<span class="lineNum">    1777 </span><span class="lineNoCov">          0 : void CopyRow_16_C(const uint16* src, uint16* dst, int count) {</span>
<span class="lineNum">    1778 </span><span class="lineNoCov">          0 :   memcpy(dst, src, count * 2);</span>
<a name="1779"><span class="lineNum">    1779 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1780 </span>            : 
<span class="lineNum">    1781 </span><span class="lineNoCov">          0 : void SetRow_C(uint8* dst, uint8 v8, int width) {</span>
<span class="lineNum">    1782 </span><span class="lineNoCov">          0 :   memset(dst, v8, width);</span>
<a name="1783"><span class="lineNum">    1783 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1784 </span>            : 
<span class="lineNum">    1785 </span><span class="lineNoCov">          0 : void ARGBSetRow_C(uint8* dst_argb, uint32 v32, int width) {</span>
<span class="lineNum">    1786 </span><span class="lineNoCov">          0 :   uint32* d = (uint32*)(dst_argb);</span>
<span class="lineNum">    1787 </span>            :   int x;
<span class="lineNum">    1788 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width; ++x) {</span>
<span class="lineNum">    1789 </span><span class="lineNoCov">          0 :     d[x] = v32;</span>
<span class="lineNum">    1790 </span>            :   }
<span class="lineNum">    1791 </span><span class="lineNoCov">          0 : }</span>
<a name="1792"><span class="lineNum">    1792 </span>            : </a>
<span class="lineNum">    1793 </span>            : // Filter 2 rows of YUY2 UV's (422) into U and V (420).
<span class="lineNum">    1794 </span><span class="lineNoCov">          0 : void YUY2ToUVRow_C(const uint8* src_yuy2,</span>
<span class="lineNum">    1795 </span>            :                    int src_stride_yuy2,
<span class="lineNum">    1796 </span>            :                    uint8* dst_u,
<span class="lineNum">    1797 </span>            :                    uint8* dst_v,
<span class="lineNum">    1798 </span>            :                    int width) {
<span class="lineNum">    1799 </span>            :   // Output a row of UV values, filtering 2 rows of YUY2.
<span class="lineNum">    1800 </span>            :   int x;
<span class="lineNum">    1801 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width; x += 2) {</span>
<span class="lineNum">    1802 </span><span class="lineNoCov">          0 :     dst_u[0] = (src_yuy2[1] + src_yuy2[src_stride_yuy2 + 1] + 1) &gt;&gt; 1;</span>
<span class="lineNum">    1803 </span><span class="lineNoCov">          0 :     dst_v[0] = (src_yuy2[3] + src_yuy2[src_stride_yuy2 + 3] + 1) &gt;&gt; 1;</span>
<span class="lineNum">    1804 </span><span class="lineNoCov">          0 :     src_yuy2 += 4;</span>
<span class="lineNum">    1805 </span><span class="lineNoCov">          0 :     dst_u += 1;</span>
<span class="lineNum">    1806 </span><span class="lineNoCov">          0 :     dst_v += 1;</span>
<span class="lineNum">    1807 </span>            :   }
<span class="lineNum">    1808 </span><span class="lineNoCov">          0 : }</span>
<a name="1809"><span class="lineNum">    1809 </span>            : </a>
<span class="lineNum">    1810 </span>            : // Copy row of YUY2 UV's (422) into U and V (422).
<span class="lineNum">    1811 </span><span class="lineNoCov">          0 : void YUY2ToUV422Row_C(const uint8* src_yuy2,</span>
<span class="lineNum">    1812 </span>            :                       uint8* dst_u,
<span class="lineNum">    1813 </span>            :                       uint8* dst_v,
<span class="lineNum">    1814 </span>            :                       int width) {
<span class="lineNum">    1815 </span>            :   // Output a row of UV values.
<span class="lineNum">    1816 </span>            :   int x;
<span class="lineNum">    1817 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width; x += 2) {</span>
<span class="lineNum">    1818 </span><span class="lineNoCov">          0 :     dst_u[0] = src_yuy2[1];</span>
<span class="lineNum">    1819 </span><span class="lineNoCov">          0 :     dst_v[0] = src_yuy2[3];</span>
<span class="lineNum">    1820 </span><span class="lineNoCov">          0 :     src_yuy2 += 4;</span>
<span class="lineNum">    1821 </span><span class="lineNoCov">          0 :     dst_u += 1;</span>
<span class="lineNum">    1822 </span><span class="lineNoCov">          0 :     dst_v += 1;</span>
<span class="lineNum">    1823 </span>            :   }
<span class="lineNum">    1824 </span><span class="lineNoCov">          0 : }</span>
<a name="1825"><span class="lineNum">    1825 </span>            : </a>
<span class="lineNum">    1826 </span>            : // Copy row of YUY2 Y's (422) into Y (420/422).
<span class="lineNum">    1827 </span><span class="lineNoCov">          0 : void YUY2ToYRow_C(const uint8* src_yuy2, uint8* dst_y, int width) {</span>
<span class="lineNum">    1828 </span>            :   // Output a row of Y values.
<span class="lineNum">    1829 </span>            :   int x;
<span class="lineNum">    1830 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width - 1; x += 2) {</span>
<span class="lineNum">    1831 </span><span class="lineNoCov">          0 :     dst_y[x] = src_yuy2[0];</span>
<span class="lineNum">    1832 </span><span class="lineNoCov">          0 :     dst_y[x + 1] = src_yuy2[2];</span>
<span class="lineNum">    1833 </span><span class="lineNoCov">          0 :     src_yuy2 += 4;</span>
<span class="lineNum">    1834 </span>            :   }
<span class="lineNum">    1835 </span><span class="lineNoCov">          0 :   if (width &amp; 1) {</span>
<span class="lineNum">    1836 </span><span class="lineNoCov">          0 :     dst_y[width - 1] = src_yuy2[0];</span>
<span class="lineNum">    1837 </span>            :   }
<span class="lineNum">    1838 </span><span class="lineNoCov">          0 : }</span>
<a name="1839"><span class="lineNum">    1839 </span>            : </a>
<span class="lineNum">    1840 </span>            : // Filter 2 rows of UYVY UV's (422) into U and V (420).
<span class="lineNum">    1841 </span><span class="lineNoCov">          0 : void UYVYToUVRow_C(const uint8* src_uyvy,</span>
<span class="lineNum">    1842 </span>            :                    int src_stride_uyvy,
<span class="lineNum">    1843 </span>            :                    uint8* dst_u,
<span class="lineNum">    1844 </span>            :                    uint8* dst_v,
<span class="lineNum">    1845 </span>            :                    int width) {
<span class="lineNum">    1846 </span>            :   // Output a row of UV values.
<span class="lineNum">    1847 </span>            :   int x;
<span class="lineNum">    1848 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width; x += 2) {</span>
<span class="lineNum">    1849 </span><span class="lineNoCov">          0 :     dst_u[0] = (src_uyvy[0] + src_uyvy[src_stride_uyvy + 0] + 1) &gt;&gt; 1;</span>
<span class="lineNum">    1850 </span><span class="lineNoCov">          0 :     dst_v[0] = (src_uyvy[2] + src_uyvy[src_stride_uyvy + 2] + 1) &gt;&gt; 1;</span>
<span class="lineNum">    1851 </span><span class="lineNoCov">          0 :     src_uyvy += 4;</span>
<span class="lineNum">    1852 </span><span class="lineNoCov">          0 :     dst_u += 1;</span>
<span class="lineNum">    1853 </span><span class="lineNoCov">          0 :     dst_v += 1;</span>
<span class="lineNum">    1854 </span>            :   }
<span class="lineNum">    1855 </span><span class="lineNoCov">          0 : }</span>
<a name="1856"><span class="lineNum">    1856 </span>            : </a>
<span class="lineNum">    1857 </span>            : // Copy row of UYVY UV's (422) into U and V (422).
<span class="lineNum">    1858 </span><span class="lineNoCov">          0 : void UYVYToUV422Row_C(const uint8* src_uyvy,</span>
<span class="lineNum">    1859 </span>            :                       uint8* dst_u,
<span class="lineNum">    1860 </span>            :                       uint8* dst_v,
<span class="lineNum">    1861 </span>            :                       int width) {
<span class="lineNum">    1862 </span>            :   // Output a row of UV values.
<span class="lineNum">    1863 </span>            :   int x;
<span class="lineNum">    1864 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width; x += 2) {</span>
<span class="lineNum">    1865 </span><span class="lineNoCov">          0 :     dst_u[0] = src_uyvy[0];</span>
<span class="lineNum">    1866 </span><span class="lineNoCov">          0 :     dst_v[0] = src_uyvy[2];</span>
<span class="lineNum">    1867 </span><span class="lineNoCov">          0 :     src_uyvy += 4;</span>
<span class="lineNum">    1868 </span><span class="lineNoCov">          0 :     dst_u += 1;</span>
<span class="lineNum">    1869 </span><span class="lineNoCov">          0 :     dst_v += 1;</span>
<span class="lineNum">    1870 </span>            :   }
<span class="lineNum">    1871 </span><span class="lineNoCov">          0 : }</span>
<a name="1872"><span class="lineNum">    1872 </span>            : </a>
<span class="lineNum">    1873 </span>            : // Copy row of UYVY Y's (422) into Y (420/422).
<span class="lineNum">    1874 </span><span class="lineNoCov">          0 : void UYVYToYRow_C(const uint8* src_uyvy, uint8* dst_y, int width) {</span>
<span class="lineNum">    1875 </span>            :   // Output a row of Y values.
<span class="lineNum">    1876 </span>            :   int x;
<span class="lineNum">    1877 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width - 1; x += 2) {</span>
<span class="lineNum">    1878 </span><span class="lineNoCov">          0 :     dst_y[x] = src_uyvy[1];</span>
<span class="lineNum">    1879 </span><span class="lineNoCov">          0 :     dst_y[x + 1] = src_uyvy[3];</span>
<span class="lineNum">    1880 </span><span class="lineNoCov">          0 :     src_uyvy += 4;</span>
<span class="lineNum">    1881 </span>            :   }
<span class="lineNum">    1882 </span><span class="lineNoCov">          0 :   if (width &amp; 1) {</span>
<span class="lineNum">    1883 </span><span class="lineNoCov">          0 :     dst_y[width - 1] = src_uyvy[1];</span>
<span class="lineNum">    1884 </span>            :   }
<span class="lineNum">    1885 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">    1886 </span>            : 
<span class="lineNum">    1887 </span>            : #define BLEND(f, b, a) (((256 - a) * b) &gt;&gt; 8) + f
<span class="lineNum">    1888 </span>            : 
<span class="lineNum">    1889 </span>            : // Blend src_argb0 over src_argb1 and store to dst_argb.
<a name="1890"><span class="lineNum">    1890 </span>            : // dst_argb may be src_argb0 or src_argb1.</a>
<span class="lineNum">    1891 </span>            : // This code mimics the SSSE3 version for better testability.
<span class="lineNum">    1892 </span><span class="lineNoCov">          0 : void ARGBBlendRow_C(const uint8* src_argb0,</span>
<span class="lineNum">    1893 </span>            :                     const uint8* src_argb1,
<span class="lineNum">    1894 </span>            :                     uint8* dst_argb,
<span class="lineNum">    1895 </span>            :                     int width) {
<span class="lineNum">    1896 </span>            :   int x;
<span class="lineNum">    1897 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width - 1; x += 2) {</span>
<span class="lineNum">    1898 </span><span class="lineNoCov">          0 :     uint32 fb = src_argb0[0];</span>
<span class="lineNum">    1899 </span><span class="lineNoCov">          0 :     uint32 fg = src_argb0[1];</span>
<span class="lineNum">    1900 </span><span class="lineNoCov">          0 :     uint32 fr = src_argb0[2];</span>
<span class="lineNum">    1901 </span><span class="lineNoCov">          0 :     uint32 a = src_argb0[3];</span>
<span class="lineNum">    1902 </span><span class="lineNoCov">          0 :     uint32 bb = src_argb1[0];</span>
<span class="lineNum">    1903 </span><span class="lineNoCov">          0 :     uint32 bg = src_argb1[1];</span>
<span class="lineNum">    1904 </span><span class="lineNoCov">          0 :     uint32 br = src_argb1[2];</span>
<span class="lineNum">    1905 </span><span class="lineNoCov">          0 :     dst_argb[0] = BLEND(fb, bb, a);</span>
<span class="lineNum">    1906 </span><span class="lineNoCov">          0 :     dst_argb[1] = BLEND(fg, bg, a);</span>
<span class="lineNum">    1907 </span><span class="lineNoCov">          0 :     dst_argb[2] = BLEND(fr, br, a);</span>
<span class="lineNum">    1908 </span><span class="lineNoCov">          0 :     dst_argb[3] = 255u;</span>
<span class="lineNum">    1909 </span>            : 
<span class="lineNum">    1910 </span><span class="lineNoCov">          0 :     fb = src_argb0[4 + 0];</span>
<span class="lineNum">    1911 </span><span class="lineNoCov">          0 :     fg = src_argb0[4 + 1];</span>
<span class="lineNum">    1912 </span><span class="lineNoCov">          0 :     fr = src_argb0[4 + 2];</span>
<span class="lineNum">    1913 </span><span class="lineNoCov">          0 :     a = src_argb0[4 + 3];</span>
<span class="lineNum">    1914 </span><span class="lineNoCov">          0 :     bb = src_argb1[4 + 0];</span>
<span class="lineNum">    1915 </span><span class="lineNoCov">          0 :     bg = src_argb1[4 + 1];</span>
<span class="lineNum">    1916 </span><span class="lineNoCov">          0 :     br = src_argb1[4 + 2];</span>
<span class="lineNum">    1917 </span><span class="lineNoCov">          0 :     dst_argb[4 + 0] = BLEND(fb, bb, a);</span>
<span class="lineNum">    1918 </span><span class="lineNoCov">          0 :     dst_argb[4 + 1] = BLEND(fg, bg, a);</span>
<span class="lineNum">    1919 </span><span class="lineNoCov">          0 :     dst_argb[4 + 2] = BLEND(fr, br, a);</span>
<span class="lineNum">    1920 </span><span class="lineNoCov">          0 :     dst_argb[4 + 3] = 255u;</span>
<span class="lineNum">    1921 </span><span class="lineNoCov">          0 :     src_argb0 += 8;</span>
<span class="lineNum">    1922 </span><span class="lineNoCov">          0 :     src_argb1 += 8;</span>
<span class="lineNum">    1923 </span><span class="lineNoCov">          0 :     dst_argb += 8;</span>
<span class="lineNum">    1924 </span>            :   }
<span class="lineNum">    1925 </span>            : 
<span class="lineNum">    1926 </span><span class="lineNoCov">          0 :   if (width &amp; 1) {</span>
<span class="lineNum">    1927 </span><span class="lineNoCov">          0 :     uint32 fb = src_argb0[0];</span>
<span class="lineNum">    1928 </span><span class="lineNoCov">          0 :     uint32 fg = src_argb0[1];</span>
<span class="lineNum">    1929 </span><span class="lineNoCov">          0 :     uint32 fr = src_argb0[2];</span>
<span class="lineNum">    1930 </span><span class="lineNoCov">          0 :     uint32 a = src_argb0[3];</span>
<span class="lineNum">    1931 </span><span class="lineNoCov">          0 :     uint32 bb = src_argb1[0];</span>
<span class="lineNum">    1932 </span><span class="lineNoCov">          0 :     uint32 bg = src_argb1[1];</span>
<span class="lineNum">    1933 </span><span class="lineNoCov">          0 :     uint32 br = src_argb1[2];</span>
<span class="lineNum">    1934 </span><span class="lineNoCov">          0 :     dst_argb[0] = BLEND(fb, bb, a);</span>
<span class="lineNum">    1935 </span><span class="lineNoCov">          0 :     dst_argb[1] = BLEND(fg, bg, a);</span>
<span class="lineNum">    1936 </span><span class="lineNoCov">          0 :     dst_argb[2] = BLEND(fr, br, a);</span>
<span class="lineNum">    1937 </span><span class="lineNoCov">          0 :     dst_argb[3] = 255u;</span>
<span class="lineNum">    1938 </span>            :   }
<span class="lineNum">    1939 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">    1940 </span>            : #undef BLEND
<a name="1941"><span class="lineNum">    1941 </span>            : </a>
<span class="lineNum">    1942 </span>            : #define UBLEND(f, b, a) (((a)*f) + ((255 - a) * b) + 255) &gt;&gt; 8
<span class="lineNum">    1943 </span><span class="lineNoCov">          0 : void BlendPlaneRow_C(const uint8* src0,</span>
<span class="lineNum">    1944 </span>            :                      const uint8* src1,
<span class="lineNum">    1945 </span>            :                      const uint8* alpha,
<span class="lineNum">    1946 </span>            :                      uint8* dst,
<span class="lineNum">    1947 </span>            :                      int width) {
<span class="lineNum">    1948 </span>            :   int x;
<span class="lineNum">    1949 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width - 1; x += 2) {</span>
<span class="lineNum">    1950 </span><span class="lineNoCov">          0 :     dst[0] = UBLEND(src0[0], src1[0], alpha[0]);</span>
<span class="lineNum">    1951 </span><span class="lineNoCov">          0 :     dst[1] = UBLEND(src0[1], src1[1], alpha[1]);</span>
<span class="lineNum">    1952 </span><span class="lineNoCov">          0 :     src0 += 2;</span>
<span class="lineNum">    1953 </span><span class="lineNoCov">          0 :     src1 += 2;</span>
<span class="lineNum">    1954 </span><span class="lineNoCov">          0 :     alpha += 2;</span>
<span class="lineNum">    1955 </span><span class="lineNoCov">          0 :     dst += 2;</span>
<span class="lineNum">    1956 </span>            :   }
<span class="lineNum">    1957 </span><span class="lineNoCov">          0 :   if (width &amp; 1) {</span>
<span class="lineNum">    1958 </span><span class="lineNoCov">          0 :     dst[0] = UBLEND(src0[0], src1[0], alpha[0]);</span>
<span class="lineNum">    1959 </span>            :   }
<span class="lineNum">    1960 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">    1961 </span>            : #undef UBLEND
<span class="lineNum">    1962 </span>            : 
<span class="lineNum">    1963 </span>            : #define ATTENUATE(f, a) (a | (a &lt;&lt; 8)) * (f | (f &lt;&lt; 8)) &gt;&gt; 24
<span class="lineNum">    1964 </span>            : 
<a name="1965"><span class="lineNum">    1965 </span>            : // Multiply source RGB by alpha and store to destination.</a>
<span class="lineNum">    1966 </span>            : // This code mimics the SSSE3 version for better testability.
<span class="lineNum">    1967 </span><span class="lineNoCov">          0 : void ARGBAttenuateRow_C(const uint8* src_argb, uint8* dst_argb, int width) {</span>
<span class="lineNum">    1968 </span>            :   int i;
<span class="lineNum">    1969 </span><span class="lineNoCov">          0 :   for (i = 0; i &lt; width - 1; i += 2) {</span>
<span class="lineNum">    1970 </span><span class="lineNoCov">          0 :     uint32 b = src_argb[0];</span>
<span class="lineNum">    1971 </span><span class="lineNoCov">          0 :     uint32 g = src_argb[1];</span>
<span class="lineNum">    1972 </span><span class="lineNoCov">          0 :     uint32 r = src_argb[2];</span>
<span class="lineNum">    1973 </span><span class="lineNoCov">          0 :     uint32 a = src_argb[3];</span>
<span class="lineNum">    1974 </span><span class="lineNoCov">          0 :     dst_argb[0] = ATTENUATE(b, a);</span>
<span class="lineNum">    1975 </span><span class="lineNoCov">          0 :     dst_argb[1] = ATTENUATE(g, a);</span>
<span class="lineNum">    1976 </span><span class="lineNoCov">          0 :     dst_argb[2] = ATTENUATE(r, a);</span>
<span class="lineNum">    1977 </span><span class="lineNoCov">          0 :     dst_argb[3] = a;</span>
<span class="lineNum">    1978 </span><span class="lineNoCov">          0 :     b = src_argb[4];</span>
<span class="lineNum">    1979 </span><span class="lineNoCov">          0 :     g = src_argb[5];</span>
<span class="lineNum">    1980 </span><span class="lineNoCov">          0 :     r = src_argb[6];</span>
<span class="lineNum">    1981 </span><span class="lineNoCov">          0 :     a = src_argb[7];</span>
<span class="lineNum">    1982 </span><span class="lineNoCov">          0 :     dst_argb[4] = ATTENUATE(b, a);</span>
<span class="lineNum">    1983 </span><span class="lineNoCov">          0 :     dst_argb[5] = ATTENUATE(g, a);</span>
<span class="lineNum">    1984 </span><span class="lineNoCov">          0 :     dst_argb[6] = ATTENUATE(r, a);</span>
<span class="lineNum">    1985 </span><span class="lineNoCov">          0 :     dst_argb[7] = a;</span>
<span class="lineNum">    1986 </span><span class="lineNoCov">          0 :     src_argb += 8;</span>
<span class="lineNum">    1987 </span><span class="lineNoCov">          0 :     dst_argb += 8;</span>
<span class="lineNum">    1988 </span>            :   }
<span class="lineNum">    1989 </span>            : 
<span class="lineNum">    1990 </span><span class="lineNoCov">          0 :   if (width &amp; 1) {</span>
<span class="lineNum">    1991 </span><span class="lineNoCov">          0 :     const uint32 b = src_argb[0];</span>
<span class="lineNum">    1992 </span><span class="lineNoCov">          0 :     const uint32 g = src_argb[1];</span>
<span class="lineNum">    1993 </span><span class="lineNoCov">          0 :     const uint32 r = src_argb[2];</span>
<span class="lineNum">    1994 </span><span class="lineNoCov">          0 :     const uint32 a = src_argb[3];</span>
<span class="lineNum">    1995 </span><span class="lineNoCov">          0 :     dst_argb[0] = ATTENUATE(b, a);</span>
<span class="lineNum">    1996 </span><span class="lineNoCov">          0 :     dst_argb[1] = ATTENUATE(g, a);</span>
<span class="lineNum">    1997 </span><span class="lineNoCov">          0 :     dst_argb[2] = ATTENUATE(r, a);</span>
<span class="lineNum">    1998 </span><span class="lineNoCov">          0 :     dst_argb[3] = a;</span>
<span class="lineNum">    1999 </span>            :   }
<span class="lineNum">    2000 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">    2001 </span>            : #undef ATTENUATE
<span class="lineNum">    2002 </span>            : 
<span class="lineNum">    2003 </span>            : // Divide source RGB by alpha and store to destination.
<span class="lineNum">    2004 </span>            : // b = (b * 255 + (a / 2)) / a;
<span class="lineNum">    2005 </span>            : // g = (g * 255 + (a / 2)) / a;
<span class="lineNum">    2006 </span>            : // r = (r * 255 + (a / 2)) / a;
<span class="lineNum">    2007 </span>            : // Reciprocal method is off by 1 on some values. ie 125
<span class="lineNum">    2008 </span>            : // 8.8 fixed point inverse table with 1.0 in upper short and 1 / a in lower.
<span class="lineNum">    2009 </span>            : #define T(a) 0x01000000 + (0x10000 / a)
<span class="lineNum">    2010 </span>            : const uint32 fixed_invtbl8[256] = {
<span class="lineNum">    2011 </span>            :     0x01000000, 0x0100ffff, T(0x02), T(0x03),   T(0x04), T(0x05), T(0x06),
<span class="lineNum">    2012 </span>            :     T(0x07),    T(0x08),    T(0x09), T(0x0a),   T(0x0b), T(0x0c), T(0x0d),
<span class="lineNum">    2013 </span>            :     T(0x0e),    T(0x0f),    T(0x10), T(0x11),   T(0x12), T(0x13), T(0x14),
<span class="lineNum">    2014 </span>            :     T(0x15),    T(0x16),    T(0x17), T(0x18),   T(0x19), T(0x1a), T(0x1b),
<span class="lineNum">    2015 </span>            :     T(0x1c),    T(0x1d),    T(0x1e), T(0x1f),   T(0x20), T(0x21), T(0x22),
<span class="lineNum">    2016 </span>            :     T(0x23),    T(0x24),    T(0x25), T(0x26),   T(0x27), T(0x28), T(0x29),
<span class="lineNum">    2017 </span>            :     T(0x2a),    T(0x2b),    T(0x2c), T(0x2d),   T(0x2e), T(0x2f), T(0x30),
<span class="lineNum">    2018 </span>            :     T(0x31),    T(0x32),    T(0x33), T(0x34),   T(0x35), T(0x36), T(0x37),
<span class="lineNum">    2019 </span>            :     T(0x38),    T(0x39),    T(0x3a), T(0x3b),   T(0x3c), T(0x3d), T(0x3e),
<span class="lineNum">    2020 </span>            :     T(0x3f),    T(0x40),    T(0x41), T(0x42),   T(0x43), T(0x44), T(0x45),
<span class="lineNum">    2021 </span>            :     T(0x46),    T(0x47),    T(0x48), T(0x49),   T(0x4a), T(0x4b), T(0x4c),
<span class="lineNum">    2022 </span>            :     T(0x4d),    T(0x4e),    T(0x4f), T(0x50),   T(0x51), T(0x52), T(0x53),
<span class="lineNum">    2023 </span>            :     T(0x54),    T(0x55),    T(0x56), T(0x57),   T(0x58), T(0x59), T(0x5a),
<span class="lineNum">    2024 </span>            :     T(0x5b),    T(0x5c),    T(0x5d), T(0x5e),   T(0x5f), T(0x60), T(0x61),
<span class="lineNum">    2025 </span>            :     T(0x62),    T(0x63),    T(0x64), T(0x65),   T(0x66), T(0x67), T(0x68),
<span class="lineNum">    2026 </span>            :     T(0x69),    T(0x6a),    T(0x6b), T(0x6c),   T(0x6d), T(0x6e), T(0x6f),
<span class="lineNum">    2027 </span>            :     T(0x70),    T(0x71),    T(0x72), T(0x73),   T(0x74), T(0x75), T(0x76),
<span class="lineNum">    2028 </span>            :     T(0x77),    T(0x78),    T(0x79), T(0x7a),   T(0x7b), T(0x7c), T(0x7d),
<span class="lineNum">    2029 </span>            :     T(0x7e),    T(0x7f),    T(0x80), T(0x81),   T(0x82), T(0x83), T(0x84),
<span class="lineNum">    2030 </span>            :     T(0x85),    T(0x86),    T(0x87), T(0x88),   T(0x89), T(0x8a), T(0x8b),
<span class="lineNum">    2031 </span>            :     T(0x8c),    T(0x8d),    T(0x8e), T(0x8f),   T(0x90), T(0x91), T(0x92),
<span class="lineNum">    2032 </span>            :     T(0x93),    T(0x94),    T(0x95), T(0x96),   T(0x97), T(0x98), T(0x99),
<span class="lineNum">    2033 </span>            :     T(0x9a),    T(0x9b),    T(0x9c), T(0x9d),   T(0x9e), T(0x9f), T(0xa0),
<span class="lineNum">    2034 </span>            :     T(0xa1),    T(0xa2),    T(0xa3), T(0xa4),   T(0xa5), T(0xa6), T(0xa7),
<span class="lineNum">    2035 </span>            :     T(0xa8),    T(0xa9),    T(0xaa), T(0xab),   T(0xac), T(0xad), T(0xae),
<span class="lineNum">    2036 </span>            :     T(0xaf),    T(0xb0),    T(0xb1), T(0xb2),   T(0xb3), T(0xb4), T(0xb5),
<span class="lineNum">    2037 </span>            :     T(0xb6),    T(0xb7),    T(0xb8), T(0xb9),   T(0xba), T(0xbb), T(0xbc),
<span class="lineNum">    2038 </span>            :     T(0xbd),    T(0xbe),    T(0xbf), T(0xc0),   T(0xc1), T(0xc2), T(0xc3),
<span class="lineNum">    2039 </span>            :     T(0xc4),    T(0xc5),    T(0xc6), T(0xc7),   T(0xc8), T(0xc9), T(0xca),
<span class="lineNum">    2040 </span>            :     T(0xcb),    T(0xcc),    T(0xcd), T(0xce),   T(0xcf), T(0xd0), T(0xd1),
<span class="lineNum">    2041 </span>            :     T(0xd2),    T(0xd3),    T(0xd4), T(0xd5),   T(0xd6), T(0xd7), T(0xd8),
<span class="lineNum">    2042 </span>            :     T(0xd9),    T(0xda),    T(0xdb), T(0xdc),   T(0xdd), T(0xde), T(0xdf),
<span class="lineNum">    2043 </span>            :     T(0xe0),    T(0xe1),    T(0xe2), T(0xe3),   T(0xe4), T(0xe5), T(0xe6),
<span class="lineNum">    2044 </span>            :     T(0xe7),    T(0xe8),    T(0xe9), T(0xea),   T(0xeb), T(0xec), T(0xed),
<span class="lineNum">    2045 </span>            :     T(0xee),    T(0xef),    T(0xf0), T(0xf1),   T(0xf2), T(0xf3), T(0xf4),
<span class="lineNum">    2046 </span>            :     T(0xf5),    T(0xf6),    T(0xf7), T(0xf8),   T(0xf9), T(0xfa), T(0xfb),
<span class="lineNum">    2047 </span>            :     T(0xfc),    T(0xfd),    T(0xfe), 0x01000100};
<a name="2048"><span class="lineNum">    2048 </span>            : #undef T</a>
<span class="lineNum">    2049 </span>            : 
<span class="lineNum">    2050 </span><span class="lineNoCov">          0 : void ARGBUnattenuateRow_C(const uint8* src_argb, uint8* dst_argb, int width) {</span>
<span class="lineNum">    2051 </span>            :   int i;
<span class="lineNum">    2052 </span><span class="lineNoCov">          0 :   for (i = 0; i &lt; width; ++i) {</span>
<span class="lineNum">    2053 </span><span class="lineNoCov">          0 :     uint32 b = src_argb[0];</span>
<span class="lineNum">    2054 </span><span class="lineNoCov">          0 :     uint32 g = src_argb[1];</span>
<span class="lineNum">    2055 </span><span class="lineNoCov">          0 :     uint32 r = src_argb[2];</span>
<span class="lineNum">    2056 </span><span class="lineNoCov">          0 :     const uint32 a = src_argb[3];</span>
<span class="lineNum">    2057 </span><span class="lineNoCov">          0 :     const uint32 ia = fixed_invtbl8[a] &amp; 0xffff;  // 8.8 fixed point</span>
<span class="lineNum">    2058 </span><span class="lineNoCov">          0 :     b = (b * ia) &gt;&gt; 8;</span>
<span class="lineNum">    2059 </span><span class="lineNoCov">          0 :     g = (g * ia) &gt;&gt; 8;</span>
<span class="lineNum">    2060 </span><span class="lineNoCov">          0 :     r = (r * ia) &gt;&gt; 8;</span>
<span class="lineNum">    2061 </span>            :     // Clamping should not be necessary but is free in assembly.
<span class="lineNum">    2062 </span><span class="lineNoCov">          0 :     dst_argb[0] = clamp255(b);</span>
<span class="lineNum">    2063 </span><span class="lineNoCov">          0 :     dst_argb[1] = clamp255(g);</span>
<span class="lineNum">    2064 </span><span class="lineNoCov">          0 :     dst_argb[2] = clamp255(r);</span>
<span class="lineNum">    2065 </span><span class="lineNoCov">          0 :     dst_argb[3] = a;</span>
<span class="lineNum">    2066 </span><span class="lineNoCov">          0 :     src_argb += 4;</span>
<span class="lineNum">    2067 </span><span class="lineNoCov">          0 :     dst_argb += 4;</span>
<span class="lineNum">    2068 </span>            :   }
<a name="2069"><span class="lineNum">    2069 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    2070 </span>            : 
<span class="lineNum">    2071 </span><span class="lineNoCov">          0 : void ComputeCumulativeSumRow_C(const uint8* row,</span>
<span class="lineNum">    2072 </span>            :                                int32* cumsum,
<span class="lineNum">    2073 </span>            :                                const int32* previous_cumsum,
<span class="lineNum">    2074 </span>            :                                int width) {
<span class="lineNum">    2075 </span><span class="lineNoCov">          0 :   int32 row_sum[4] = {0, 0, 0, 0};</span>
<span class="lineNum">    2076 </span>            :   int x;
<span class="lineNum">    2077 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width; ++x) {</span>
<span class="lineNum">    2078 </span><span class="lineNoCov">          0 :     row_sum[0] += row[x * 4 + 0];</span>
<span class="lineNum">    2079 </span><span class="lineNoCov">          0 :     row_sum[1] += row[x * 4 + 1];</span>
<span class="lineNum">    2080 </span><span class="lineNoCov">          0 :     row_sum[2] += row[x * 4 + 2];</span>
<span class="lineNum">    2081 </span><span class="lineNoCov">          0 :     row_sum[3] += row[x * 4 + 3];</span>
<span class="lineNum">    2082 </span><span class="lineNoCov">          0 :     cumsum[x * 4 + 0] = row_sum[0] + previous_cumsum[x * 4 + 0];</span>
<span class="lineNum">    2083 </span><span class="lineNoCov">          0 :     cumsum[x * 4 + 1] = row_sum[1] + previous_cumsum[x * 4 + 1];</span>
<span class="lineNum">    2084 </span><span class="lineNoCov">          0 :     cumsum[x * 4 + 2] = row_sum[2] + previous_cumsum[x * 4 + 2];</span>
<span class="lineNum">    2085 </span><span class="lineNoCov">          0 :     cumsum[x * 4 + 3] = row_sum[3] + previous_cumsum[x * 4 + 3];</span>
<span class="lineNum">    2086 </span>            :   }
<a name="2087"><span class="lineNum">    2087 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    2088 </span>            : 
<span class="lineNum">    2089 </span><span class="lineNoCov">          0 : void CumulativeSumToAverageRow_C(const int32* tl,</span>
<span class="lineNum">    2090 </span>            :                                  const int32* bl,
<span class="lineNum">    2091 </span>            :                                  int w,
<span class="lineNum">    2092 </span>            :                                  int area,
<span class="lineNum">    2093 </span>            :                                  uint8* dst,
<span class="lineNum">    2094 </span>            :                                  int count) {
<span class="lineNum">    2095 </span><span class="lineNoCov">          0 :   float ooa = 1.0f / area;</span>
<span class="lineNum">    2096 </span>            :   int i;
<span class="lineNum">    2097 </span><span class="lineNoCov">          0 :   for (i = 0; i &lt; count; ++i) {</span>
<span class="lineNum">    2098 </span><span class="lineNoCov">          0 :     dst[0] = (uint8)((bl[w + 0] + tl[0] - bl[0] - tl[w + 0]) * ooa);</span>
<span class="lineNum">    2099 </span><span class="lineNoCov">          0 :     dst[1] = (uint8)((bl[w + 1] + tl[1] - bl[1] - tl[w + 1]) * ooa);</span>
<span class="lineNum">    2100 </span><span class="lineNoCov">          0 :     dst[2] = (uint8)((bl[w + 2] + tl[2] - bl[2] - tl[w + 2]) * ooa);</span>
<span class="lineNum">    2101 </span><span class="lineNoCov">          0 :     dst[3] = (uint8)((bl[w + 3] + tl[3] - bl[3] - tl[w + 3]) * ooa);</span>
<span class="lineNum">    2102 </span><span class="lineNoCov">          0 :     dst += 4;</span>
<span class="lineNum">    2103 </span><span class="lineNoCov">          0 :     tl += 4;</span>
<span class="lineNum">    2104 </span><span class="lineNoCov">          0 :     bl += 4;</span>
<span class="lineNum">    2105 </span>            :   }
<span class="lineNum">    2106 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">    2107 </span>            : 
<a name="2108"><span class="lineNum">    2108 </span>            : // Copy pixels from rotated source to destination row with a slope.</a>
<span class="lineNum">    2109 </span>            : LIBYUV_API
<span class="lineNum">    2110 </span><span class="lineNoCov">          0 : void ARGBAffineRow_C(const uint8* src_argb,</span>
<span class="lineNum">    2111 </span>            :                      int src_argb_stride,
<span class="lineNum">    2112 </span>            :                      uint8* dst_argb,
<span class="lineNum">    2113 </span>            :                      const float* uv_dudv,
<span class="lineNum">    2114 </span>            :                      int width) {
<span class="lineNum">    2115 </span>            :   int i;
<span class="lineNum">    2116 </span>            :   // Render a row of pixels from source into a buffer.
<span class="lineNum">    2117 </span>            :   float uv[2];
<span class="lineNum">    2118 </span><span class="lineNoCov">          0 :   uv[0] = uv_dudv[0];</span>
<span class="lineNum">    2119 </span><span class="lineNoCov">          0 :   uv[1] = uv_dudv[1];</span>
<span class="lineNum">    2120 </span><span class="lineNoCov">          0 :   for (i = 0; i &lt; width; ++i) {</span>
<span class="lineNum">    2121 </span><span class="lineNoCov">          0 :     int x = (int)(uv[0]);</span>
<span class="lineNum">    2122 </span><span class="lineNoCov">          0 :     int y = (int)(uv[1]);</span>
<span class="lineNum">    2123 </span><span class="lineNoCov">          0 :     *(uint32*)(dst_argb) =</span>
<span class="lineNum">    2124 </span><span class="lineNoCov">          0 :         *(const uint32*)(src_argb + y * src_argb_stride + x * 4);</span>
<span class="lineNum">    2125 </span><span class="lineNoCov">          0 :     dst_argb += 4;</span>
<span class="lineNum">    2126 </span><span class="lineNoCov">          0 :     uv[0] += uv_dudv[2];</span>
<span class="lineNum">    2127 </span><span class="lineNoCov">          0 :     uv[1] += uv_dudv[3];</span>
<span class="lineNum">    2128 </span>            :   }
<span class="lineNum">    2129 </span><span class="lineNoCov">          0 : }</span>
<a name="2130"><span class="lineNum">    2130 </span>            : </a>
<span class="lineNum">    2131 </span>            : // Blend 2 rows into 1.
<span class="lineNum">    2132 </span><span class="lineNoCov">          0 : static void HalfRow_C(const uint8* src_uv,</span>
<span class="lineNum">    2133 </span>            :                       ptrdiff_t src_uv_stride,
<span class="lineNum">    2134 </span>            :                       uint8* dst_uv,
<span class="lineNum">    2135 </span>            :                       int width) {
<span class="lineNum">    2136 </span>            :   int x;
<span class="lineNum">    2137 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width; ++x) {</span>
<span class="lineNum">    2138 </span><span class="lineNoCov">          0 :     dst_uv[x] = (src_uv[x] + src_uv[src_uv_stride + x] + 1) &gt;&gt; 1;</span>
<span class="lineNum">    2139 </span>            :   }
<a name="2140"><span class="lineNum">    2140 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    2141 </span>            : 
<span class="lineNum">    2142 </span><span class="lineNoCov">          0 : static void HalfRow_16_C(const uint16* src_uv,</span>
<span class="lineNum">    2143 </span>            :                          ptrdiff_t src_uv_stride,
<span class="lineNum">    2144 </span>            :                          uint16* dst_uv,
<span class="lineNum">    2145 </span>            :                          int width) {
<span class="lineNum">    2146 </span>            :   int x;
<span class="lineNum">    2147 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width; ++x) {</span>
<span class="lineNum">    2148 </span><span class="lineNoCov">          0 :     dst_uv[x] = (src_uv[x] + src_uv[src_uv_stride + x] + 1) &gt;&gt; 1;</span>
<span class="lineNum">    2149 </span>            :   }
<span class="lineNum">    2150 </span><span class="lineNoCov">          0 : }</span>
<a name="2151"><span class="lineNum">    2151 </span>            : </a>
<span class="lineNum">    2152 </span>            : // C version 2x2 -&gt; 2x1.
<span class="lineNum">    2153 </span><span class="lineNoCov">          0 : void InterpolateRow_C(uint8* dst_ptr,</span>
<span class="lineNum">    2154 </span>            :                       const uint8* src_ptr,
<span class="lineNum">    2155 </span>            :                       ptrdiff_t src_stride,
<span class="lineNum">    2156 </span>            :                       int width,
<span class="lineNum">    2157 </span>            :                       int source_y_fraction) {
<span class="lineNum">    2158 </span><span class="lineNoCov">          0 :   int y1_fraction = source_y_fraction;</span>
<span class="lineNum">    2159 </span><span class="lineNoCov">          0 :   int y0_fraction = 256 - y1_fraction;</span>
<span class="lineNum">    2160 </span><span class="lineNoCov">          0 :   const uint8* src_ptr1 = src_ptr + src_stride;</span>
<span class="lineNum">    2161 </span>            :   int x;
<span class="lineNum">    2162 </span><span class="lineNoCov">          0 :   if (y1_fraction == 0) {</span>
<span class="lineNum">    2163 </span><span class="lineNoCov">          0 :     memcpy(dst_ptr, src_ptr, width);</span>
<span class="lineNum">    2164 </span><span class="lineNoCov">          0 :     return;</span>
<span class="lineNum">    2165 </span>            :   }
<span class="lineNum">    2166 </span><span class="lineNoCov">          0 :   if (y1_fraction == 128) {</span>
<span class="lineNum">    2167 </span><span class="lineNoCov">          0 :     HalfRow_C(src_ptr, src_stride, dst_ptr, width);</span>
<span class="lineNum">    2168 </span><span class="lineNoCov">          0 :     return;</span>
<span class="lineNum">    2169 </span>            :   }
<span class="lineNum">    2170 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width - 1; x += 2) {</span>
<span class="lineNum">    2171 </span><span class="lineNoCov">          0 :     dst_ptr[0] =</span>
<span class="lineNum">    2172 </span><span class="lineNoCov">          0 :         (src_ptr[0] * y0_fraction + src_ptr1[0] * y1_fraction + 128) &gt;&gt; 8;</span>
<span class="lineNum">    2173 </span><span class="lineNoCov">          0 :     dst_ptr[1] =</span>
<span class="lineNum">    2174 </span><span class="lineNoCov">          0 :         (src_ptr[1] * y0_fraction + src_ptr1[1] * y1_fraction + 128) &gt;&gt; 8;</span>
<span class="lineNum">    2175 </span><span class="lineNoCov">          0 :     src_ptr += 2;</span>
<span class="lineNum">    2176 </span><span class="lineNoCov">          0 :     src_ptr1 += 2;</span>
<span class="lineNum">    2177 </span><span class="lineNoCov">          0 :     dst_ptr += 2;</span>
<span class="lineNum">    2178 </span>            :   }
<span class="lineNum">    2179 </span><span class="lineNoCov">          0 :   if (width &amp; 1) {</span>
<span class="lineNum">    2180 </span><span class="lineNoCov">          0 :     dst_ptr[0] =</span>
<span class="lineNum">    2181 </span><span class="lineNoCov">          0 :         (src_ptr[0] * y0_fraction + src_ptr1[0] * y1_fraction + 128) &gt;&gt; 8;</span>
<span class="lineNum">    2182 </span>            :   }
<a name="2183"><span class="lineNum">    2183 </span>            : }</a>
<span class="lineNum">    2184 </span>            : 
<span class="lineNum">    2185 </span><span class="lineNoCov">          0 : void InterpolateRow_16_C(uint16* dst_ptr,</span>
<span class="lineNum">    2186 </span>            :                          const uint16* src_ptr,
<span class="lineNum">    2187 </span>            :                          ptrdiff_t src_stride,
<span class="lineNum">    2188 </span>            :                          int width,
<span class="lineNum">    2189 </span>            :                          int source_y_fraction) {
<span class="lineNum">    2190 </span><span class="lineNoCov">          0 :   int y1_fraction = source_y_fraction;</span>
<span class="lineNum">    2191 </span><span class="lineNoCov">          0 :   int y0_fraction = 256 - y1_fraction;</span>
<span class="lineNum">    2192 </span><span class="lineNoCov">          0 :   const uint16* src_ptr1 = src_ptr + src_stride;</span>
<span class="lineNum">    2193 </span>            :   int x;
<span class="lineNum">    2194 </span><span class="lineNoCov">          0 :   if (source_y_fraction == 0) {</span>
<span class="lineNum">    2195 </span><span class="lineNoCov">          0 :     memcpy(dst_ptr, src_ptr, width * 2);</span>
<span class="lineNum">    2196 </span><span class="lineNoCov">          0 :     return;</span>
<span class="lineNum">    2197 </span>            :   }
<span class="lineNum">    2198 </span><span class="lineNoCov">          0 :   if (source_y_fraction == 128) {</span>
<span class="lineNum">    2199 </span><span class="lineNoCov">          0 :     HalfRow_16_C(src_ptr, src_stride, dst_ptr, width);</span>
<span class="lineNum">    2200 </span><span class="lineNoCov">          0 :     return;</span>
<span class="lineNum">    2201 </span>            :   }
<span class="lineNum">    2202 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width - 1; x += 2) {</span>
<span class="lineNum">    2203 </span><span class="lineNoCov">          0 :     dst_ptr[0] = (src_ptr[0] * y0_fraction + src_ptr1[0] * y1_fraction) &gt;&gt; 8;</span>
<span class="lineNum">    2204 </span><span class="lineNoCov">          0 :     dst_ptr[1] = (src_ptr[1] * y0_fraction + src_ptr1[1] * y1_fraction) &gt;&gt; 8;</span>
<span class="lineNum">    2205 </span><span class="lineNoCov">          0 :     src_ptr += 2;</span>
<span class="lineNum">    2206 </span><span class="lineNoCov">          0 :     src_ptr1 += 2;</span>
<span class="lineNum">    2207 </span><span class="lineNoCov">          0 :     dst_ptr += 2;</span>
<span class="lineNum">    2208 </span>            :   }
<span class="lineNum">    2209 </span><span class="lineNoCov">          0 :   if (width &amp; 1) {</span>
<span class="lineNum">    2210 </span><span class="lineNoCov">          0 :     dst_ptr[0] = (src_ptr[0] * y0_fraction + src_ptr1[0] * y1_fraction) &gt;&gt; 8;</span>
<span class="lineNum">    2211 </span>            :   }
<span class="lineNum">    2212 </span>            : }
<a name="2213"><span class="lineNum">    2213 </span>            : </a>
<span class="lineNum">    2214 </span>            : // Use first 4 shuffler values to reorder ARGB channels.
<span class="lineNum">    2215 </span><span class="lineNoCov">          0 : void ARGBShuffleRow_C(const uint8* src_argb,</span>
<span class="lineNum">    2216 </span>            :                       uint8* dst_argb,
<span class="lineNum">    2217 </span>            :                       const uint8* shuffler,
<span class="lineNum">    2218 </span>            :                       int width) {
<span class="lineNum">    2219 </span><span class="lineNoCov">          0 :   int index0 = shuffler[0];</span>
<span class="lineNum">    2220 </span><span class="lineNoCov">          0 :   int index1 = shuffler[1];</span>
<span class="lineNum">    2221 </span><span class="lineNoCov">          0 :   int index2 = shuffler[2];</span>
<span class="lineNum">    2222 </span><span class="lineNoCov">          0 :   int index3 = shuffler[3];</span>
<span class="lineNum">    2223 </span>            :   // Shuffle a row of ARGB.
<span class="lineNum">    2224 </span>            :   int x;
<span class="lineNum">    2225 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width; ++x) {</span>
<span class="lineNum">    2226 </span>            :     // To support in-place conversion.
<span class="lineNum">    2227 </span><span class="lineNoCov">          0 :     uint8 b = src_argb[index0];</span>
<span class="lineNum">    2228 </span><span class="lineNoCov">          0 :     uint8 g = src_argb[index1];</span>
<span class="lineNum">    2229 </span><span class="lineNoCov">          0 :     uint8 r = src_argb[index2];</span>
<span class="lineNum">    2230 </span><span class="lineNoCov">          0 :     uint8 a = src_argb[index3];</span>
<span class="lineNum">    2231 </span><span class="lineNoCov">          0 :     dst_argb[0] = b;</span>
<span class="lineNum">    2232 </span><span class="lineNoCov">          0 :     dst_argb[1] = g;</span>
<span class="lineNum">    2233 </span><span class="lineNoCov">          0 :     dst_argb[2] = r;</span>
<span class="lineNum">    2234 </span><span class="lineNoCov">          0 :     dst_argb[3] = a;</span>
<span class="lineNum">    2235 </span><span class="lineNoCov">          0 :     src_argb += 4;</span>
<span class="lineNum">    2236 </span><span class="lineNoCov">          0 :     dst_argb += 4;</span>
<span class="lineNum">    2237 </span>            :   }
<a name="2238"><span class="lineNum">    2238 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    2239 </span>            : 
<span class="lineNum">    2240 </span><span class="lineNoCov">          0 : void I422ToYUY2Row_C(const uint8* src_y,</span>
<span class="lineNum">    2241 </span>            :                      const uint8* src_u,
<span class="lineNum">    2242 </span>            :                      const uint8* src_v,
<span class="lineNum">    2243 </span>            :                      uint8* dst_frame,
<span class="lineNum">    2244 </span>            :                      int width) {
<span class="lineNum">    2245 </span>            :   int x;
<span class="lineNum">    2246 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width - 1; x += 2) {</span>
<span class="lineNum">    2247 </span><span class="lineNoCov">          0 :     dst_frame[0] = src_y[0];</span>
<span class="lineNum">    2248 </span><span class="lineNoCov">          0 :     dst_frame[1] = src_u[0];</span>
<span class="lineNum">    2249 </span><span class="lineNoCov">          0 :     dst_frame[2] = src_y[1];</span>
<span class="lineNum">    2250 </span><span class="lineNoCov">          0 :     dst_frame[3] = src_v[0];</span>
<span class="lineNum">    2251 </span><span class="lineNoCov">          0 :     dst_frame += 4;</span>
<span class="lineNum">    2252 </span><span class="lineNoCov">          0 :     src_y += 2;</span>
<span class="lineNum">    2253 </span><span class="lineNoCov">          0 :     src_u += 1;</span>
<span class="lineNum">    2254 </span><span class="lineNoCov">          0 :     src_v += 1;</span>
<span class="lineNum">    2255 </span>            :   }
<span class="lineNum">    2256 </span><span class="lineNoCov">          0 :   if (width &amp; 1) {</span>
<span class="lineNum">    2257 </span><span class="lineNoCov">          0 :     dst_frame[0] = src_y[0];</span>
<span class="lineNum">    2258 </span><span class="lineNoCov">          0 :     dst_frame[1] = src_u[0];</span>
<span class="lineNum">    2259 </span><span class="lineNoCov">          0 :     dst_frame[2] = 0;</span>
<span class="lineNum">    2260 </span><span class="lineNoCov">          0 :     dst_frame[3] = src_v[0];</span>
<span class="lineNum">    2261 </span>            :   }
<a name="2262"><span class="lineNum">    2262 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    2263 </span>            : 
<span class="lineNum">    2264 </span><span class="lineNoCov">          0 : void I422ToUYVYRow_C(const uint8* src_y,</span>
<span class="lineNum">    2265 </span>            :                      const uint8* src_u,
<span class="lineNum">    2266 </span>            :                      const uint8* src_v,
<span class="lineNum">    2267 </span>            :                      uint8* dst_frame,
<span class="lineNum">    2268 </span>            :                      int width) {
<span class="lineNum">    2269 </span>            :   int x;
<span class="lineNum">    2270 </span><span class="lineNoCov">          0 :   for (x = 0; x &lt; width - 1; x += 2) {</span>
<span class="lineNum">    2271 </span><span class="lineNoCov">          0 :     dst_frame[0] = src_u[0];</span>
<span class="lineNum">    2272 </span><span class="lineNoCov">          0 :     dst_frame[1] = src_y[0];</span>
<span class="lineNum">    2273 </span><span class="lineNoCov">          0 :     dst_frame[2] = src_v[0];</span>
<span class="lineNum">    2274 </span><span class="lineNoCov">          0 :     dst_frame[3] = src_y[1];</span>
<span class="lineNum">    2275 </span><span class="lineNoCov">          0 :     dst_frame += 4;</span>
<span class="lineNum">    2276 </span><span class="lineNoCov">          0 :     src_y += 2;</span>
<span class="lineNum">    2277 </span><span class="lineNoCov">          0 :     src_u += 1;</span>
<span class="lineNum">    2278 </span><span class="lineNoCov">          0 :     src_v += 1;</span>
<span class="lineNum">    2279 </span>            :   }
<span class="lineNum">    2280 </span><span class="lineNoCov">          0 :   if (width &amp; 1) {</span>
<span class="lineNum">    2281 </span><span class="lineNoCov">          0 :     dst_frame[0] = src_u[0];</span>
<span class="lineNum">    2282 </span><span class="lineNoCov">          0 :     dst_frame[1] = src_y[0];</span>
<span class="lineNum">    2283 </span><span class="lineNoCov">          0 :     dst_frame[2] = src_v[0];</span>
<span class="lineNum">    2284 </span><span class="lineNoCov">          0 :     dst_frame[3] = 0;</span>
<span class="lineNum">    2285 </span>            :   }
<a name="2286"><span class="lineNum">    2286 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    2287 </span>            : 
<span class="lineNum">    2288 </span><span class="lineNoCov">          0 : void ARGBPolynomialRow_C(const uint8* src_argb,</span>
<span class="lineNum">    2289 </span>            :                          uint8* dst_argb,
<span class="lineNum">    2290 </span>            :                          const float* poly,
<span class="lineNum">    2291 </span>            :                          int width) {
<span class="lineNum">    2292 </span>            :   int i;
<span class="lineNum">    2293 </span><span class="lineNoCov">          0 :   for (i = 0; i &lt; width; ++i) {</span>
<span class="lineNum">    2294 </span><span class="lineNoCov">          0 :     float b = (float)(src_argb[0]);</span>
<span class="lineNum">    2295 </span><span class="lineNoCov">          0 :     float g = (float)(src_argb[1]);</span>
<span class="lineNum">    2296 </span><span class="lineNoCov">          0 :     float r = (float)(src_argb[2]);</span>
<span class="lineNum">    2297 </span><span class="lineNoCov">          0 :     float a = (float)(src_argb[3]);</span>
<span class="lineNum">    2298 </span><span class="lineNoCov">          0 :     float b2 = b * b;</span>
<span class="lineNum">    2299 </span><span class="lineNoCov">          0 :     float g2 = g * g;</span>
<span class="lineNum">    2300 </span><span class="lineNoCov">          0 :     float r2 = r * r;</span>
<span class="lineNum">    2301 </span><span class="lineNoCov">          0 :     float a2 = a * a;</span>
<span class="lineNum">    2302 </span><span class="lineNoCov">          0 :     float db = poly[0] + poly[4] * b;</span>
<span class="lineNum">    2303 </span><span class="lineNoCov">          0 :     float dg = poly[1] + poly[5] * g;</span>
<span class="lineNum">    2304 </span><span class="lineNoCov">          0 :     float dr = poly[2] + poly[6] * r;</span>
<span class="lineNum">    2305 </span><span class="lineNoCov">          0 :     float da = poly[3] + poly[7] * a;</span>
<span class="lineNum">    2306 </span><span class="lineNoCov">          0 :     float b3 = b2 * b;</span>
<span class="lineNum">    2307 </span><span class="lineNoCov">          0 :     float g3 = g2 * g;</span>
<span class="lineNum">    2308 </span><span class="lineNoCov">          0 :     float r3 = r2 * r;</span>
<span class="lineNum">    2309 </span><span class="lineNoCov">          0 :     float a3 = a2 * a;</span>
<span class="lineNum">    2310 </span><span class="lineNoCov">          0 :     db += poly[8] * b2;</span>
<span class="lineNum">    2311 </span><span class="lineNoCov">          0 :     dg += poly[9] * g2;</span>
<span class="lineNum">    2312 </span><span class="lineNoCov">          0 :     dr += poly[10] * r2;</span>
<span class="lineNum">    2313 </span><span class="lineNoCov">          0 :     da += poly[11] * a2;</span>
<span class="lineNum">    2314 </span><span class="lineNoCov">          0 :     db += poly[12] * b3;</span>
<span class="lineNum">    2315 </span><span class="lineNoCov">          0 :     dg += poly[13] * g3;</span>
<span class="lineNum">    2316 </span><span class="lineNoCov">          0 :     dr += poly[14] * r3;</span>
<span class="lineNum">    2317 </span><span class="lineNoCov">          0 :     da += poly[15] * a3;</span>
<span class="lineNum">    2318 </span>            : 
<span class="lineNum">    2319 </span><span class="lineNoCov">          0 :     dst_argb[0] = Clamp((int32)(db));</span>
<span class="lineNum">    2320 </span><span class="lineNoCov">          0 :     dst_argb[1] = Clamp((int32)(dg));</span>
<span class="lineNum">    2321 </span><span class="lineNoCov">          0 :     dst_argb[2] = Clamp((int32)(dr));</span>
<span class="lineNum">    2322 </span><span class="lineNoCov">          0 :     dst_argb[3] = Clamp((int32)(da));</span>
<span class="lineNum">    2323 </span><span class="lineNoCov">          0 :     src_argb += 4;</span>
<span class="lineNum">    2324 </span><span class="lineNoCov">          0 :     dst_argb += 4;</span>
<span class="lineNum">    2325 </span>            :   }
<span class="lineNum">    2326 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">    2327 </span>            : 
<span class="lineNum">    2328 </span>            : // Samples assumed to be unsigned in low 9, 10 or 12 bits.  Scale factor
<span class="lineNum">    2329 </span>            : // adjust the source integer range to the half float range desired.
<span class="lineNum">    2330 </span>            : 
<span class="lineNum">    2331 </span>            : // This magic constant is 2^-112. Multiplying by this
<span class="lineNum">    2332 </span>            : // is the same as subtracting 112 from the exponent, which
<span class="lineNum">    2333 </span>            : // is the difference in exponent bias between 32-bit and
<span class="lineNum">    2334 </span>            : // 16-bit floats. Once we've done this subtraction, we can
<span class="lineNum">    2335 </span>            : // simply extract the low bits of the exponent and the high
<a name="2336"><span class="lineNum">    2336 </span>            : // bits of the mantissa from our float and we're done.</a>
<span class="lineNum">    2337 </span>            : 
<span class="lineNum">    2338 </span><span class="lineNoCov">          0 : void HalfFloatRow_C(const uint16* src, uint16* dst, float scale, int width) {</span>
<span class="lineNum">    2339 </span>            :   int i;
<span class="lineNum">    2340 </span><span class="lineNoCov">          0 :   float mult = 1.9259299444e-34f * scale;</span>
<span class="lineNum">    2341 </span><span class="lineNoCov">          0 :   for (i = 0; i &lt; width; ++i) {</span>
<span class="lineNum">    2342 </span><span class="lineNoCov">          0 :     float value = src[i] * mult;</span>
<span class="lineNum">    2343 </span><span class="lineNoCov">          0 :     dst[i] = (uint16)((*(uint32_t*)&amp;value) &gt;&gt; 13);</span>
<span class="lineNum">    2344 </span>            :   }
<a name="2345"><span class="lineNum">    2345 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    2346 </span>            : 
<span class="lineNum">    2347 </span><span class="lineNoCov">          0 : void ARGBLumaColorTableRow_C(const uint8* src_argb,</span>
<span class="lineNum">    2348 </span>            :                              uint8* dst_argb,
<span class="lineNum">    2349 </span>            :                              int width,
<span class="lineNum">    2350 </span>            :                              const uint8* luma,
<span class="lineNum">    2351 </span>            :                              uint32 lumacoeff) {
<span class="lineNum">    2352 </span><span class="lineNoCov">          0 :   uint32 bc = lumacoeff &amp; 0xff;</span>
<span class="lineNum">    2353 </span><span class="lineNoCov">          0 :   uint32 gc = (lumacoeff &gt;&gt; 8) &amp; 0xff;</span>
<span class="lineNum">    2354 </span><span class="lineNoCov">          0 :   uint32 rc = (lumacoeff &gt;&gt; 16) &amp; 0xff;</span>
<span class="lineNum">    2355 </span>            : 
<span class="lineNum">    2356 </span>            :   int i;
<span class="lineNum">    2357 </span><span class="lineNoCov">          0 :   for (i = 0; i &lt; width - 1; i += 2) {</span>
<span class="lineNum">    2358 </span>            :     // Luminance in rows, color values in columns.
<span class="lineNum">    2359 </span>            :     const uint8* luma0 =
<span class="lineNum">    2360 </span><span class="lineNoCov">          0 :         ((src_argb[0] * bc + src_argb[1] * gc + src_argb[2] * rc) &amp; 0x7F00u) +</span>
<span class="lineNum">    2361 </span><span class="lineNoCov">          0 :         luma;</span>
<span class="lineNum">    2362 </span>            :     const uint8* luma1;
<span class="lineNum">    2363 </span><span class="lineNoCov">          0 :     dst_argb[0] = luma0[src_argb[0]];</span>
<span class="lineNum">    2364 </span><span class="lineNoCov">          0 :     dst_argb[1] = luma0[src_argb[1]];</span>
<span class="lineNum">    2365 </span><span class="lineNoCov">          0 :     dst_argb[2] = luma0[src_argb[2]];</span>
<span class="lineNum">    2366 </span><span class="lineNoCov">          0 :     dst_argb[3] = src_argb[3];</span>
<span class="lineNum">    2367 </span><span class="lineNoCov">          0 :     luma1 =</span>
<span class="lineNum">    2368 </span><span class="lineNoCov">          0 :         ((src_argb[4] * bc + src_argb[5] * gc + src_argb[6] * rc) &amp; 0x7F00u) +</span>
<span class="lineNum">    2369 </span>            :         luma;
<span class="lineNum">    2370 </span><span class="lineNoCov">          0 :     dst_argb[4] = luma1[src_argb[4]];</span>
<span class="lineNum">    2371 </span><span class="lineNoCov">          0 :     dst_argb[5] = luma1[src_argb[5]];</span>
<span class="lineNum">    2372 </span><span class="lineNoCov">          0 :     dst_argb[6] = luma1[src_argb[6]];</span>
<span class="lineNum">    2373 </span><span class="lineNoCov">          0 :     dst_argb[7] = src_argb[7];</span>
<span class="lineNum">    2374 </span><span class="lineNoCov">          0 :     src_argb += 8;</span>
<span class="lineNum">    2375 </span><span class="lineNoCov">          0 :     dst_argb += 8;</span>
<span class="lineNum">    2376 </span>            :   }
<span class="lineNum">    2377 </span><span class="lineNoCov">          0 :   if (width &amp; 1) {</span>
<span class="lineNum">    2378 </span>            :     // Luminance in rows, color values in columns.
<span class="lineNum">    2379 </span>            :     const uint8* luma0 =
<span class="lineNum">    2380 </span><span class="lineNoCov">          0 :         ((src_argb[0] * bc + src_argb[1] * gc + src_argb[2] * rc) &amp; 0x7F00u) +</span>
<span class="lineNum">    2381 </span><span class="lineNoCov">          0 :         luma;</span>
<span class="lineNum">    2382 </span><span class="lineNoCov">          0 :     dst_argb[0] = luma0[src_argb[0]];</span>
<span class="lineNum">    2383 </span><span class="lineNoCov">          0 :     dst_argb[1] = luma0[src_argb[1]];</span>
<span class="lineNum">    2384 </span><span class="lineNoCov">          0 :     dst_argb[2] = luma0[src_argb[2]];</span>
<span class="lineNum">    2385 </span><span class="lineNoCov">          0 :     dst_argb[3] = src_argb[3];</span>
<span class="lineNum">    2386 </span>            :   }
<a name="2387"><span class="lineNum">    2387 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    2388 </span>            : 
<span class="lineNum">    2389 </span><span class="lineNoCov">          0 : void ARGBCopyAlphaRow_C(const uint8* src, uint8* dst, int width) {</span>
<span class="lineNum">    2390 </span>            :   int i;
<span class="lineNum">    2391 </span><span class="lineNoCov">          0 :   for (i = 0; i &lt; width - 1; i += 2) {</span>
<span class="lineNum">    2392 </span><span class="lineNoCov">          0 :     dst[3] = src[3];</span>
<span class="lineNum">    2393 </span><span class="lineNoCov">          0 :     dst[7] = src[7];</span>
<span class="lineNum">    2394 </span><span class="lineNoCov">          0 :     dst += 8;</span>
<span class="lineNum">    2395 </span><span class="lineNoCov">          0 :     src += 8;</span>
<span class="lineNum">    2396 </span>            :   }
<span class="lineNum">    2397 </span><span class="lineNoCov">          0 :   if (width &amp; 1) {</span>
<span class="lineNum">    2398 </span><span class="lineNoCov">          0 :     dst[3] = src[3];</span>
<span class="lineNum">    2399 </span>            :   }
<a name="2400"><span class="lineNum">    2400 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    2401 </span>            : 
<span class="lineNum">    2402 </span><span class="lineNoCov">          0 : void ARGBExtractAlphaRow_C(const uint8* src_argb, uint8* dst_a, int width) {</span>
<span class="lineNum">    2403 </span>            :   int i;
<span class="lineNum">    2404 </span><span class="lineNoCov">          0 :   for (i = 0; i &lt; width - 1; i += 2) {</span>
<span class="lineNum">    2405 </span><span class="lineNoCov">          0 :     dst_a[0] = src_argb[3];</span>
<span class="lineNum">    2406 </span><span class="lineNoCov">          0 :     dst_a[1] = src_argb[7];</span>
<span class="lineNum">    2407 </span><span class="lineNoCov">          0 :     dst_a += 2;</span>
<span class="lineNum">    2408 </span><span class="lineNoCov">          0 :     src_argb += 8;</span>
<span class="lineNum">    2409 </span>            :   }
<span class="lineNum">    2410 </span><span class="lineNoCov">          0 :   if (width &amp; 1) {</span>
<span class="lineNum">    2411 </span><span class="lineNoCov">          0 :     dst_a[0] = src_argb[3];</span>
<span class="lineNum">    2412 </span>            :   }
<a name="2413"><span class="lineNum">    2413 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    2414 </span>            : 
<span class="lineNum">    2415 </span><span class="lineNoCov">          0 : void ARGBCopyYToAlphaRow_C(const uint8* src, uint8* dst, int width) {</span>
<span class="lineNum">    2416 </span>            :   int i;
<span class="lineNum">    2417 </span><span class="lineNoCov">          0 :   for (i = 0; i &lt; width - 1; i += 2) {</span>
<span class="lineNum">    2418 </span><span class="lineNoCov">          0 :     dst[3] = src[0];</span>
<span class="lineNum">    2419 </span><span class="lineNoCov">          0 :     dst[7] = src[1];</span>
<span class="lineNum">    2420 </span><span class="lineNoCov">          0 :     dst += 8;</span>
<span class="lineNum">    2421 </span><span class="lineNoCov">          0 :     src += 2;</span>
<span class="lineNum">    2422 </span>            :   }
<span class="lineNum">    2423 </span><span class="lineNoCov">          0 :   if (width &amp; 1) {</span>
<span class="lineNum">    2424 </span><span class="lineNoCov">          0 :     dst[3] = src[0];</span>
<span class="lineNum">    2425 </span>            :   }
<span class="lineNum">    2426 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">    2427 </span>            : 
<span class="lineNum">    2428 </span>            : // Maximum temporary width for wrappers to process at a time, in pixels.
<span class="lineNum">    2429 </span>            : #define MAXTWIDTH 2048
<span class="lineNum">    2430 </span>            : 
<span class="lineNum">    2431 </span>            : #if !(defined(_MSC_VER) &amp;&amp; defined(_M_IX86)) &amp;&amp; \
<a name="2432"><span class="lineNum">    2432 </span>            :     defined(HAS_I422TORGB565ROW_SSSE3)</a>
<span class="lineNum">    2433 </span>            : // row_win.cc has asm version, but GCC uses 2 step wrapper.
<span class="lineNum">    2434 </span><span class="lineNoCov">          0 : void I422ToRGB565Row_SSSE3(const uint8* src_y,</span>
<span class="lineNum">    2435 </span>            :                            const uint8* src_u,
<span class="lineNum">    2436 </span>            :                            const uint8* src_v,
<span class="lineNum">    2437 </span>            :                            uint8* dst_rgb565,
<span class="lineNum">    2438 </span>            :                            const struct YuvConstants* yuvconstants,
<span class="lineNum">    2439 </span>            :                            int width) {
<span class="lineNum">    2440 </span>            :   SIMD_ALIGNED(uint8 row[MAXTWIDTH * 4]);
<span class="lineNum">    2441 </span><span class="lineNoCov">          0 :   while (width &gt; 0) {</span>
<span class="lineNum">    2442 </span><span class="lineNoCov">          0 :     int twidth = width &gt; MAXTWIDTH ? MAXTWIDTH : width;</span>
<span class="lineNum">    2443 </span><span class="lineNoCov">          0 :     I422ToARGBRow_SSSE3(src_y, src_u, src_v, row, yuvconstants, twidth);</span>
<span class="lineNum">    2444 </span><span class="lineNoCov">          0 :     ARGBToRGB565Row_SSE2(row, dst_rgb565, twidth);</span>
<span class="lineNum">    2445 </span><span class="lineNoCov">          0 :     src_y += twidth;</span>
<span class="lineNum">    2446 </span><span class="lineNoCov">          0 :     src_u += twidth / 2;</span>
<span class="lineNum">    2447 </span><span class="lineNoCov">          0 :     src_v += twidth / 2;</span>
<span class="lineNum">    2448 </span><span class="lineNoCov">          0 :     dst_rgb565 += twidth * 2;</span>
<span class="lineNum">    2449 </span><span class="lineNoCov">          0 :     width -= twidth;</span>
<span class="lineNum">    2450 </span>            :   }
<span class="lineNum">    2451 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">    2452 </span>            : #endif
<a name="2453"><span class="lineNum">    2453 </span>            : </a>
<span class="lineNum">    2454 </span>            : #if defined(HAS_I422TOARGB1555ROW_SSSE3)
<span class="lineNum">    2455 </span><span class="lineNoCov">          0 : void I422ToARGB1555Row_SSSE3(const uint8* src_y,</span>
<span class="lineNum">    2456 </span>            :                              const uint8* src_u,
<span class="lineNum">    2457 </span>            :                              const uint8* src_v,
<span class="lineNum">    2458 </span>            :                              uint8* dst_argb1555,
<span class="lineNum">    2459 </span>            :                              const struct YuvConstants* yuvconstants,
<span class="lineNum">    2460 </span>            :                              int width) {
<span class="lineNum">    2461 </span>            :   // Row buffer for intermediate ARGB pixels.
<span class="lineNum">    2462 </span>            :   SIMD_ALIGNED(uint8 row[MAXTWIDTH * 4]);
<span class="lineNum">    2463 </span><span class="lineNoCov">          0 :   while (width &gt; 0) {</span>
<span class="lineNum">    2464 </span><span class="lineNoCov">          0 :     int twidth = width &gt; MAXTWIDTH ? MAXTWIDTH : width;</span>
<span class="lineNum">    2465 </span><span class="lineNoCov">          0 :     I422ToARGBRow_SSSE3(src_y, src_u, src_v, row, yuvconstants, twidth);</span>
<span class="lineNum">    2466 </span><span class="lineNoCov">          0 :     ARGBToARGB1555Row_SSE2(row, dst_argb1555, twidth);</span>
<span class="lineNum">    2467 </span><span class="lineNoCov">          0 :     src_y += twidth;</span>
<span class="lineNum">    2468 </span><span class="lineNoCov">          0 :     src_u += twidth / 2;</span>
<span class="lineNum">    2469 </span><span class="lineNoCov">          0 :     src_v += twidth / 2;</span>
<span class="lineNum">    2470 </span><span class="lineNoCov">          0 :     dst_argb1555 += twidth * 2;</span>
<span class="lineNum">    2471 </span><span class="lineNoCov">          0 :     width -= twidth;</span>
<span class="lineNum">    2472 </span>            :   }
<span class="lineNum">    2473 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">    2474 </span>            : #endif
<a name="2475"><span class="lineNum">    2475 </span>            : </a>
<span class="lineNum">    2476 </span>            : #if defined(HAS_I422TOARGB4444ROW_SSSE3)
<span class="lineNum">    2477 </span><span class="lineNoCov">          0 : void I422ToARGB4444Row_SSSE3(const uint8* src_y,</span>
<span class="lineNum">    2478 </span>            :                              const uint8* src_u,
<span class="lineNum">    2479 </span>            :                              const uint8* src_v,
<span class="lineNum">    2480 </span>            :                              uint8* dst_argb4444,
<span class="lineNum">    2481 </span>            :                              const struct YuvConstants* yuvconstants,
<span class="lineNum">    2482 </span>            :                              int width) {
<span class="lineNum">    2483 </span>            :   // Row buffer for intermediate ARGB pixels.
<span class="lineNum">    2484 </span>            :   SIMD_ALIGNED(uint8 row[MAXTWIDTH * 4]);
<span class="lineNum">    2485 </span><span class="lineNoCov">          0 :   while (width &gt; 0) {</span>
<span class="lineNum">    2486 </span><span class="lineNoCov">          0 :     int twidth = width &gt; MAXTWIDTH ? MAXTWIDTH : width;</span>
<span class="lineNum">    2487 </span><span class="lineNoCov">          0 :     I422ToARGBRow_SSSE3(src_y, src_u, src_v, row, yuvconstants, twidth);</span>
<span class="lineNum">    2488 </span><span class="lineNoCov">          0 :     ARGBToARGB4444Row_SSE2(row, dst_argb4444, twidth);</span>
<span class="lineNum">    2489 </span><span class="lineNoCov">          0 :     src_y += twidth;</span>
<span class="lineNum">    2490 </span><span class="lineNoCov">          0 :     src_u += twidth / 2;</span>
<span class="lineNum">    2491 </span><span class="lineNoCov">          0 :     src_v += twidth / 2;</span>
<span class="lineNum">    2492 </span><span class="lineNoCov">          0 :     dst_argb4444 += twidth * 2;</span>
<span class="lineNum">    2493 </span><span class="lineNoCov">          0 :     width -= twidth;</span>
<span class="lineNum">    2494 </span>            :   }
<span class="lineNum">    2495 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">    2496 </span>            : #endif
<a name="2497"><span class="lineNum">    2497 </span>            : </a>
<span class="lineNum">    2498 </span>            : #if defined(HAS_NV12TORGB565ROW_SSSE3)
<span class="lineNum">    2499 </span><span class="lineNoCov">          0 : void NV12ToRGB565Row_SSSE3(const uint8* src_y,</span>
<span class="lineNum">    2500 </span>            :                            const uint8* src_uv,
<span class="lineNum">    2501 </span>            :                            uint8* dst_rgb565,
<span class="lineNum">    2502 </span>            :                            const struct YuvConstants* yuvconstants,
<span class="lineNum">    2503 </span>            :                            int width) {
<span class="lineNum">    2504 </span>            :   // Row buffer for intermediate ARGB pixels.
<span class="lineNum">    2505 </span>            :   SIMD_ALIGNED(uint8 row[MAXTWIDTH * 4]);
<span class="lineNum">    2506 </span><span class="lineNoCov">          0 :   while (width &gt; 0) {</span>
<span class="lineNum">    2507 </span><span class="lineNoCov">          0 :     int twidth = width &gt; MAXTWIDTH ? MAXTWIDTH : width;</span>
<span class="lineNum">    2508 </span><span class="lineNoCov">          0 :     NV12ToARGBRow_SSSE3(src_y, src_uv, row, yuvconstants, twidth);</span>
<span class="lineNum">    2509 </span><span class="lineNoCov">          0 :     ARGBToRGB565Row_SSE2(row, dst_rgb565, twidth);</span>
<span class="lineNum">    2510 </span><span class="lineNoCov">          0 :     src_y += twidth;</span>
<span class="lineNum">    2511 </span><span class="lineNoCov">          0 :     src_uv += twidth;</span>
<span class="lineNum">    2512 </span><span class="lineNoCov">          0 :     dst_rgb565 += twidth * 2;</span>
<span class="lineNum">    2513 </span><span class="lineNoCov">          0 :     width -= twidth;</span>
<span class="lineNum">    2514 </span>            :   }
<span class="lineNum">    2515 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">    2516 </span>            : #endif
<a name="2517"><span class="lineNum">    2517 </span>            : </a>
<span class="lineNum">    2518 </span>            : #if defined(HAS_I422TORGB565ROW_AVX2)
<span class="lineNum">    2519 </span><span class="lineNoCov">          0 : void I422ToRGB565Row_AVX2(const uint8* src_y,</span>
<span class="lineNum">    2520 </span>            :                           const uint8* src_u,
<span class="lineNum">    2521 </span>            :                           const uint8* src_v,
<span class="lineNum">    2522 </span>            :                           uint8* dst_rgb565,
<span class="lineNum">    2523 </span>            :                           const struct YuvConstants* yuvconstants,
<span class="lineNum">    2524 </span>            :                           int width) {
<span class="lineNum">    2525 </span>            :   SIMD_ALIGNED(uint8 row[MAXTWIDTH * 4]);
<span class="lineNum">    2526 </span><span class="lineNoCov">          0 :   while (width &gt; 0) {</span>
<span class="lineNum">    2527 </span><span class="lineNoCov">          0 :     int twidth = width &gt; MAXTWIDTH ? MAXTWIDTH : width;</span>
<span class="lineNum">    2528 </span><span class="lineNoCov">          0 :     I422ToARGBRow_AVX2(src_y, src_u, src_v, row, yuvconstants, twidth);</span>
<span class="lineNum">    2529 </span>            : #if defined(HAS_ARGBTORGB565ROW_AVX2)
<span class="lineNum">    2530 </span>            :     ARGBToRGB565Row_AVX2(row, dst_rgb565, twidth);
<span class="lineNum">    2531 </span>            : #else
<span class="lineNum">    2532 </span><span class="lineNoCov">          0 :     ARGBToRGB565Row_SSE2(row, dst_rgb565, twidth);</span>
<span class="lineNum">    2533 </span>            : #endif
<span class="lineNum">    2534 </span><span class="lineNoCov">          0 :     src_y += twidth;</span>
<span class="lineNum">    2535 </span><span class="lineNoCov">          0 :     src_u += twidth / 2;</span>
<span class="lineNum">    2536 </span><span class="lineNoCov">          0 :     src_v += twidth / 2;</span>
<span class="lineNum">    2537 </span><span class="lineNoCov">          0 :     dst_rgb565 += twidth * 2;</span>
<span class="lineNum">    2538 </span><span class="lineNoCov">          0 :     width -= twidth;</span>
<span class="lineNum">    2539 </span>            :   }
<span class="lineNum">    2540 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">    2541 </span>            : #endif
<a name="2542"><span class="lineNum">    2542 </span>            : </a>
<span class="lineNum">    2543 </span>            : #if defined(HAS_I422TOARGB1555ROW_AVX2)
<span class="lineNum">    2544 </span><span class="lineNoCov">          0 : void I422ToARGB1555Row_AVX2(const uint8* src_y,</span>
<span class="lineNum">    2545 </span>            :                             const uint8* src_u,
<span class="lineNum">    2546 </span>            :                             const uint8* src_v,
<span class="lineNum">    2547 </span>            :                             uint8* dst_argb1555,
<span class="lineNum">    2548 </span>            :                             const struct YuvConstants* yuvconstants,
<span class="lineNum">    2549 </span>            :                             int width) {
<span class="lineNum">    2550 </span>            :   // Row buffer for intermediate ARGB pixels.
<span class="lineNum">    2551 </span>            :   SIMD_ALIGNED(uint8 row[MAXTWIDTH * 4]);
<span class="lineNum">    2552 </span><span class="lineNoCov">          0 :   while (width &gt; 0) {</span>
<span class="lineNum">    2553 </span><span class="lineNoCov">          0 :     int twidth = width &gt; MAXTWIDTH ? MAXTWIDTH : width;</span>
<span class="lineNum">    2554 </span><span class="lineNoCov">          0 :     I422ToARGBRow_AVX2(src_y, src_u, src_v, row, yuvconstants, twidth);</span>
<span class="lineNum">    2555 </span>            : #if defined(HAS_ARGBTOARGB1555ROW_AVX2)
<span class="lineNum">    2556 </span>            :     ARGBToARGB1555Row_AVX2(row, dst_argb1555, twidth);
<span class="lineNum">    2557 </span>            : #else
<span class="lineNum">    2558 </span><span class="lineNoCov">          0 :     ARGBToARGB1555Row_SSE2(row, dst_argb1555, twidth);</span>
<span class="lineNum">    2559 </span>            : #endif
<span class="lineNum">    2560 </span><span class="lineNoCov">          0 :     src_y += twidth;</span>
<span class="lineNum">    2561 </span><span class="lineNoCov">          0 :     src_u += twidth / 2;</span>
<span class="lineNum">    2562 </span><span class="lineNoCov">          0 :     src_v += twidth / 2;</span>
<span class="lineNum">    2563 </span><span class="lineNoCov">          0 :     dst_argb1555 += twidth * 2;</span>
<span class="lineNum">    2564 </span><span class="lineNoCov">          0 :     width -= twidth;</span>
<span class="lineNum">    2565 </span>            :   }
<span class="lineNum">    2566 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">    2567 </span>            : #endif
<a name="2568"><span class="lineNum">    2568 </span>            : </a>
<span class="lineNum">    2569 </span>            : #if defined(HAS_I422TOARGB4444ROW_AVX2)
<span class="lineNum">    2570 </span><span class="lineNoCov">          0 : void I422ToARGB4444Row_AVX2(const uint8* src_y,</span>
<span class="lineNum">    2571 </span>            :                             const uint8* src_u,
<span class="lineNum">    2572 </span>            :                             const uint8* src_v,
<span class="lineNum">    2573 </span>            :                             uint8* dst_argb4444,
<span class="lineNum">    2574 </span>            :                             const struct YuvConstants* yuvconstants,
<span class="lineNum">    2575 </span>            :                             int width) {
<span class="lineNum">    2576 </span>            :   // Row buffer for intermediate ARGB pixels.
<span class="lineNum">    2577 </span>            :   SIMD_ALIGNED(uint8 row[MAXTWIDTH * 4]);
<span class="lineNum">    2578 </span><span class="lineNoCov">          0 :   while (width &gt; 0) {</span>
<span class="lineNum">    2579 </span><span class="lineNoCov">          0 :     int twidth = width &gt; MAXTWIDTH ? MAXTWIDTH : width;</span>
<span class="lineNum">    2580 </span><span class="lineNoCov">          0 :     I422ToARGBRow_AVX2(src_y, src_u, src_v, row, yuvconstants, twidth);</span>
<span class="lineNum">    2581 </span>            : #if defined(HAS_ARGBTOARGB4444ROW_AVX2)
<span class="lineNum">    2582 </span>            :     ARGBToARGB4444Row_AVX2(row, dst_argb4444, twidth);
<span class="lineNum">    2583 </span>            : #else
<span class="lineNum">    2584 </span><span class="lineNoCov">          0 :     ARGBToARGB4444Row_SSE2(row, dst_argb4444, twidth);</span>
<span class="lineNum">    2585 </span>            : #endif
<span class="lineNum">    2586 </span><span class="lineNoCov">          0 :     src_y += twidth;</span>
<span class="lineNum">    2587 </span><span class="lineNoCov">          0 :     src_u += twidth / 2;</span>
<span class="lineNum">    2588 </span><span class="lineNoCov">          0 :     src_v += twidth / 2;</span>
<span class="lineNum">    2589 </span><span class="lineNoCov">          0 :     dst_argb4444 += twidth * 2;</span>
<span class="lineNum">    2590 </span><span class="lineNoCov">          0 :     width -= twidth;</span>
<span class="lineNum">    2591 </span>            :   }
<span class="lineNum">    2592 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">    2593 </span>            : #endif
<a name="2594"><span class="lineNum">    2594 </span>            : </a>
<span class="lineNum">    2595 </span>            : #if defined(HAS_I422TORGB24ROW_AVX2)
<span class="lineNum">    2596 </span><span class="lineNoCov">          0 : void I422ToRGB24Row_AVX2(const uint8* src_y,</span>
<span class="lineNum">    2597 </span>            :                          const uint8* src_u,
<span class="lineNum">    2598 </span>            :                          const uint8* src_v,
<span class="lineNum">    2599 </span>            :                          uint8* dst_rgb24,
<span class="lineNum">    2600 </span>            :                          const struct YuvConstants* yuvconstants,
<span class="lineNum">    2601 </span>            :                          int width) {
<span class="lineNum">    2602 </span>            :   // Row buffer for intermediate ARGB pixels.
<span class="lineNum">    2603 </span>            :   SIMD_ALIGNED(uint8 row[MAXTWIDTH * 4]);
<span class="lineNum">    2604 </span><span class="lineNoCov">          0 :   while (width &gt; 0) {</span>
<span class="lineNum">    2605 </span><span class="lineNoCov">          0 :     int twidth = width &gt; MAXTWIDTH ? MAXTWIDTH : width;</span>
<span class="lineNum">    2606 </span><span class="lineNoCov">          0 :     I422ToARGBRow_AVX2(src_y, src_u, src_v, row, yuvconstants, twidth);</span>
<span class="lineNum">    2607 </span>            :     // TODO(fbarchard): ARGBToRGB24Row_AVX2
<span class="lineNum">    2608 </span><span class="lineNoCov">          0 :     ARGBToRGB24Row_SSSE3(row, dst_rgb24, twidth);</span>
<span class="lineNum">    2609 </span><span class="lineNoCov">          0 :     src_y += twidth;</span>
<span class="lineNum">    2610 </span><span class="lineNoCov">          0 :     src_u += twidth / 2;</span>
<span class="lineNum">    2611 </span><span class="lineNoCov">          0 :     src_v += twidth / 2;</span>
<span class="lineNum">    2612 </span><span class="lineNoCov">          0 :     dst_rgb24 += twidth * 3;</span>
<span class="lineNum">    2613 </span><span class="lineNoCov">          0 :     width -= twidth;</span>
<span class="lineNum">    2614 </span>            :   }
<span class="lineNum">    2615 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">    2616 </span>            : #endif
<a name="2617"><span class="lineNum">    2617 </span>            : </a>
<span class="lineNum">    2618 </span>            : #if defined(HAS_NV12TORGB565ROW_AVX2)
<span class="lineNum">    2619 </span><span class="lineNoCov">          0 : void NV12ToRGB565Row_AVX2(const uint8* src_y,</span>
<span class="lineNum">    2620 </span>            :                           const uint8* src_uv,
<span class="lineNum">    2621 </span>            :                           uint8* dst_rgb565,
<span class="lineNum">    2622 </span>            :                           const struct YuvConstants* yuvconstants,
<span class="lineNum">    2623 </span>            :                           int width) {
<span class="lineNum">    2624 </span>            :   // Row buffer for intermediate ARGB pixels.
<span class="lineNum">    2625 </span>            :   SIMD_ALIGNED(uint8 row[MAXTWIDTH * 4]);
<span class="lineNum">    2626 </span><span class="lineNoCov">          0 :   while (width &gt; 0) {</span>
<span class="lineNum">    2627 </span><span class="lineNoCov">          0 :     int twidth = width &gt; MAXTWIDTH ? MAXTWIDTH : width;</span>
<span class="lineNum">    2628 </span><span class="lineNoCov">          0 :     NV12ToARGBRow_AVX2(src_y, src_uv, row, yuvconstants, twidth);</span>
<span class="lineNum">    2629 </span>            : #if defined(HAS_ARGBTORGB565ROW_AVX2)
<span class="lineNum">    2630 </span>            :     ARGBToRGB565Row_AVX2(row, dst_rgb565, twidth);
<span class="lineNum">    2631 </span>            : #else
<span class="lineNum">    2632 </span><span class="lineNoCov">          0 :     ARGBToRGB565Row_SSE2(row, dst_rgb565, twidth);</span>
<span class="lineNum">    2633 </span>            : #endif
<span class="lineNum">    2634 </span><span class="lineNoCov">          0 :     src_y += twidth;</span>
<span class="lineNum">    2635 </span><span class="lineNoCov">          0 :     src_uv += twidth;</span>
<span class="lineNum">    2636 </span><span class="lineNoCov">          0 :     dst_rgb565 += twidth * 2;</span>
<span class="lineNum">    2637 </span><span class="lineNoCov">          0 :     width -= twidth;</span>
<span class="lineNum">    2638 </span>            :   }
<span class="lineNum">    2639 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">    2640 </span>            : #endif
<span class="lineNum">    2641 </span>            : 
<span class="lineNum">    2642 </span>            : #ifdef __cplusplus
<span class="lineNum">    2643 </span>            : }  // extern &quot;C&quot;
<span class="lineNum">    2644 </span>            : }  // namespace libyuv
<span class="lineNum">    2645 </span>            : #endif
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../../../../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.13</a></td></tr>
  </table>
  <br>

</body>
</html>

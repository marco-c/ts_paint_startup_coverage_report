<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - output.info - media/webrtc/signaling/src/sdp/sipcc/sdp_main.c</title>
  <link rel="stylesheet" type="text/css" href="../../../../../../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../../../../../../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../../../../../../index.html">top level</a> - <a href="index.html">media/webrtc/signaling/src/sdp/sipcc</a> - sdp_main.c<span style="font-size: 80%;"> (source / <a href="sdp_main.c.func-sort-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">output.info</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntry">355</td>
            <td class="headerCovTableEntryLo">0.0 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2017-07-14 16:53:18</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntry">31</td>
            <td class="headerCovTableEntryLo">0.0 %</td>
          </tr>
          <tr>
            <td class="headerItem">Legend:</td>
            <td class="headerValueLeg">            Lines:
            <span class="coverLegendCov">hit</span>
            <span class="coverLegendNoCov">not hit</span>
</td>
            <td></td>
          </tr>
          <tr><td><img src="../../../../../../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../../../../../../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">          Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>            : /* This Source Code Form is subject to the terms of the Mozilla Public</a>
<span class="lineNum">       2 </span>            :  * License, v. 2.0. If a copy of the MPL was not distributed with this
<span class="lineNum">       3 </span>            :  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
<span class="lineNum">       4 </span>            : 
<span class="lineNum">       5 </span>            : #include &quot;sdp_os_defs.h&quot;
<span class="lineNum">       6 </span>            : #include &quot;sdp.h&quot;
<span class="lineNum">       7 </span>            : #include &quot;sdp_private.h&quot;
<span class="lineNum">       8 </span>            : 
<span class="lineNum">       9 </span>            : #include &quot;CSFLog.h&quot;
<span class="lineNum">      10 </span>            : 
<span class="lineNum">      11 </span>            : static const char* logTag = &quot;sdp_main&quot;;
<span class="lineNum">      12 </span>            : 
<span class="lineNum">      13 </span>            : /* Note: These *must* be in the same order as the enum types. */
<span class="lineNum">      14 </span>            : const sdp_tokenarray_t sdp_token[SDP_MAX_TOKENS] =
<span class="lineNum">      15 </span>            : {
<span class="lineNum">      16 </span>            :     {&quot;v=&quot;, sdp_parse_version,      sdp_build_version },
<span class="lineNum">      17 </span>            :     {&quot;o=&quot;, sdp_parse_owner,        sdp_build_owner },
<span class="lineNum">      18 </span>            :     {&quot;s=&quot;, sdp_parse_sessname,     sdp_build_sessname },
<span class="lineNum">      19 </span>            :     {&quot;i=&quot;, sdp_parse_sessinfo,     sdp_build_sessinfo },
<span class="lineNum">      20 </span>            :     {&quot;u=&quot;, sdp_parse_uri,          sdp_build_uri },
<span class="lineNum">      21 </span>            :     {&quot;e=&quot;, sdp_parse_email,        sdp_build_email },
<span class="lineNum">      22 </span>            :     {&quot;p=&quot;, sdp_parse_phonenum,     sdp_build_phonenum },
<span class="lineNum">      23 </span>            :     {&quot;c=&quot;, sdp_parse_connection,   sdp_build_connection },
<span class="lineNum">      24 </span>            :     {&quot;b=&quot;, sdp_parse_bandwidth,    sdp_build_bandwidth },
<span class="lineNum">      25 </span>            :     {&quot;t=&quot;, sdp_parse_timespec,     sdp_build_timespec },
<span class="lineNum">      26 </span>            :     {&quot;r=&quot;, sdp_parse_repeat_time,  sdp_build_repeat_time },
<span class="lineNum">      27 </span>            :     {&quot;z=&quot;, sdp_parse_timezone_adj, sdp_build_timezone_adj },
<span class="lineNum">      28 </span>            :     {&quot;k=&quot;, sdp_parse_encryption,   sdp_build_encryption },
<span class="lineNum">      29 </span>            :     {&quot;a=&quot;, sdp_parse_attribute,    sdp_build_attribute },
<span class="lineNum">      30 </span>            :     {&quot;m=&quot;, sdp_parse_media,        sdp_build_media }
<span class="lineNum">      31 </span>            : };
<span class="lineNum">      32 </span>            : 
<span class="lineNum">      33 </span>            : 
<span class="lineNum">      34 </span>            : /* Note: These *must* be in the same order as the enum types. */
<span class="lineNum">      35 </span>            : const sdp_attrarray_t sdp_attr[SDP_MAX_ATTR_TYPES] =
<span class="lineNum">      36 </span>            : {
<span class="lineNum">      37 </span>            :     {&quot;bearer&quot;, sizeof(&quot;bearer&quot;),
<span class="lineNum">      38 </span>            :      sdp_parse_attr_simple_string, sdp_build_attr_simple_string },
<span class="lineNum">      39 </span>            :     {&quot;called&quot;, sizeof(&quot;called&quot;),
<span class="lineNum">      40 </span>            :      sdp_parse_attr_simple_string, sdp_build_attr_simple_string },
<span class="lineNum">      41 </span>            :     {&quot;connection_type&quot;, sizeof(&quot;connection_type&quot;),
<span class="lineNum">      42 </span>            :      sdp_parse_attr_simple_string, sdp_build_attr_simple_string },
<span class="lineNum">      43 </span>            :     {&quot;dialed&quot;, sizeof(&quot;dialed&quot;),
<span class="lineNum">      44 </span>            :      sdp_parse_attr_simple_string, sdp_build_attr_simple_string },
<span class="lineNum">      45 </span>            :     {&quot;dialing&quot;, sizeof(&quot;dialing&quot;),
<span class="lineNum">      46 </span>            :      sdp_parse_attr_simple_string, sdp_build_attr_simple_string },
<span class="lineNum">      47 </span>            :     {&quot;direction&quot;, sizeof(&quot;direction&quot;),
<span class="lineNum">      48 </span>            :      sdp_parse_attr_comediadir, sdp_build_attr_comediadir },
<span class="lineNum">      49 </span>            :     {&quot;eecid&quot;, sizeof(&quot;eecid&quot;),
<span class="lineNum">      50 </span>            :      sdp_parse_attr_simple_u32, sdp_build_attr_simple_u32 },
<span class="lineNum">      51 </span>            :     {&quot;fmtp&quot;, sizeof(&quot;fmtp&quot;),
<span class="lineNum">      52 </span>            :      sdp_parse_attr_fmtp, sdp_build_attr_fmtp },
<span class="lineNum">      53 </span>            :     {&quot;sctpmap&quot;, sizeof(&quot;sctpmap&quot;),
<span class="lineNum">      54 </span>            :      sdp_parse_attr_sctpmap, sdp_build_attr_sctpmap },
<span class="lineNum">      55 </span>            :     {&quot;framing&quot;, sizeof(&quot;framing&quot;),
<span class="lineNum">      56 </span>            :      sdp_parse_attr_simple_string, sdp_build_attr_simple_string },
<span class="lineNum">      57 </span>            :     {&quot;inactive&quot;, sizeof(&quot;inactive&quot;),
<span class="lineNum">      58 </span>            :      sdp_parse_attr_direction, sdp_build_attr_direction },
<span class="lineNum">      59 </span>            :     {&quot;ptime&quot;, sizeof(&quot;ptime&quot;),
<span class="lineNum">      60 </span>            :      sdp_parse_attr_simple_u32, sdp_build_attr_simple_u32 },
<span class="lineNum">      61 </span>            :     {&quot;qos&quot;, sizeof(&quot;qos&quot;),
<span class="lineNum">      62 </span>            :      sdp_parse_attr_qos, sdp_build_attr_qos },
<span class="lineNum">      63 </span>            :     {&quot;curr&quot;, sizeof(&quot;curr&quot;),
<span class="lineNum">      64 </span>            :      sdp_parse_attr_curr, sdp_build_attr_curr },
<span class="lineNum">      65 </span>            :     {&quot;des&quot;, sizeof(&quot;des&quot;),
<span class="lineNum">      66 </span>            :      sdp_parse_attr_des, sdp_build_attr_des},
<span class="lineNum">      67 </span>            :     {&quot;conf&quot;, sizeof(&quot;conf&quot;),
<span class="lineNum">      68 </span>            :      sdp_parse_attr_conf, sdp_build_attr_conf},
<span class="lineNum">      69 </span>            :     {&quot;recvonly&quot;, sizeof(&quot;recvonly&quot;),
<span class="lineNum">      70 </span>            :      sdp_parse_attr_direction, sdp_build_attr_direction },
<span class="lineNum">      71 </span>            :     {&quot;rtpmap&quot;, sizeof(&quot;rtpmap&quot;),
<span class="lineNum">      72 </span>            :      sdp_parse_attr_transport_map, sdp_build_attr_transport_map },
<span class="lineNum">      73 </span>            :     {&quot;secure&quot;, sizeof(&quot;secure&quot;),
<span class="lineNum">      74 </span>            :      sdp_parse_attr_qos, sdp_build_attr_qos },
<span class="lineNum">      75 </span>            :     {&quot;sendonly&quot;, sizeof(&quot;sendonly&quot;),
<span class="lineNum">      76 </span>            :      sdp_parse_attr_direction, sdp_build_attr_direction },
<span class="lineNum">      77 </span>            :     {&quot;sendrecv&quot;, sizeof(&quot;sendrecv&quot;),
<span class="lineNum">      78 </span>            :      sdp_parse_attr_direction, sdp_build_attr_direction },
<span class="lineNum">      79 </span>            :     {&quot;subnet&quot;, sizeof(&quot;subnet&quot;),
<span class="lineNum">      80 </span>            :      sdp_parse_attr_subnet, sdp_build_attr_subnet },
<span class="lineNum">      81 </span>            :     {&quot;T38FaxVersion&quot;, sizeof(&quot;T38FaxVersion&quot;),
<span class="lineNum">      82 </span>            :      sdp_parse_attr_simple_u32, sdp_build_attr_simple_u32 },
<span class="lineNum">      83 </span>            :     {&quot;T38MaxBitRate&quot;, sizeof(&quot;T38MaxBitRate&quot;),
<span class="lineNum">      84 </span>            :      sdp_parse_attr_simple_u32, sdp_build_attr_simple_u32 },
<span class="lineNum">      85 </span>            :     {&quot;T38FaxFillBitRemoval&quot;, sizeof(&quot;T38FaxFillBitRemoval&quot;),
<span class="lineNum">      86 </span>            :      sdp_parse_attr_simple_bool, sdp_build_attr_simple_bool },
<span class="lineNum">      87 </span>            :     {&quot;T38FaxTranscodingMMR&quot;, sizeof(&quot;T38FaxTranscodingMMR&quot;),
<span class="lineNum">      88 </span>            :      sdp_parse_attr_simple_bool, sdp_build_attr_simple_bool },
<span class="lineNum">      89 </span>            :     {&quot;T38FaxTranscodingJBIG&quot;, sizeof(&quot;T38FaxTranscodingJBIG&quot;),
<span class="lineNum">      90 </span>            :      sdp_parse_attr_simple_bool, sdp_build_attr_simple_bool },
<span class="lineNum">      91 </span>            :     {&quot;T38FaxRateManagement&quot;, sizeof(&quot;T38FaxRateManagement&quot;),
<span class="lineNum">      92 </span>            :      sdp_parse_attr_t38_ratemgmt, sdp_build_attr_t38_ratemgmt },
<span class="lineNum">      93 </span>            :     {&quot;T38FaxMaxBuffer&quot;, sizeof(&quot;T38FaxMaxBuffer&quot;),
<span class="lineNum">      94 </span>            :      sdp_parse_attr_simple_u32, sdp_build_attr_simple_u32 },
<span class="lineNum">      95 </span>            :     {&quot;T38FaxMaxDatagram&quot;, sizeof(&quot;T38FaxMaxDatagram&quot;),
<span class="lineNum">      96 </span>            :      sdp_parse_attr_simple_u32, sdp_build_attr_simple_u32 },
<span class="lineNum">      97 </span>            :     {&quot;T38FaxUdpEC&quot;, sizeof(&quot;T38FaxUdpEC&quot;),
<span class="lineNum">      98 </span>            :      sdp_parse_attr_t38_udpec, sdp_build_attr_t38_udpec },
<span class="lineNum">      99 </span>            :     {&quot;X-cap&quot;, sizeof(&quot;X-cap&quot;),
<span class="lineNum">     100 </span>            :      sdp_parse_attr_cap, sdp_build_attr_cap },
<span class="lineNum">     101 </span>            :     {&quot;X-cpar&quot;, sizeof(&quot;X-cpar&quot;),
<span class="lineNum">     102 </span>            :      sdp_parse_attr_cpar, sdp_build_attr_cpar },
<span class="lineNum">     103 </span>            :     {&quot;X-pc-codec&quot;, sizeof(&quot;X-pc-codec&quot;),
<span class="lineNum">     104 </span>            :      sdp_parse_attr_pc_codec, sdp_build_attr_pc_codec },
<span class="lineNum">     105 </span>            :     {&quot;X-pc-qos&quot;, sizeof(&quot;X-pc-qos&quot;),
<span class="lineNum">     106 </span>            :      sdp_parse_attr_qos, sdp_build_attr_qos },
<span class="lineNum">     107 </span>            :     {&quot;X-qos&quot;, sizeof(&quot;X-qos&quot;),
<span class="lineNum">     108 </span>            :      sdp_parse_attr_qos, sdp_build_attr_qos },
<span class="lineNum">     109 </span>            :     {&quot;X-sqn&quot;, sizeof(&quot;X-sqn&quot;),
<span class="lineNum">     110 </span>            :      sdp_parse_attr_simple_u32, sdp_build_attr_simple_u32 },
<span class="lineNum">     111 </span>            :     {&quot;TMRGwXid&quot;, sizeof(&quot;TMRGwXid&quot;),
<span class="lineNum">     112 </span>            :      sdp_parse_attr_simple_bool, sdp_build_attr_simple_bool },
<span class="lineNum">     113 </span>            :     {&quot;TC1PayloadBytes&quot;, sizeof(&quot;TC1PayloadBytes&quot;),
<span class="lineNum">     114 </span>            :      sdp_parse_attr_simple_u32, sdp_build_attr_simple_u32 },
<span class="lineNum">     115 </span>            :     {&quot;TC1WindowSize&quot;, sizeof(&quot;TC1WindowSize&quot;),
<span class="lineNum">     116 </span>            :      sdp_parse_attr_simple_u32, sdp_build_attr_simple_u32 },
<span class="lineNum">     117 </span>            :     {&quot;TC2PayloadBytes&quot;, sizeof(&quot;TC2PayloadBytes&quot;),
<span class="lineNum">     118 </span>            :      sdp_parse_attr_simple_u32, sdp_build_attr_simple_u32 },
<span class="lineNum">     119 </span>            :     {&quot;TC2WindowSize&quot;, sizeof(&quot;TC2WindowSize&quot;),
<span class="lineNum">     120 </span>            :      sdp_parse_attr_simple_u32, sdp_build_attr_simple_u32 },
<span class="lineNum">     121 </span>            :     {&quot;rtcp&quot;, sizeof(&quot;rtcp&quot;),
<span class="lineNum">     122 </span>            :      sdp_parse_attr_rtcp, sdp_build_attr_rtcp },
<span class="lineNum">     123 </span>            :     {&quot;rtr&quot;, sizeof(&quot;rtr&quot;),
<span class="lineNum">     124 </span>            :      sdp_parse_attr_rtr, sdp_build_attr_rtr},
<span class="lineNum">     125 </span>            :     {&quot;silenceSupp&quot;, sizeof(&quot;silenceSupp&quot;),
<span class="lineNum">     126 </span>            :      sdp_parse_attr_silencesupp, sdp_build_attr_silencesupp },
<span class="lineNum">     127 </span>            :     {&quot;X-crypto&quot;, sizeof(&quot;X-crypto&quot;),
<span class="lineNum">     128 </span>            :      sdp_parse_attr_srtpcontext, sdp_build_attr_srtpcontext },
<span class="lineNum">     129 </span>            :     {&quot;mptime&quot;, sizeof(&quot;mptime&quot;),
<span class="lineNum">     130 </span>            :       sdp_parse_attr_mptime, sdp_build_attr_mptime },
<span class="lineNum">     131 </span>            :     {&quot;X-sidin&quot;, sizeof(&quot;X-sidin&quot;),
<span class="lineNum">     132 </span>            :       sdp_parse_attr_x_sidin, sdp_build_attr_x_sidin },
<span class="lineNum">     133 </span>            :     {&quot;X-sidout&quot;, sizeof(&quot;X-sidout&quot;),
<span class="lineNum">     134 </span>            :       sdp_parse_attr_x_sidout, sdp_build_attr_x_sidout },
<span class="lineNum">     135 </span>            :     {&quot;X-confid&quot;, sizeof(&quot;X-confid&quot;),
<span class="lineNum">     136 </span>            :       sdp_parse_attr_x_confid, sdp_build_attr_x_confid },
<span class="lineNum">     137 </span>            :     {&quot;group&quot;, sizeof(&quot;group&quot;),
<span class="lineNum">     138 </span>            :       sdp_parse_attr_group, sdp_build_attr_group },
<span class="lineNum">     139 </span>            :     {&quot;mid&quot;, sizeof(&quot;mid&quot;),
<span class="lineNum">     140 </span>            :       sdp_parse_attr_simple_string, sdp_build_attr_simple_string },
<span class="lineNum">     141 </span>            :     {&quot;source-filter&quot;, sizeof(&quot;source-filter&quot;),
<span class="lineNum">     142 </span>            :       sdp_parse_attr_source_filter, sdp_build_source_filter},
<span class="lineNum">     143 </span>            :     {&quot;rtcp-unicast&quot;, sizeof(&quot;rtcp-unicast&quot;),
<span class="lineNum">     144 </span>            :       sdp_parse_attr_rtcp_unicast, sdp_build_attr_rtcp_unicast},
<span class="lineNum">     145 </span>            :     {&quot;maxprate&quot;, sizeof(&quot;maxprate&quot;),
<span class="lineNum">     146 </span>            :       sdp_parse_attr_maxprate, sdp_build_attr_simple_string},
<span class="lineNum">     147 </span>            :     {&quot;sqn&quot;, sizeof(&quot;sqn&quot;),
<span class="lineNum">     148 </span>            :      sdp_parse_attr_simple_u32, sdp_build_attr_simple_u32 },
<span class="lineNum">     149 </span>            :     {&quot;cdsc&quot;, sizeof(&quot;cdsc&quot;),
<span class="lineNum">     150 </span>            :      sdp_parse_attr_cap, sdp_build_attr_cap },
<span class="lineNum">     151 </span>            :     {&quot;cpar&quot;, sizeof(&quot;cpar&quot;),
<span class="lineNum">     152 </span>            :      sdp_parse_attr_cpar, sdp_build_attr_cpar },
<span class="lineNum">     153 </span>            :     {&quot;sprtmap&quot;, sizeof(&quot;sprtmap&quot;),
<span class="lineNum">     154 </span>            :      sdp_parse_attr_transport_map, sdp_build_attr_transport_map },
<span class="lineNum">     155 </span>            :     {&quot;crypto&quot;, sizeof(&quot;crypto&quot;),
<span class="lineNum">     156 </span>            :      sdp_parse_attr_sdescriptions, sdp_build_attr_sdescriptions },
<span class="lineNum">     157 </span>            :     {&quot;label&quot;, sizeof(&quot;label&quot;),
<span class="lineNum">     158 </span>            :       sdp_parse_attr_simple_string, sdp_build_attr_simple_string },
<span class="lineNum">     159 </span>            :     {&quot;framerate&quot;, sizeof(&quot;framerate&quot;),
<span class="lineNum">     160 </span>            :       sdp_parse_attr_simple_u32, sdp_build_attr_simple_u32 },
<span class="lineNum">     161 </span>            :     {&quot;candidate&quot;, sizeof(&quot;candidate&quot;),
<span class="lineNum">     162 </span>            :       sdp_parse_attr_ice_attr, sdp_build_attr_ice_attr },
<span class="lineNum">     163 </span>            :     {&quot;ice-ufrag&quot;, sizeof(&quot;ice-ufrag&quot;),
<span class="lineNum">     164 </span>            :       sdp_parse_attr_ice_attr, sdp_build_attr_ice_attr },
<span class="lineNum">     165 </span>            :     {&quot;ice-pwd&quot;, sizeof(&quot;ice-pwd&quot;),
<span class="lineNum">     166 </span>            :       sdp_parse_attr_ice_attr, sdp_build_attr_ice_attr},
<span class="lineNum">     167 </span>            :     {&quot;ice-lite&quot;, sizeof(&quot;ice-lite&quot;),
<span class="lineNum">     168 </span>            :       sdp_parse_attr_simple_flag, sdp_build_attr_simple_flag},
<span class="lineNum">     169 </span>            :     {&quot;rtcp-mux&quot;, sizeof(&quot;rtcp-mux&quot;),
<span class="lineNum">     170 </span>            :       sdp_parse_attr_simple_flag, sdp_build_attr_simple_flag},
<span class="lineNum">     171 </span>            :     {&quot;fingerprint&quot;, sizeof(&quot;fingerprint&quot;),
<span class="lineNum">     172 </span>            :       sdp_parse_attr_complete_line, sdp_build_attr_simple_string},
<span class="lineNum">     173 </span>            :     {&quot;maxptime&quot;, sizeof(&quot;maxptime&quot;),
<span class="lineNum">     174 </span>            :       sdp_parse_attr_simple_u32, sdp_build_attr_simple_u32},
<span class="lineNum">     175 </span>            :     {&quot;rtcp-fb&quot;, sizeof(&quot;rtcp-fb&quot;),
<span class="lineNum">     176 </span>            :       sdp_parse_attr_rtcp_fb, sdp_build_attr_rtcp_fb},
<span class="lineNum">     177 </span>            :     {&quot;setup&quot;, sizeof(&quot;setup&quot;),
<span class="lineNum">     178 </span>            :       sdp_parse_attr_setup, sdp_build_attr_setup},
<span class="lineNum">     179 </span>            :     {&quot;connection&quot;, sizeof(&quot;connection&quot;),
<span class="lineNum">     180 </span>            :       sdp_parse_attr_connection, sdp_build_attr_connection},
<span class="lineNum">     181 </span>            :     {&quot;extmap&quot;, sizeof(&quot;extmap&quot;),
<span class="lineNum">     182 </span>            :       sdp_parse_attr_extmap, sdp_build_attr_extmap},
<span class="lineNum">     183 </span>            :     {&quot;identity&quot;, sizeof(&quot;identity&quot;),
<span class="lineNum">     184 </span>            :       sdp_parse_attr_long_line, sdp_build_attr_long_line},
<span class="lineNum">     185 </span>            :     {&quot;msid&quot;, sizeof(&quot;msid&quot;),
<span class="lineNum">     186 </span>            :       sdp_parse_attr_msid, sdp_build_attr_msid},
<span class="lineNum">     187 </span>            :     {&quot;msid-semantic&quot;, sizeof(&quot;msid-semantic&quot;),
<span class="lineNum">     188 </span>            :       sdp_parse_attr_msid_semantic, sdp_build_attr_msid_semantic},
<span class="lineNum">     189 </span>            :     {&quot;bundle-only&quot;, sizeof(&quot;bundle-only&quot;),
<span class="lineNum">     190 </span>            :       sdp_parse_attr_simple_flag, sdp_build_attr_simple_flag},
<span class="lineNum">     191 </span>            :     {&quot;end-of-candidates&quot;, sizeof(&quot;end-of-candidates&quot;),
<span class="lineNum">     192 </span>            :       sdp_parse_attr_simple_flag, sdp_build_attr_simple_flag},
<span class="lineNum">     193 </span>            :     {&quot;ice-options&quot;, sizeof(&quot;ice-options&quot;),
<span class="lineNum">     194 </span>            :       sdp_parse_attr_complete_line, sdp_build_attr_simple_string},
<span class="lineNum">     195 </span>            :     {&quot;ssrc&quot;, sizeof(&quot;ssrc&quot;),
<span class="lineNum">     196 </span>            :       sdp_parse_attr_ssrc, sdp_build_attr_ssrc},
<span class="lineNum">     197 </span>            :     {&quot;imageattr&quot;, sizeof(&quot;imageattr&quot;),
<span class="lineNum">     198 </span>            :       sdp_parse_attr_complete_line, sdp_build_attr_simple_string},
<span class="lineNum">     199 </span>            :     {&quot;simulcast&quot;, sizeof(&quot;simulcast&quot;),
<span class="lineNum">     200 </span>            :       sdp_parse_attr_complete_line, sdp_build_attr_simple_string},
<span class="lineNum">     201 </span>            :     {&quot;rid&quot;, sizeof(&quot;rid&quot;),
<span class="lineNum">     202 </span>            :       sdp_parse_attr_complete_line, sdp_build_attr_simple_string},
<span class="lineNum">     203 </span>            :     {&quot;dtls-message&quot;, sizeof(&quot;dtls-message&quot;),
<span class="lineNum">     204 </span>            :       sdp_parse_attr_long_line, sdp_build_attr_long_line},
<span class="lineNum">     205 </span>            :     {&quot;sctp-port&quot;, sizeof(&quot;sctp-port&quot;),
<span class="lineNum">     206 </span>            :       sdp_parse_attr_simple_u32, sdp_build_attr_simple_u32},
<span class="lineNum">     207 </span>            :     {&quot;max-message-size&quot;, sizeof(&quot;max-message-size&quot;),
<span class="lineNum">     208 </span>            :       sdp_parse_attr_simple_u32, sdp_build_attr_simple_u32},
<span class="lineNum">     209 </span>            : };
<span class="lineNum">     210 </span>            : 
<span class="lineNum">     211 </span>            : /* Note: These *must* be in the same order as the enum types. */
<span class="lineNum">     212 </span>            : const sdp_namearray_t sdp_media[SDP_MAX_MEDIA_TYPES] =
<span class="lineNum">     213 </span>            : {
<span class="lineNum">     214 </span>            :     {&quot;audio&quot;,        sizeof(&quot;audio&quot;)},
<span class="lineNum">     215 </span>            :     {&quot;video&quot;,        sizeof(&quot;video&quot;)},
<span class="lineNum">     216 </span>            :     {&quot;application&quot;,  sizeof(&quot;application&quot;)},
<span class="lineNum">     217 </span>            :     {&quot;data&quot;,         sizeof(&quot;data&quot;)},
<span class="lineNum">     218 </span>            :     {&quot;control&quot;,      sizeof(&quot;control&quot;)},
<span class="lineNum">     219 </span>            :     {&quot;nas/radius&quot;,   sizeof(&quot;nas/radius&quot;)},
<span class="lineNum">     220 </span>            :     {&quot;nas/tacacs&quot;,   sizeof(&quot;nas/tacacs&quot;)},
<span class="lineNum">     221 </span>            :     {&quot;nas/diameter&quot;, sizeof(&quot;nas/diameter&quot;)},
<span class="lineNum">     222 </span>            :     {&quot;nas/l2tp&quot;,     sizeof(&quot;nas/l2tp&quot;)},
<span class="lineNum">     223 </span>            :     {&quot;nas/login&quot;,    sizeof(&quot;nas/login&quot;)},
<span class="lineNum">     224 </span>            :     {&quot;nas/none&quot;,     sizeof(&quot;nas/none&quot;)},
<span class="lineNum">     225 </span>            :     {&quot;image&quot;,        sizeof(&quot;image&quot;)},
<span class="lineNum">     226 </span>            :     {&quot;text&quot;,         sizeof(&quot;text&quot;)}
<span class="lineNum">     227 </span>            : };
<span class="lineNum">     228 </span>            : 
<span class="lineNum">     229 </span>            : 
<span class="lineNum">     230 </span>            : /* Note: These *must* be in the same order as the enum types. */
<span class="lineNum">     231 </span>            : const sdp_namearray_t sdp_nettype[SDP_MAX_NETWORK_TYPES] =
<span class="lineNum">     232 </span>            : {
<span class="lineNum">     233 </span>            :     {&quot;IN&quot;,           sizeof(&quot;IN&quot;)},
<span class="lineNum">     234 </span>            :     {&quot;ATM&quot;,          sizeof(&quot;ATM&quot;)},
<span class="lineNum">     235 </span>            :     {&quot;FR&quot;,           sizeof(&quot;FR&quot;)},
<span class="lineNum">     236 </span>            :     {&quot;LOCAL&quot;,        sizeof(&quot;LOCAL&quot;)}
<span class="lineNum">     237 </span>            : };
<span class="lineNum">     238 </span>            : 
<span class="lineNum">     239 </span>            : 
<span class="lineNum">     240 </span>            : /* Note: These *must* be in the same order as the enum types. */
<span class="lineNum">     241 </span>            : const sdp_namearray_t sdp_addrtype[SDP_MAX_ADDR_TYPES] =
<span class="lineNum">     242 </span>            : {
<span class="lineNum">     243 </span>            :     {&quot;IP4&quot;,          sizeof(&quot;IP4&quot;)},
<span class="lineNum">     244 </span>            :     {&quot;IP6&quot;,          sizeof(&quot;IP6&quot;)},
<span class="lineNum">     245 </span>            :     {&quot;NSAP&quot;,         sizeof(&quot;NSAP&quot;)},
<span class="lineNum">     246 </span>            :     {&quot;EPN&quot;,          sizeof(&quot;EPN&quot;)},
<span class="lineNum">     247 </span>            :     {&quot;E164&quot;,         sizeof(&quot;E164&quot;)},
<span class="lineNum">     248 </span>            :     {&quot;GWID&quot;,         sizeof(&quot;GWID&quot;)}
<span class="lineNum">     249 </span>            : };
<span class="lineNum">     250 </span>            : 
<span class="lineNum">     251 </span>            : 
<span class="lineNum">     252 </span>            : /* Note: These *must* be in the same order as the enum type. */
<span class="lineNum">     253 </span>            : const sdp_namearray_t sdp_transport[SDP_MAX_TRANSPORT_TYPES] =
<span class="lineNum">     254 </span>            : {
<span class="lineNum">     255 </span>            :     {&quot;RTP/AVP&quot;,      sizeof(&quot;RTP/AVP&quot;)},
<span class="lineNum">     256 </span>            :     {&quot;udp&quot;,          sizeof(&quot;udp&quot;)},
<span class="lineNum">     257 </span>            :     {&quot;udptl&quot;,        sizeof(&quot;udptl&quot;)},
<span class="lineNum">     258 </span>            :     {&quot;ces10&quot;,        sizeof(&quot;ces10&quot;)},
<span class="lineNum">     259 </span>            :     {&quot;LOCAL&quot;,        sizeof(&quot;LOCAL&quot;)},
<span class="lineNum">     260 </span>            :     {&quot;AAL2/ITU&quot;,     sizeof(&quot;AAL2/ITU&quot;)},
<span class="lineNum">     261 </span>            :     {&quot;AAL2/ATMF&quot;,    sizeof(&quot;AAL2/ATMF&quot;)},
<span class="lineNum">     262 </span>            :     {&quot;AAL2/custom&quot;,  sizeof(&quot;AAL2/custom&quot;)},
<span class="lineNum">     263 </span>            :     {&quot;AAL1/AVP&quot;,     sizeof(&quot;AAL1/AVP&quot;)},
<span class="lineNum">     264 </span>            :     {&quot;udpsprt&quot;,      sizeof(&quot;udpsprt&quot;)},
<span class="lineNum">     265 </span>            :     {&quot;RTP/SAVP&quot;,     sizeof(&quot;RTP/SAVP&quot;)},
<span class="lineNum">     266 </span>            :     {&quot;tcp&quot;,          sizeof(&quot;tcp&quot;)},
<span class="lineNum">     267 </span>            :     {&quot;RTP/SAVPF&quot;,    sizeof(&quot;RTP/SAVPF&quot;)},
<span class="lineNum">     268 </span>            :     {&quot;DTLS/SCTP&quot;,    sizeof(&quot;DTLS/SCTP&quot;)},
<span class="lineNum">     269 </span>            :     {&quot;RTP/AVPF&quot;,     sizeof(&quot;RTP/AVPF&quot;)},
<span class="lineNum">     270 </span>            :     {&quot;UDP/TLS/RTP/SAVP&quot;, sizeof(&quot;UDP/TLS/RTP/SAVP&quot;)},
<span class="lineNum">     271 </span>            :     {&quot;UDP/TLS/RTP/SAVPF&quot;, sizeof(&quot;UDP/TLS/RTP/SAVPF&quot;)},
<span class="lineNum">     272 </span>            :     {&quot;TCP/TLS/RTP/SAVP&quot;, sizeof(&quot;TCP/TLS/RTP/SAVP&quot;)},
<span class="lineNum">     273 </span>            :     {&quot;TCP/TLS/RTP/SAVPF&quot;, sizeof(&quot;TCP/TLS/RTP/SAVPF&quot;)},
<span class="lineNum">     274 </span>            :     {&quot;UDP/DTLS/SCTP&quot;,    sizeof(&quot;UDP/DTLS/SCTP&quot;)},
<span class="lineNum">     275 </span>            :     {&quot;TCP/DTLS/SCTP&quot;,    sizeof(&quot;TCP/DTLS/SCTP&quot;)},
<span class="lineNum">     276 </span>            : };
<span class="lineNum">     277 </span>            : 
<span class="lineNum">     278 </span>            : /* Note: These *must* be in the same order as the enum type. */
<span class="lineNum">     279 </span>            : const sdp_namearray_t sdp_encrypt[SDP_MAX_ENCRYPT_TYPES] =
<span class="lineNum">     280 </span>            : {
<span class="lineNum">     281 </span>            :     {&quot;clear&quot;,        sizeof(&quot;clear&quot;)},
<span class="lineNum">     282 </span>            :     {&quot;base64&quot;,       sizeof(&quot;base64&quot;)},
<span class="lineNum">     283 </span>            :     {&quot;uri&quot;,          sizeof(&quot;uri&quot;)},
<span class="lineNum">     284 </span>            :     {&quot;prompt&quot;,       sizeof(&quot;prompt&quot;)}
<span class="lineNum">     285 </span>            : };
<span class="lineNum">     286 </span>            : 
<span class="lineNum">     287 </span>            : /* Note: These *must* be in the same order as the enum type. */
<span class="lineNum">     288 </span>            : const sdp_namearray_t sdp_payload[SDP_MAX_STRING_PAYLOAD_TYPES] =
<span class="lineNum">     289 </span>            : {
<span class="lineNum">     290 </span>            :     {&quot;t38&quot;,          sizeof(&quot;t38&quot;)},
<span class="lineNum">     291 </span>            :     {&quot;X-tmr&quot;,        sizeof(&quot;X-tmr&quot;)},
<span class="lineNum">     292 </span>            :     {&quot;T120&quot;,         sizeof(&quot;T120&quot;)}
<span class="lineNum">     293 </span>            : };
<span class="lineNum">     294 </span>            : 
<span class="lineNum">     295 </span>            : /* Note: These *must* be in the same order as the enum type. */
<span class="lineNum">     296 </span>            : const sdp_namearray_t sdp_t38_rate[SDP_T38_MAX_RATES] =
<span class="lineNum">     297 </span>            : {
<span class="lineNum">     298 </span>            :     {&quot;localTCF&quot;,        sizeof(&quot;localTCF&quot;)},
<span class="lineNum">     299 </span>            :     {&quot;transferredTCF&quot;,  sizeof(&quot;transferredTCF&quot;)},
<span class="lineNum">     300 </span>            :     {&quot;unknown&quot;,         sizeof(&quot;unknown&quot;)}
<span class="lineNum">     301 </span>            : };
<span class="lineNum">     302 </span>            : 
<span class="lineNum">     303 </span>            : /* Note: These *must* be in the same order as the enum type. */
<span class="lineNum">     304 </span>            : const sdp_namearray_t sdp_t38_udpec[SDP_T38_MAX_UDPEC] =
<span class="lineNum">     305 </span>            : {
<span class="lineNum">     306 </span>            :     {&quot;t38UDPRedundancy&quot;,  sizeof(&quot;t38UDPRedundancy&quot;)},
<span class="lineNum">     307 </span>            :     {&quot;t38UDPFEC&quot;,         sizeof(&quot;t38UDPFEC&quot;)},
<span class="lineNum">     308 </span>            :     {&quot;unknown&quot;,           sizeof(&quot;unknown&quot;)}
<span class="lineNum">     309 </span>            : };
<span class="lineNum">     310 </span>            : 
<span class="lineNum">     311 </span>            : /* Note: These *must* be in the same order as the enum type. */
<span class="lineNum">     312 </span>            : const sdp_namearray_t sdp_qos_strength[SDP_MAX_QOS_STRENGTH] =
<span class="lineNum">     313 </span>            : {
<span class="lineNum">     314 </span>            :     {&quot;optional&quot;,          sizeof(&quot;optional&quot;)},
<span class="lineNum">     315 </span>            :     {&quot;mandatory&quot;,         sizeof(&quot;mandatory&quot;)},
<span class="lineNum">     316 </span>            :     {&quot;success&quot;,           sizeof(&quot;success&quot;)},
<span class="lineNum">     317 </span>            :     {&quot;failure&quot;,           sizeof(&quot;failure&quot;)},
<span class="lineNum">     318 </span>            :     {&quot;none&quot;,              sizeof(&quot;none&quot;)}
<span class="lineNum">     319 </span>            : };
<span class="lineNum">     320 </span>            : 
<span class="lineNum">     321 </span>            : /* Note: These *must* be in the same order as the enum type. */
<span class="lineNum">     322 </span>            : const sdp_namearray_t sdp_qos_status_type[SDP_MAX_QOS_STATUS_TYPES] =
<span class="lineNum">     323 </span>            : {
<span class="lineNum">     324 </span>            :     {&quot;local&quot;,          sizeof(&quot;local&quot;)},
<span class="lineNum">     325 </span>            :     {&quot;remote&quot;,         sizeof(&quot;remote&quot;)},
<span class="lineNum">     326 </span>            :     {&quot;e2e&quot;,            sizeof(&quot;e2e&quot;)}
<span class="lineNum">     327 </span>            : };
<span class="lineNum">     328 </span>            : 
<span class="lineNum">     329 </span>            : /* Note: These *must* be in the same order as the enum type. */
<span class="lineNum">     330 </span>            : const sdp_namearray_t sdp_curr_type[SDP_MAX_CURR_TYPES] =
<span class="lineNum">     331 </span>            : {
<span class="lineNum">     332 </span>            :     {&quot;qos&quot;,            sizeof(&quot;qos&quot;)},
<span class="lineNum">     333 </span>            :     {&quot;unknown&quot;,         sizeof(&quot;unknown&quot;)}
<span class="lineNum">     334 </span>            : };
<span class="lineNum">     335 </span>            : 
<span class="lineNum">     336 </span>            : /* Note: These *must* be in the same order as the enum type. */
<span class="lineNum">     337 </span>            : const sdp_namearray_t sdp_des_type[SDP_MAX_DES_TYPES] =
<span class="lineNum">     338 </span>            : {
<span class="lineNum">     339 </span>            :     {&quot;qos&quot;,            sizeof(&quot;qos&quot;)},
<span class="lineNum">     340 </span>            :     {&quot;unknown&quot;,         sizeof(&quot;unknown&quot;)}
<span class="lineNum">     341 </span>            : };
<span class="lineNum">     342 </span>            : 
<span class="lineNum">     343 </span>            : /* Note: These *must* be in the same order as the enum type. */
<span class="lineNum">     344 </span>            : const sdp_namearray_t sdp_conf_type[SDP_MAX_CONF_TYPES] =
<span class="lineNum">     345 </span>            : {
<span class="lineNum">     346 </span>            :     {&quot;qos&quot;,            sizeof(&quot;qos&quot;)},
<span class="lineNum">     347 </span>            :     {&quot;unknown&quot;,         sizeof(&quot;unknown&quot;)}
<span class="lineNum">     348 </span>            : };
<span class="lineNum">     349 </span>            : /* Note: These *must* be in the same order as the enum type. */
<span class="lineNum">     350 </span>            : const sdp_namearray_t sdp_qos_direction[SDP_MAX_QOS_DIR] =
<span class="lineNum">     351 </span>            : {
<span class="lineNum">     352 </span>            :     {&quot;send&quot;,              sizeof(&quot;send&quot;)},
<span class="lineNum">     353 </span>            :     {&quot;recv&quot;,              sizeof(&quot;recv&quot;)},
<span class="lineNum">     354 </span>            :     {&quot;sendrecv&quot;,          sizeof(&quot;sendrecv&quot;)},
<span class="lineNum">     355 </span>            :     {&quot;none&quot;,              sizeof(&quot;none&quot;)}
<span class="lineNum">     356 </span>            : };
<span class="lineNum">     357 </span>            : 
<span class="lineNum">     358 </span>            : /* Note: These *must* be in the same order as the enum type. */
<span class="lineNum">     359 </span>            : const sdp_namearray_t sdp_silencesupp_pref[SDP_MAX_SILENCESUPP_PREF] = {
<span class="lineNum">     360 </span>            :     {&quot;standard&quot;,          sizeof(&quot;standard&quot;)},
<span class="lineNum">     361 </span>            :     {&quot;custom&quot;,            sizeof(&quot;custom&quot;)},
<span class="lineNum">     362 </span>            :     {&quot;-&quot;,                 sizeof(&quot;-&quot;)}
<span class="lineNum">     363 </span>            : };
<span class="lineNum">     364 </span>            : 
<span class="lineNum">     365 </span>            : /* Note: These *must* be in the same order as the enum type. */
<span class="lineNum">     366 </span>            : const sdp_namearray_t sdp_silencesupp_siduse[SDP_MAX_SILENCESUPP_SIDUSE] = {
<span class="lineNum">     367 </span>            :     {&quot;No SID&quot;,            sizeof(&quot;No SID&quot;)},
<span class="lineNum">     368 </span>            :     {&quot;Fixed Noise&quot;,       sizeof(&quot;Fixed Noise&quot;)},
<span class="lineNum">     369 </span>            :     {&quot;Sampled Noise&quot;,     sizeof(&quot;Sampled Noise&quot;)},
<span class="lineNum">     370 </span>            :     {&quot;-&quot;,                 sizeof(&quot;-&quot;)}
<span class="lineNum">     371 </span>            : };
<span class="lineNum">     372 </span>            : 
<span class="lineNum">     373 </span>            : /* Note: These *must* be in the same order as the enum type. */
<span class="lineNum">     374 </span>            : const sdp_namearray_t sdp_mediadir_role[SDP_MAX_MEDIADIR_ROLES] =
<span class="lineNum">     375 </span>            : {
<span class="lineNum">     376 </span>            :     {&quot;passive&quot;,       sizeof(&quot;passive&quot;)},
<span class="lineNum">     377 </span>            :     {&quot;active&quot;,        sizeof(&quot;active&quot;)},
<span class="lineNum">     378 </span>            :     {&quot;both&quot;,          sizeof(&quot;both&quot;)},
<span class="lineNum">     379 </span>            :     {&quot;reuse&quot;,         sizeof(&quot;reuse&quot;)},
<span class="lineNum">     380 </span>            :     {&quot;unknown&quot;,       sizeof(&quot;unknown&quot;)}
<span class="lineNum">     381 </span>            : };
<span class="lineNum">     382 </span>            : 
<span class="lineNum">     383 </span>            : /* Note: These *must* be in the same order as the enum type. */
<span class="lineNum">     384 </span>            : const sdp_namearray_t sdp_fmtp_codec_param[SDP_MAX_FMTP_PARAM] =
<span class="lineNum">     385 </span>            : {
<span class="lineNum">     386 </span>            :     {&quot;annexa&quot;,              sizeof(&quot;annexa&quot;)}, /* 0 */
<span class="lineNum">     387 </span>            :     {&quot;annexb&quot;,              sizeof(&quot;annexb&quot;)}, /* 1 */
<span class="lineNum">     388 </span>            :     {&quot;bitrate&quot;,             sizeof(&quot;bitrate&quot;)}, /* 2 */
<span class="lineNum">     389 </span>            :     {&quot;QCIF&quot;,                sizeof(&quot;QCIF&quot;)}, /* 3 */
<span class="lineNum">     390 </span>            :     {&quot;CIF&quot;,                 sizeof(&quot;CIF&quot;)},  /* 4 */
<span class="lineNum">     391 </span>            :     {&quot;MAXBR&quot;,               sizeof(&quot;MAXBR&quot;)}, /* 5 */
<span class="lineNum">     392 </span>            :     {&quot;SQCIF&quot;,               sizeof(&quot;SQCIF&quot;)}, /* 6 */
<span class="lineNum">     393 </span>            :     {&quot;CIF4&quot;,                sizeof(&quot;CIF4&quot;)}, /* 7 */
<span class="lineNum">     394 </span>            :     {&quot;CIF16&quot;,               sizeof(&quot;CIF16&quot;)}, /* 8 */
<span class="lineNum">     395 </span>            :     {&quot;CUSTOM&quot;,              sizeof(&quot;CUSTOM&quot;)}, /* 9 */
<span class="lineNum">     396 </span>            :     {&quot;PAR&quot;,                 sizeof(&quot;PAR&quot;)}, /* 10 */
<span class="lineNum">     397 </span>            :     {&quot;CPCF&quot;,                sizeof(&quot;CPCF&quot;)}, /* 11 */
<span class="lineNum">     398 </span>            :     {&quot;BPP&quot;,                 sizeof(&quot;BPP&quot;)}, /* 12 */
<span class="lineNum">     399 </span>            :     {&quot;HRD&quot;,                 sizeof(&quot;HRD&quot;)}, /* 13 */
<span class="lineNum">     400 </span>            :     {&quot;PROFILE&quot;,             sizeof(&quot;PROFILE&quot;)}, /* 14 */
<span class="lineNum">     401 </span>            :     {&quot;LEVEL&quot;,               sizeof(&quot;LEVEL&quot;)}, /* 15 */
<span class="lineNum">     402 </span>            :     {&quot;INTERLACE&quot;,           sizeof(&quot;INTERLACE&quot;)}, /* 16 */
<span class="lineNum">     403 </span>            : 
<span class="lineNum">     404 </span>            :     /* H.264 related */
<span class="lineNum">     405 </span>            :     {&quot;profile-level-id&quot;,      sizeof(&quot;profile-level-id&quot;)}, /* 17 */
<span class="lineNum">     406 </span>            :     {&quot;sprop-parameter-sets&quot;,  sizeof(&quot;sprop-parameter-sets&quot;)}, /* 18 */
<span class="lineNum">     407 </span>            :     {&quot;packetization-mode&quot;,    sizeof(&quot;packetization-mode&quot;)}, /* 19 */
<span class="lineNum">     408 </span>            :     {&quot;sprop-interleaving-depth&quot;,    sizeof(&quot;sprop-interleaving-depth&quot;)}, /* 20 */
<span class="lineNum">     409 </span>            :     {&quot;sprop-deint-buf-req&quot;,   sizeof(&quot;sprop-deint-buf-req&quot;)}, /* 21 */
<span class="lineNum">     410 </span>            :     {&quot;sprop-max-don-diff&quot;,    sizeof(&quot;sprop-max-don-diff&quot;)}, /* 22 */
<span class="lineNum">     411 </span>            :     {&quot;sprop-init-buf-time&quot;,   sizeof(&quot;sprop-init-buf-time&quot;)}, /* 23 */
<span class="lineNum">     412 </span>            : 
<span class="lineNum">     413 </span>            :     {&quot;max-mbps&quot;,              sizeof(&quot;max-mbps&quot;)}, /* 24 */
<span class="lineNum">     414 </span>            :     {&quot;max-fs&quot;,                sizeof(&quot;max-fs&quot;)}, /* 25 */
<span class="lineNum">     415 </span>            :     {&quot;max-cpb&quot;,               sizeof(&quot;max-cpb&quot;)}, /* 26 */
<span class="lineNum">     416 </span>            :     {&quot;max-dpb&quot;,               sizeof(&quot;max-dpb&quot;)}, /* 27 */
<span class="lineNum">     417 </span>            :     {&quot;max-br&quot;,                sizeof(&quot;max-br&quot;)}, /* 28 */
<span class="lineNum">     418 </span>            :     {&quot;redundant-pic-cap&quot;,     sizeof(&quot;redundant-pic-cap&quot;)}, /* 29 */
<span class="lineNum">     419 </span>            :     {&quot;deint-buf-cap&quot;,         sizeof(&quot;deint-buf-cap&quot;)}, /* 30 */
<span class="lineNum">     420 </span>            :     {&quot;max-rcmd-nalu-size&quot;,    sizeof(&quot;max-rcmd_nali-size&quot;)}, /* 31 */
<span class="lineNum">     421 </span>            :     {&quot;parameter-add&quot;,         sizeof(&quot;parameter-add&quot;)}, /* 32 */
<span class="lineNum">     422 </span>            : 
<span class="lineNum">     423 </span>            :     /* Annexes - require special handling */
<span class="lineNum">     424 </span>            :      {&quot;D&quot;, sizeof(&quot;D&quot;)}, /* 33 */
<span class="lineNum">     425 </span>            :      {&quot;F&quot;, sizeof(&quot;F&quot;)}, /* 34 */
<span class="lineNum">     426 </span>            :      {&quot;I&quot;, sizeof(&quot;I&quot;)}, /* 35 */
<span class="lineNum">     427 </span>            :      {&quot;J&quot;, sizeof(&quot;J&quot;)}, /* 36 */
<span class="lineNum">     428 </span>            :      {&quot;T&quot;, sizeof(&quot;T&quot;)}, /* 37 */
<span class="lineNum">     429 </span>            :      {&quot;K&quot;, sizeof(&quot;K&quot;)}, /* 38 */
<span class="lineNum">     430 </span>            :      {&quot;N&quot;, sizeof(&quot;N&quot;)}, /* 39 */
<span class="lineNum">     431 </span>            :      {&quot;P&quot;, sizeof(&quot;P&quot;)}, /* 40 */
<span class="lineNum">     432 </span>            : 
<span class="lineNum">     433 </span>            :      {&quot;mode&quot;,                sizeof(&quot;mode&quot;)},  /* 41 */
<span class="lineNum">     434 </span>            :     {&quot;level-asymmetry-allowed&quot;,         sizeof(&quot;level-asymmetry-allowed&quot;)}, /* 42 */
<span class="lineNum">     435 </span>            :     {&quot;maxaveragebitrate&quot;,               sizeof(&quot;maxaveragebitrate&quot;)}, /* 43 */
<span class="lineNum">     436 </span>            :     {&quot;usedtx&quot;,                          sizeof(&quot;usedtx&quot;)}, /* 44 */
<span class="lineNum">     437 </span>            :     {&quot;stereo&quot;,                          sizeof(&quot;stereo&quot;)}, /* 45 */
<span class="lineNum">     438 </span>            :     {&quot;useinbandfec&quot;,                    sizeof(&quot;useinbandfec&quot;)}, /* 46 */
<span class="lineNum">     439 </span>            :     {&quot;maxcodedaudiobandwidth&quot;,          sizeof(&quot;maxcodedaudiobandwidth&quot;)}, /* 47 */
<span class="lineNum">     440 </span>            :     {&quot;cbr&quot;,                             sizeof(&quot;cbr&quot;)}, /* 48 */
<span class="lineNum">     441 </span>            :     {&quot;max-fr&quot;,                          sizeof(&quot;max-fr&quot;)}, /* 49 */
<span class="lineNum">     442 </span>            :     {&quot;maxplaybackrate&quot;,                 sizeof(&quot;maxplaybackrate&quot;)} /* 50 */
<span class="lineNum">     443 </span>            : } ;
<span class="lineNum">     444 </span>            : 
<span class="lineNum">     445 </span>            : /* Note: These *must* be in the same order as the enum type. */
<span class="lineNum">     446 </span>            : const sdp_namearray_t sdp_fmtp_codec_param_val[SDP_MAX_FMTP_PARAM_VAL] =
<span class="lineNum">     447 </span>            : {
<span class="lineNum">     448 </span>            :     {&quot;yes&quot;,                 sizeof(&quot;yes&quot;)},
<span class="lineNum">     449 </span>            :     {&quot;no&quot;,                  sizeof(&quot;no&quot;)}
<span class="lineNum">     450 </span>            : };
<span class="lineNum">     451 </span>            : 
<span class="lineNum">     452 </span>            : const sdp_namearray_t sdp_bw_modifier_val[SDP_MAX_BW_MODIFIER_VAL] =
<span class="lineNum">     453 </span>            : {
<span class="lineNum">     454 </span>            :     {&quot;AS&quot;,                  sizeof(&quot;AS&quot;)},
<span class="lineNum">     455 </span>            :     {&quot;CT&quot;,                  sizeof(&quot;CT&quot;)},
<span class="lineNum">     456 </span>            :     {&quot;TIAS&quot;,                sizeof(&quot;TIAS&quot;)}
<span class="lineNum">     457 </span>            : };
<span class="lineNum">     458 </span>            : 
<span class="lineNum">     459 </span>            : const sdp_namearray_t sdp_group_attr_val[SDP_MAX_GROUP_ATTR_VAL] =
<span class="lineNum">     460 </span>            : {
<span class="lineNum">     461 </span>            :     {&quot;FID&quot;,                 sizeof(&quot;FID&quot;)},
<span class="lineNum">     462 </span>            :     {&quot;LS&quot;,                  sizeof(&quot;LS&quot;)},
<span class="lineNum">     463 </span>            :     {&quot;ANAT&quot;,                sizeof(&quot;ANAT&quot;)},
<span class="lineNum">     464 </span>            :     {&quot;BUNDLE&quot;,              sizeof(&quot;BUNDLE&quot;)}
<span class="lineNum">     465 </span>            : };
<span class="lineNum">     466 </span>            : 
<span class="lineNum">     467 </span>            : const sdp_namearray_t sdp_srtp_context_crypto_suite[SDP_SRTP_MAX_NUM_CRYPTO_SUITES] =
<span class="lineNum">     468 </span>            : {
<span class="lineNum">     469 </span>            :   {&quot;UNKNOWN_CRYPTO_SUITE&quot;,    sizeof(&quot;UNKNOWN_CRYPTO_SUITE&quot;)},
<span class="lineNum">     470 </span>            :   {&quot;AES_CM_128_HMAC_SHA1_32&quot;, sizeof(&quot;AES_CM_128_HMAC_SHA1_32&quot;)},
<span class="lineNum">     471 </span>            :   {&quot;AES_CM_128_HMAC_SHA1_80&quot;, sizeof(&quot;AES_CM_128_HMAC_SHA1_80&quot;)},
<span class="lineNum">     472 </span>            :   {&quot;F8_128_HMAC_SHA1_80&quot;, sizeof(&quot;F8_128_HMAC_SHA1_80&quot;)}
<span class="lineNum">     473 </span>            : };
<span class="lineNum">     474 </span>            : 
<span class="lineNum">     475 </span>            : /* Maintain the same order as defined in typedef sdp_src_filter_mode_e */
<span class="lineNum">     476 </span>            : const sdp_namearray_t sdp_src_filter_mode_val[SDP_MAX_FILTER_MODE] =
<span class="lineNum">     477 </span>            : {
<span class="lineNum">     478 </span>            :     {&quot;incl&quot;, sizeof(&quot;incl&quot;)},
<span class="lineNum">     479 </span>            :     {&quot;excl&quot;, sizeof(&quot;excl&quot;)}
<span class="lineNum">     480 </span>            : };
<span class="lineNum">     481 </span>            : 
<span class="lineNum">     482 </span>            : /* Maintain the same order as defined in typdef sdp_rtcp_unicast_mode_e */
<span class="lineNum">     483 </span>            : const sdp_namearray_t sdp_rtcp_unicast_mode_val[SDP_RTCP_MAX_UNICAST_MODE] =
<span class="lineNum">     484 </span>            : {
<span class="lineNum">     485 </span>            :     {&quot;reflection&quot;, sizeof(&quot;reflection&quot;)},
<span class="lineNum">     486 </span>            :     {&quot;rsi&quot;,        sizeof(&quot;rsi&quot;)}
<span class="lineNum">     487 </span>            : };
<span class="lineNum">     488 </span>            : 
<span class="lineNum">     489 </span>            : #define SDP_NAME(x) {x, sizeof(x)}
<span class="lineNum">     490 </span>            : /* Maintain the same order as defined in typdef sdp_rtcp_fb_type_e */
<span class="lineNum">     491 </span>            : const sdp_namearray_t sdp_rtcp_fb_type_val[SDP_MAX_RTCP_FB] =
<span class="lineNum">     492 </span>            : {
<span class="lineNum">     493 </span>            :     SDP_NAME(&quot;ack&quot;),
<span class="lineNum">     494 </span>            :     SDP_NAME(&quot;ccm&quot;),
<span class="lineNum">     495 </span>            :     SDP_NAME(&quot;nack&quot;),
<span class="lineNum">     496 </span>            :     SDP_NAME(&quot;trr-int&quot;),
<span class="lineNum">     497 </span>            :     SDP_NAME(&quot;goog-remb&quot;)
<span class="lineNum">     498 </span>            : };
<span class="lineNum">     499 </span>            : 
<span class="lineNum">     500 </span>            : /* Maintain the same order as defined in typdef sdp_rtcp_fb_nack_type_e */
<span class="lineNum">     501 </span>            : const sdp_namearray_t sdp_rtcp_fb_nack_type_val[SDP_MAX_RTCP_FB_NACK] =
<span class="lineNum">     502 </span>            : {
<span class="lineNum">     503 </span>            :     SDP_NAME(&quot;&quot;),
<span class="lineNum">     504 </span>            :     SDP_NAME(&quot;sli&quot;),
<span class="lineNum">     505 </span>            :     SDP_NAME(&quot;pli&quot;),
<span class="lineNum">     506 </span>            :     SDP_NAME(&quot;rpsi&quot;),
<span class="lineNum">     507 </span>            :     SDP_NAME(&quot;app&quot;),
<span class="lineNum">     508 </span>            :     SDP_NAME(&quot;rai&quot;),
<span class="lineNum">     509 </span>            :     SDP_NAME(&quot;tllei&quot;),
<span class="lineNum">     510 </span>            :     SDP_NAME(&quot;pslei&quot;),
<span class="lineNum">     511 </span>            :     SDP_NAME(&quot;ecn&quot;)
<span class="lineNum">     512 </span>            : };
<span class="lineNum">     513 </span>            : 
<span class="lineNum">     514 </span>            : /* Maintain the same order as defined in typdef sdp_rtcp_fb_ack_type_e */
<span class="lineNum">     515 </span>            : const sdp_namearray_t sdp_rtcp_fb_ack_type_val[SDP_MAX_RTCP_FB_ACK] =
<span class="lineNum">     516 </span>            : {
<span class="lineNum">     517 </span>            :     SDP_NAME(&quot;rpsi&quot;),
<span class="lineNum">     518 </span>            :     SDP_NAME(&quot;app&quot;)
<span class="lineNum">     519 </span>            : };
<span class="lineNum">     520 </span>            : 
<span class="lineNum">     521 </span>            : /* Maintain the same order as defined in typdef sdp_rtcp_fb_ccm_type_e */
<span class="lineNum">     522 </span>            : const sdp_namearray_t sdp_rtcp_fb_ccm_type_val[SDP_MAX_RTCP_FB_CCM] =
<span class="lineNum">     523 </span>            : {
<span class="lineNum">     524 </span>            :     SDP_NAME(&quot;fir&quot;),
<span class="lineNum">     525 </span>            :     SDP_NAME(&quot;tmmbr&quot;),
<span class="lineNum">     526 </span>            :     SDP_NAME(&quot;tstr&quot;),
<span class="lineNum">     527 </span>            :     SDP_NAME(&quot;vbcm&quot;)
<span class="lineNum">     528 </span>            : };
<span class="lineNum">     529 </span>            : 
<span class="lineNum">     530 </span>            : /* Maintain the same order as defined in typedef sdp_setup_type_e */
<span class="lineNum">     531 </span>            : const sdp_namearray_t sdp_setup_type_val[SDP_MAX_SETUP] =
<span class="lineNum">     532 </span>            : {
<span class="lineNum">     533 </span>            :     SDP_NAME(&quot;active&quot;),
<span class="lineNum">     534 </span>            :     SDP_NAME(&quot;passive&quot;),
<span class="lineNum">     535 </span>            :     SDP_NAME(&quot;actpass&quot;),
<span class="lineNum">     536 </span>            :     SDP_NAME(&quot;holdconn&quot;)
<span class="lineNum">     537 </span>            : };
<span class="lineNum">     538 </span>            : 
<span class="lineNum">     539 </span>            : /* Maintain the same order as defined in typedef sdp_connection_type_e */
<span class="lineNum">     540 </span>            : const sdp_namearray_t sdp_connection_type_val[SDP_MAX_CONNECTION] =
<span class="lineNum">     541 </span>            : {
<span class="lineNum">     542 </span>            :     SDP_NAME(&quot;new&quot;),
<span class="lineNum">     543 </span>            :     SDP_NAME(&quot;existing&quot;)
<span class="lineNum">     544 </span>            : };
<span class="lineNum">     545 </span>            : 
<span class="lineNum">     546 </span>            : /*  Maintain same order as defined in typedef sdp_srtp_crypto_suite_t */
<span class="lineNum">     547 </span>            : const sdp_srtp_crypto_suite_list sdp_srtp_crypto_suite_array[SDP_SRTP_MAX_NUM_CRYPTO_SUITES] =
<span class="lineNum">     548 </span>            : {
<span class="lineNum">     549 </span>            :   {SDP_SRTP_UNKNOWN_CRYPTO_SUITE, UNKNOWN_CRYPTO_SUITE, 0, 0},
<span class="lineNum">     550 </span>            :   {SDP_SRTP_AES_CM_128_HMAC_SHA1_32, AES_CM_128_HMAC_SHA1_32,
<span class="lineNum">     551 </span>            :       SDP_SRTP_AES_CM_128_HMAC_SHA1_32_KEY_BYTES,
<span class="lineNum">     552 </span>            :       SDP_SRTP_AES_CM_128_HMAC_SHA1_32_SALT_BYTES},
<span class="lineNum">     553 </span>            :   {SDP_SRTP_AES_CM_128_HMAC_SHA1_80, AES_CM_128_HMAC_SHA1_80,
<span class="lineNum">     554 </span>            :       SDP_SRTP_AES_CM_128_HMAC_SHA1_80_KEY_BYTES,
<span class="lineNum">     555 </span>            :       SDP_SRTP_AES_CM_128_HMAC_SHA1_80_SALT_BYTES},
<span class="lineNum">     556 </span>            :   {SDP_SRTP_F8_128_HMAC_SHA1_80, F8_128_HMAC_SHA1_80,
<span class="lineNum">     557 </span>            :       SDP_SRTP_F8_128_HMAC_SHA1_80_KEY_BYTES,
<span class="lineNum">     558 </span>            :       SDP_SRTP_F8_128_HMAC_SHA1_80_SALT_BYTES}
<span class="lineNum">     559 </span>            : };
<span class="lineNum">     560 </span>            : 
<span class="lineNum">     561 </span>            : const char* sdp_result_name[SDP_MAX_RC] =
<span class="lineNum">     562 </span>            :     {&quot;SDP_SUCCESS&quot;,
<span class="lineNum">     563 </span>            :      &quot;SDP_FAILURE&quot;,
<span class="lineNum">     564 </span>            :      &quot;SDP_INVALID_SDP_PTR&quot;,
<span class="lineNum">     565 </span>            :      &quot;SDP_NOT_SDP_DESCRIPTION&quot;,
<span class="lineNum">     566 </span>            :      &quot;SDP_INVALID_TOKEN_ORDERING&quot;,
<span class="lineNum">     567 </span>            :      &quot;SDP_INVALID_PARAMETER&quot;,
<span class="lineNum">     568 </span>            :      &quot;SDP_INVALID_MEDIA_LEVEL&quot;,
<span class="lineNum">     569 </span>            :      &quot;SDP_INVALID_CAPABILITY&quot;,
<span class="lineNum">     570 </span>            :      &quot;SDP_NO_RESOURCE&quot;,
<span class="lineNum">     571 </span>            :      &quot;SDP_UNRECOGNIZED_TOKEN&quot;,
<span class="lineNum">     572 </span>            :      &quot;SDP_NULL_BUF_PTR&quot;,
<span class="lineNum">     573 </span>            :      &quot;SDP_POTENTIAL_SDP_OVERFLOW&quot;,
<a name="574"><span class="lineNum">     574 </span>            :      &quot;SDP_EMPTY_TOKEN&quot;};</a>
<span class="lineNum">     575 </span>            : 
<span class="lineNum">     576 </span><span class="lineNoCov">          0 : const char *sdp_get_result_name ( sdp_result_e rc )</span>
<span class="lineNum">     577 </span>            : {
<span class="lineNum">     578 </span><span class="lineNoCov">          0 :     if (rc &gt;= SDP_MAX_RC) {</span>
<span class="lineNum">     579 </span><span class="lineNoCov">          0 :         return (&quot;Invalid SDP result code&quot;);</span>
<span class="lineNum">     580 </span>            :     } else {
<span class="lineNum">     581 </span><span class="lineNoCov">          0 :         return (sdp_result_name[rc]);</span>
<span class="lineNum">     582 </span>            :     }
<a name="583"><span class="lineNum">     583 </span>            : }</a>
<span class="lineNum">     584 </span>            : 
<span class="lineNum">     585 </span><span class="lineNoCov">          0 : const char *sdp_get_attr_name ( sdp_attr_e attr_type )</span>
<span class="lineNum">     586 </span>            : {
<span class="lineNum">     587 </span><span class="lineNoCov">          0 :     if (attr_type &gt;= SDP_MAX_ATTR_TYPES) {</span>
<span class="lineNum">     588 </span><span class="lineNoCov">          0 :         return (&quot;Invalid attribute type&quot;);</span>
<span class="lineNum">     589 </span>            :     } else {
<span class="lineNum">     590 </span><span class="lineNoCov">          0 :         return (sdp_attr[attr_type].name);</span>
<span class="lineNum">     591 </span>            :     }
<a name="592"><span class="lineNum">     592 </span>            : }</a>
<span class="lineNum">     593 </span>            : 
<span class="lineNum">     594 </span><span class="lineNoCov">          0 : const char *sdp_get_media_name ( sdp_media_e media_type )</span>
<span class="lineNum">     595 </span>            : {
<span class="lineNum">     596 </span><span class="lineNoCov">          0 :     if (media_type == SDP_MEDIA_UNSUPPORTED) {</span>
<span class="lineNum">     597 </span><span class="lineNoCov">          0 :         return (SDP_UNSUPPORTED);</span>
<span class="lineNum">     598 </span><span class="lineNoCov">          0 :     } else if (media_type &gt;= SDP_MAX_MEDIA_TYPES) {</span>
<span class="lineNum">     599 </span><span class="lineNoCov">          0 :         return (&quot;Invalid media type&quot;);</span>
<span class="lineNum">     600 </span>            :     } else {
<span class="lineNum">     601 </span><span class="lineNoCov">          0 :         return (sdp_media[media_type].name);</span>
<span class="lineNum">     602 </span>            :     }
<a name="603"><span class="lineNum">     603 </span>            : }</a>
<span class="lineNum">     604 </span>            : 
<span class="lineNum">     605 </span><span class="lineNoCov">          0 : const char *sdp_get_network_name ( sdp_nettype_e network_type )</span>
<span class="lineNum">     606 </span>            : {
<span class="lineNum">     607 </span><span class="lineNoCov">          0 :     if (network_type == SDP_NT_UNSUPPORTED) {</span>
<span class="lineNum">     608 </span><span class="lineNoCov">          0 :         return (SDP_UNSUPPORTED);</span>
<span class="lineNum">     609 </span><span class="lineNoCov">          0 :     } else if (network_type &gt;= SDP_MAX_NETWORK_TYPES) {</span>
<span class="lineNum">     610 </span><span class="lineNoCov">          0 :         return (&quot;Invalid network type&quot;);</span>
<span class="lineNum">     611 </span>            :     } else {
<span class="lineNum">     612 </span><span class="lineNoCov">          0 :         return (sdp_nettype[network_type].name);</span>
<span class="lineNum">     613 </span>            :     }
<a name="614"><span class="lineNum">     614 </span>            : }</a>
<span class="lineNum">     615 </span>            : 
<span class="lineNum">     616 </span><span class="lineNoCov">          0 : const char *sdp_get_address_name ( sdp_addrtype_e addr_type )</span>
<span class="lineNum">     617 </span>            : {
<span class="lineNum">     618 </span><span class="lineNoCov">          0 :     if (addr_type == SDP_AT_UNSUPPORTED) {</span>
<span class="lineNum">     619 </span><span class="lineNoCov">          0 :         return (SDP_UNSUPPORTED);</span>
<span class="lineNum">     620 </span><span class="lineNoCov">          0 :     } else if (addr_type &gt;= SDP_MAX_ADDR_TYPES) {</span>
<span class="lineNum">     621 </span><span class="lineNoCov">          0 :         if (addr_type == SDP_AT_FQDN) {</span>
<span class="lineNum">     622 </span><span class="lineNoCov">          0 :             return (&quot;*&quot;);</span>
<span class="lineNum">     623 </span>            :         } else {
<span class="lineNum">     624 </span><span class="lineNoCov">          0 :             return (&quot;Invalid address type&quot;);</span>
<span class="lineNum">     625 </span>            :         }
<span class="lineNum">     626 </span>            :     } else {
<span class="lineNum">     627 </span><span class="lineNoCov">          0 :         return (sdp_addrtype[addr_type].name);</span>
<span class="lineNum">     628 </span>            :     }
<a name="629"><span class="lineNum">     629 </span>            : }</a>
<span class="lineNum">     630 </span>            : 
<span class="lineNum">     631 </span><span class="lineNoCov">          0 : const char *sdp_get_transport_name ( sdp_transport_e transport_type )</span>
<span class="lineNum">     632 </span>            : {
<span class="lineNum">     633 </span><span class="lineNoCov">          0 :     if (transport_type == SDP_TRANSPORT_UNSUPPORTED) {</span>
<span class="lineNum">     634 </span><span class="lineNoCov">          0 :         return (SDP_UNSUPPORTED);</span>
<span class="lineNum">     635 </span><span class="lineNoCov">          0 :     } else if (transport_type &gt;= SDP_MAX_TRANSPORT_TYPES) {</span>
<span class="lineNum">     636 </span><span class="lineNoCov">          0 :         return (&quot;Invalid transport type&quot;);</span>
<span class="lineNum">     637 </span>            :     } else {
<span class="lineNum">     638 </span><span class="lineNoCov">          0 :         return (sdp_transport[transport_type].name);</span>
<span class="lineNum">     639 </span>            :     }
<a name="640"><span class="lineNum">     640 </span>            : }</a>
<span class="lineNum">     641 </span>            : 
<span class="lineNum">     642 </span><span class="lineNoCov">          0 : const char *sdp_get_encrypt_name ( sdp_encrypt_type_e encrypt_type )</span>
<span class="lineNum">     643 </span>            : {
<span class="lineNum">     644 </span><span class="lineNoCov">          0 :     if (encrypt_type == SDP_ENCRYPT_UNSUPPORTED) {</span>
<span class="lineNum">     645 </span><span class="lineNoCov">          0 :         return (SDP_UNSUPPORTED);</span>
<span class="lineNum">     646 </span><span class="lineNoCov">          0 :     } else if (encrypt_type &gt;= SDP_MAX_ENCRYPT_TYPES) {</span>
<span class="lineNum">     647 </span><span class="lineNoCov">          0 :         return (&quot;Invalid encryption type&quot;);</span>
<span class="lineNum">     648 </span>            :     } else {
<span class="lineNum">     649 </span><span class="lineNoCov">          0 :         return (sdp_encrypt[encrypt_type].name);</span>
<span class="lineNum">     650 </span>            :     }
<a name="651"><span class="lineNum">     651 </span>            : }</a>
<span class="lineNum">     652 </span>            : 
<span class="lineNum">     653 </span><span class="lineNoCov">          0 : const char *sdp_get_payload_name ( sdp_payload_e payload )</span>
<span class="lineNum">     654 </span>            : {
<span class="lineNum">     655 </span><span class="lineNoCov">          0 :     if (payload == SDP_PAYLOAD_UNSUPPORTED) {</span>
<span class="lineNum">     656 </span><span class="lineNoCov">          0 :         return (SDP_UNSUPPORTED);</span>
<span class="lineNum">     657 </span><span class="lineNoCov">          0 :     } else if (payload &gt;= SDP_MAX_STRING_PAYLOAD_TYPES) {</span>
<span class="lineNum">     658 </span><span class="lineNoCov">          0 :         return (&quot;Invalid payload type&quot;);</span>
<span class="lineNum">     659 </span>            :     } else {
<span class="lineNum">     660 </span><span class="lineNoCov">          0 :         return (sdp_payload[payload].name);</span>
<span class="lineNum">     661 </span>            :     }
<a name="662"><span class="lineNum">     662 </span>            : }</a>
<span class="lineNum">     663 </span>            : 
<span class="lineNum">     664 </span><span class="lineNoCov">          0 : const char *sdp_get_t38_ratemgmt_name ( sdp_t38_ratemgmt_e rate )</span>
<span class="lineNum">     665 </span>            : {
<span class="lineNum">     666 </span><span class="lineNoCov">          0 :     if (rate &gt;= SDP_T38_MAX_RATES) {</span>
<span class="lineNum">     667 </span><span class="lineNoCov">          0 :         return (&quot;Invalid rate&quot;);</span>
<span class="lineNum">     668 </span>            :     } else {
<span class="lineNum">     669 </span><span class="lineNoCov">          0 :         return (sdp_t38_rate[rate].name);</span>
<span class="lineNum">     670 </span>            :     }
<a name="671"><span class="lineNum">     671 </span>            : }</a>
<span class="lineNum">     672 </span>            : 
<span class="lineNum">     673 </span><span class="lineNoCov">          0 : const char *sdp_get_t38_udpec_name ( sdp_t38_udpec_e udpec )</span>
<span class="lineNum">     674 </span>            : {
<span class="lineNum">     675 </span><span class="lineNoCov">          0 :     if (udpec &gt;= SDP_T38_MAX_UDPEC) {</span>
<span class="lineNum">     676 </span><span class="lineNoCov">          0 :         return (&quot;Invalid udpec&quot;);</span>
<span class="lineNum">     677 </span>            :     } else {
<span class="lineNum">     678 </span><span class="lineNoCov">          0 :         return (sdp_t38_udpec[udpec].name);</span>
<span class="lineNum">     679 </span>            :     }
<a name="680"><span class="lineNum">     680 </span>            : }</a>
<span class="lineNum">     681 </span>            : 
<span class="lineNum">     682 </span><span class="lineNoCov">          0 : const char *sdp_get_qos_strength_name ( sdp_qos_strength_e strength )</span>
<span class="lineNum">     683 </span>            : {
<span class="lineNum">     684 </span><span class="lineNoCov">          0 :     if (strength &gt;= SDP_MAX_QOS_STRENGTH) {</span>
<span class="lineNum">     685 </span><span class="lineNoCov">          0 :         return (&quot;Invalid qos strength&quot;);</span>
<span class="lineNum">     686 </span>            :     } else {
<span class="lineNum">     687 </span><span class="lineNoCov">          0 :         return (sdp_qos_strength[strength].name);</span>
<span class="lineNum">     688 </span>            :     }
<a name="689"><span class="lineNum">     689 </span>            : }</a>
<span class="lineNum">     690 </span>            : 
<span class="lineNum">     691 </span><span class="lineNoCov">          0 : const char *sdp_get_qos_direction_name ( sdp_qos_dir_e direction )</span>
<span class="lineNum">     692 </span>            : {
<span class="lineNum">     693 </span><span class="lineNoCov">          0 :     if (direction &gt;= SDP_MAX_QOS_DIR) {</span>
<span class="lineNum">     694 </span><span class="lineNoCov">          0 :         return (&quot;Invalid qos direction&quot;);</span>
<span class="lineNum">     695 </span>            :     } else {
<span class="lineNum">     696 </span><span class="lineNoCov">          0 :         return (sdp_qos_direction[direction].name);</span>
<span class="lineNum">     697 </span>            :     }
<a name="698"><span class="lineNum">     698 </span>            : }</a>
<span class="lineNum">     699 </span>            : 
<span class="lineNum">     700 </span><span class="lineNoCov">          0 : const char *sdp_get_qos_status_type_name ( sdp_qos_status_types_e status_type )</span>
<span class="lineNum">     701 </span>            : {
<span class="lineNum">     702 </span><span class="lineNoCov">          0 :     if (status_type &gt;= SDP_MAX_QOS_STATUS_TYPES) {</span>
<span class="lineNum">     703 </span><span class="lineNoCov">          0 :         return (&quot;Invalid qos status type&quot;);</span>
<span class="lineNum">     704 </span>            :     } else {
<span class="lineNum">     705 </span><span class="lineNoCov">          0 :         return (sdp_qos_status_type[status_type].name);</span>
<span class="lineNum">     706 </span>            :     }
<a name="707"><span class="lineNum">     707 </span>            : }</a>
<span class="lineNum">     708 </span>            : 
<span class="lineNum">     709 </span><span class="lineNoCov">          0 : const char *sdp_get_curr_type_name (sdp_curr_type_e curr_type )</span>
<span class="lineNum">     710 </span>            : {
<span class="lineNum">     711 </span><span class="lineNoCov">          0 :     if (curr_type &gt;= SDP_MAX_CURR_TYPES) {</span>
<span class="lineNum">     712 </span><span class="lineNoCov">          0 :         return (&quot;Invalid curr type&quot;);</span>
<span class="lineNum">     713 </span>            :     } else {
<span class="lineNum">     714 </span><span class="lineNoCov">          0 :         return (sdp_curr_type[curr_type].name);</span>
<span class="lineNum">     715 </span>            :     }
<a name="716"><span class="lineNum">     716 </span>            : }</a>
<span class="lineNum">     717 </span>            : 
<span class="lineNum">     718 </span><span class="lineNoCov">          0 : const char *sdp_get_des_type_name (sdp_des_type_e des_type )</span>
<span class="lineNum">     719 </span>            : {
<span class="lineNum">     720 </span><span class="lineNoCov">          0 :     if (des_type &gt;= SDP_MAX_DES_TYPES) {</span>
<span class="lineNum">     721 </span><span class="lineNoCov">          0 :         return (&quot;Invalid des type&quot;);</span>
<span class="lineNum">     722 </span>            :     } else {
<span class="lineNum">     723 </span><span class="lineNoCov">          0 :         return (sdp_des_type[des_type].name);</span>
<span class="lineNum">     724 </span>            :     }
<a name="725"><span class="lineNum">     725 </span>            : }</a>
<span class="lineNum">     726 </span>            : 
<span class="lineNum">     727 </span><span class="lineNoCov">          0 : const char *sdp_get_conf_type_name (sdp_conf_type_e conf_type )</span>
<span class="lineNum">     728 </span>            : {
<span class="lineNum">     729 </span><span class="lineNoCov">          0 :     if (conf_type &gt;= SDP_MAX_CONF_TYPES) {</span>
<span class="lineNum">     730 </span><span class="lineNoCov">          0 :         return (&quot;Invalid conf type&quot;);</span>
<span class="lineNum">     731 </span>            :     } else {
<span class="lineNum">     732 </span><span class="lineNoCov">          0 :         return (sdp_conf_type[conf_type].name);</span>
<span class="lineNum">     733 </span>            :     }
<a name="734"><span class="lineNum">     734 </span>            : }</a>
<span class="lineNum">     735 </span>            : 
<span class="lineNum">     736 </span><span class="lineNoCov">          0 : const char *sdp_get_silencesupp_pref_name (sdp_silencesupp_pref_e pref)</span>
<span class="lineNum">     737 </span>            : {
<span class="lineNum">     738 </span><span class="lineNoCov">          0 :     if (pref &gt;= SDP_MAX_SILENCESUPP_PREF) {</span>
<span class="lineNum">     739 </span><span class="lineNoCov">          0 :         return (&quot;Invalid silencesupp pref&quot;);</span>
<span class="lineNum">     740 </span>            :     } else {
<span class="lineNum">     741 </span><span class="lineNoCov">          0 :         return (sdp_silencesupp_pref[pref].name);</span>
<span class="lineNum">     742 </span>            :     }
<a name="743"><span class="lineNum">     743 </span>            : }</a>
<span class="lineNum">     744 </span>            : 
<span class="lineNum">     745 </span><span class="lineNoCov">          0 : const char *sdp_get_silencesupp_siduse_name (sdp_silencesupp_siduse_e siduse)</span>
<span class="lineNum">     746 </span>            : {
<span class="lineNum">     747 </span><span class="lineNoCov">          0 :     if (siduse &gt;= SDP_MAX_SILENCESUPP_SIDUSE) {</span>
<span class="lineNum">     748 </span><span class="lineNoCov">          0 :         return (&quot;Invalid silencesupp siduse&quot;);</span>
<span class="lineNum">     749 </span>            :     } else {
<span class="lineNum">     750 </span><span class="lineNoCov">          0 :         return (sdp_silencesupp_siduse[siduse].name);</span>
<span class="lineNum">     751 </span>            :     }
<a name="752"><span class="lineNum">     752 </span>            : }</a>
<span class="lineNum">     753 </span>            : 
<span class="lineNum">     754 </span><span class="lineNoCov">          0 : const char *sdp_get_mediadir_role_name (sdp_mediadir_role_e role)</span>
<span class="lineNum">     755 </span>            : {
<span class="lineNum">     756 </span><span class="lineNoCov">          0 :     if (role &gt;= SDP_MEDIADIR_ROLE_UNKNOWN) {</span>
<span class="lineNum">     757 </span><span class="lineNoCov">          0 :         return (&quot;Invalid media direction role&quot;);</span>
<span class="lineNum">     758 </span>            :     } else {
<span class="lineNum">     759 </span><span class="lineNoCov">          0 :         return (sdp_mediadir_role[role].name);</span>
<span class="lineNum">     760 </span>            :     }
<span class="lineNum">     761 </span>            : }
<a name="762"><span class="lineNum">     762 </span>            : </a>
<span class="lineNum">     763 </span>            : 
<span class="lineNum">     764 </span><span class="lineNoCov">          0 : const char *sdp_get_bw_modifier_name (sdp_bw_modifier_e bw_modifier_type)</span>
<span class="lineNum">     765 </span>            : {
<span class="lineNum">     766 </span><span class="lineNoCov">          0 :     if (bw_modifier_type == SDP_BW_MODIFIER_UNSUPPORTED) {</span>
<span class="lineNum">     767 </span><span class="lineNoCov">          0 :         return (SDP_UNSUPPORTED);</span>
<span class="lineNum">     768 </span><span class="lineNoCov">          0 :     } else if (bw_modifier_type &lt; SDP_BW_MODIFIER_AS ||</span>
<span class="lineNum">     769 </span>            :             bw_modifier_type &gt;= SDP_MAX_BW_MODIFIER_VAL) {
<span class="lineNum">     770 </span><span class="lineNoCov">          0 :         return (&quot;Invalid bw modifier type&quot;);</span>
<span class="lineNum">     771 </span>            :     } else {
<span class="lineNum">     772 </span><span class="lineNoCov">          0 :         return (sdp_bw_modifier_val[bw_modifier_type].name);</span>
<span class="lineNum">     773 </span>            :     }
<a name="774"><span class="lineNum">     774 </span>            : }</a>
<span class="lineNum">     775 </span>            : 
<span class="lineNum">     776 </span><span class="lineNoCov">          0 : const char *sdp_get_group_attr_name (sdp_group_attr_e group_attr_type)</span>
<span class="lineNum">     777 </span>            : {
<span class="lineNum">     778 </span><span class="lineNoCov">          0 :     if (group_attr_type == SDP_GROUP_ATTR_UNSUPPORTED) {</span>
<span class="lineNum">     779 </span><span class="lineNoCov">          0 :         return (SDP_UNSUPPORTED);</span>
<span class="lineNum">     780 </span><span class="lineNoCov">          0 :     } else if (group_attr_type &gt;= SDP_MAX_GROUP_ATTR_VAL) {</span>
<span class="lineNum">     781 </span><span class="lineNoCov">          0 :         return (&quot;Invalid a=group: attribute type&quot;);</span>
<span class="lineNum">     782 </span>            :     } else {
<span class="lineNum">     783 </span><span class="lineNoCov">          0 :         return (sdp_group_attr_val[group_attr_type].name);</span>
<span class="lineNum">     784 </span>            :     }
<a name="785"><span class="lineNum">     785 </span>            : }</a>
<span class="lineNum">     786 </span>            : 
<span class="lineNum">     787 </span><span class="lineNoCov">          0 : const char *sdp_get_src_filter_mode_name (sdp_src_filter_mode_e type)</span>
<span class="lineNum">     788 </span>            : {
<span class="lineNum">     789 </span><span class="lineNoCov">          0 :     if (type &gt;= SDP_MAX_FILTER_MODE) {</span>
<span class="lineNum">     790 </span><span class="lineNoCov">          0 :         return (&quot;Invalid source filter mode&quot;);</span>
<span class="lineNum">     791 </span>            :     } else {
<span class="lineNum">     792 </span><span class="lineNoCov">          0 :         return (sdp_src_filter_mode_val[type].name);</span>
<span class="lineNum">     793 </span>            :     }
<a name="794"><span class="lineNum">     794 </span>            : }</a>
<span class="lineNum">     795 </span>            : 
<span class="lineNum">     796 </span><span class="lineNoCov">          0 : const char *sdp_get_rtcp_unicast_mode_name (sdp_rtcp_unicast_mode_e type)</span>
<span class="lineNum">     797 </span>            : {
<span class="lineNum">     798 </span><span class="lineNoCov">          0 :     if (type &gt;= SDP_RTCP_MAX_UNICAST_MODE) {</span>
<span class="lineNum">     799 </span><span class="lineNoCov">          0 :         return (&quot;Invalid rtcp unicast mode&quot;);</span>
<span class="lineNum">     800 </span>            :     } else {
<span class="lineNum">     801 </span><span class="lineNoCov">          0 :         return (sdp_rtcp_unicast_mode_val[type].name);</span>
<span class="lineNum">     802 </span>            :     }
<span class="lineNum">     803 </span>            : }
<span class="lineNum">     804 </span>            : 
<span class="lineNum">     805 </span>            : /* Function:    sdp_init_description
<span class="lineNum">     806 </span>            :  * Description: Allocates a new SDP structure that can be used for either
<span class="lineNum">     807 </span>            :  *              parsing or building an SDP description.  This routine
<span class="lineNum">     808 </span>            :  *              saves the config pointer passed in the SDP structure so
<span class="lineNum">     809 </span>            :  *              SDP will know how to parse/build based on the options defined.
<span class="lineNum">     810 </span>            :  *              An SDP structure must be allocated before parsing or building
<span class="lineNum">     811 </span>            :  *              since the handle must be passed to these routines.
<span class="lineNum">     812 </span>            :  * Parameters:  config_p     The config handle returned by sdp_init_config
<a name="813"><span class="lineNum">     813 </span>            :  * Returns:     A handle for a new SDP structure as a void ptr.</a>
<span class="lineNum">     814 </span>            : */
<span class="lineNum">     815 </span><span class="lineNoCov">          0 : sdp_t *sdp_init_description (sdp_conf_options_t *conf_p)</span>
<span class="lineNum">     816 </span>            : {
<span class="lineNum">     817 </span>            :     int i;
<span class="lineNum">     818 </span>            :     sdp_t *sdp_p;
<span class="lineNum">     819 </span>            : 
<span class="lineNum">     820 </span><span class="lineNoCov">          0 :     if (!conf_p) {</span>
<span class="lineNum">     821 </span><span class="lineNoCov">          0 :         return (NULL);</span>
<span class="lineNum">     822 </span>            :     }
<span class="lineNum">     823 </span>            : 
<span class="lineNum">     824 </span><span class="lineNoCov">          0 :     sdp_p = (sdp_t *)SDP_MALLOC(sizeof(sdp_t));</span>
<span class="lineNum">     825 </span><span class="lineNoCov">          0 :     if (sdp_p == NULL) {</span>
<span class="lineNum">     826 </span><span class="lineNoCov">          0 :         return (NULL);</span>
<span class="lineNum">     827 </span>            :     }
<span class="lineNum">     828 </span>            : 
<span class="lineNum">     829 </span><span class="lineNoCov">          0 :     sdp_p-&gt;conf_p             = conf_p;</span>
<span class="lineNum">     830 </span><span class="lineNoCov">          0 :     sdp_p-&gt;version            = SDP_CURRENT_VERSION;</span>
<span class="lineNum">     831 </span><span class="lineNoCov">          0 :     sdp_p-&gt;owner_name[0]      = '\0';</span>
<span class="lineNum">     832 </span><span class="lineNoCov">          0 :     sdp_p-&gt;owner_sessid[0]    = '\0';</span>
<span class="lineNum">     833 </span><span class="lineNoCov">          0 :     sdp_p-&gt;owner_version[0]   = '\0';</span>
<span class="lineNum">     834 </span><span class="lineNoCov">          0 :     sdp_p-&gt;owner_network_type = SDP_NT_INVALID;</span>
<span class="lineNum">     835 </span><span class="lineNoCov">          0 :     sdp_p-&gt;owner_addr_type    = SDP_AT_INVALID;</span>
<span class="lineNum">     836 </span><span class="lineNoCov">          0 :     sdp_p-&gt;owner_addr[0]      = '\0';</span>
<span class="lineNum">     837 </span><span class="lineNoCov">          0 :     sdp_p-&gt;sessname[0]        = '\0';</span>
<span class="lineNum">     838 </span><span class="lineNoCov">          0 :     sdp_p-&gt;sessinfo_found     = FALSE;</span>
<span class="lineNum">     839 </span><span class="lineNoCov">          0 :     sdp_p-&gt;uri_found          = FALSE;</span>
<span class="lineNum">     840 </span>            : 
<span class="lineNum">     841 </span><span class="lineNoCov">          0 :     sdp_p-&gt;default_conn.nettype      = SDP_NT_INVALID;</span>
<span class="lineNum">     842 </span><span class="lineNoCov">          0 :     sdp_p-&gt;default_conn.addrtype     = SDP_AT_INVALID;</span>
<span class="lineNum">     843 </span><span class="lineNoCov">          0 :     sdp_p-&gt;default_conn.conn_addr[0] = '\0';</span>
<span class="lineNum">     844 </span><span class="lineNoCov">          0 :     sdp_p-&gt;default_conn.is_multicast = FALSE;</span>
<span class="lineNum">     845 </span><span class="lineNoCov">          0 :     sdp_p-&gt;default_conn.ttl          = 0;</span>
<span class="lineNum">     846 </span><span class="lineNoCov">          0 :     sdp_p-&gt;default_conn.num_of_addresses = 0;</span>
<span class="lineNum">     847 </span>            : 
<span class="lineNum">     848 </span><span class="lineNoCov">          0 :     sdp_p-&gt;bw.bw_data_count   = 0;</span>
<span class="lineNum">     849 </span><span class="lineNoCov">          0 :     sdp_p-&gt;bw.bw_data_list    = NULL;</span>
<span class="lineNum">     850 </span>            : 
<span class="lineNum">     851 </span><span class="lineNoCov">          0 :     sdp_p-&gt;timespec_p         = NULL;</span>
<span class="lineNum">     852 </span><span class="lineNoCov">          0 :     sdp_p-&gt;sess_attrs_p       = NULL;</span>
<span class="lineNum">     853 </span><span class="lineNoCov">          0 :     sdp_p-&gt;mca_p              = NULL;</span>
<span class="lineNum">     854 </span><span class="lineNoCov">          0 :     sdp_p-&gt;mca_count          = 0;</span>
<span class="lineNum">     855 </span>            : 
<span class="lineNum">     856 </span>            :     /* Set default debug flags from application config. */
<span class="lineNum">     857 </span><span class="lineNoCov">          0 :     for (i=0; i &lt; SDP_MAX_DEBUG_TYPES; i++) {</span>
<span class="lineNum">     858 </span><span class="lineNoCov">          0 :         sdp_p-&gt;debug_flag[i] = conf_p-&gt;debug_flag[i];</span>
<span class="lineNum">     859 </span>            :     }
<span class="lineNum">     860 </span>            : 
<span class="lineNum">     861 </span><span class="lineNoCov">          0 :     return (sdp_p);</span>
<span class="lineNum">     862 </span>            : }
<span class="lineNum">     863 </span>            : 
<span class="lineNum">     864 </span>            : 
<span class="lineNum">     865 </span>            : /* Function:    void sdp_debug(sdp_t *sdp_p, sdp_debug_e debug_type,
<span class="lineNum">     866 </span>            :  *                             tinybool my_bool);
<span class="lineNum">     867 </span>            :  * Description: Define the type of debug for this particular SDP structure.
<span class="lineNum">     868 </span>            :  *              By default, each SDP description has the settings that are
<span class="lineNum">     869 </span>            :  *              set for the application.
<span class="lineNum">     870 </span>            :  *              Valid debug types are ERRORS, WARNINGS, and TRACE.  Each
<span class="lineNum">     871 </span>            :  *              debug type can be turned on/off individually.  The
<span class="lineNum">     872 </span>            :  *              debug level can be redefined at any time.
<span class="lineNum">     873 </span>            :  * Parameters:  sdp_ptr    The SDP handle returned by sdp_init_description.
<span class="lineNum">     874 </span>            :  *              debug_type Specifies the debug type being enabled/disabled.
<span class="lineNum">     875 </span>            :  *              my_bool    Defines whether the debug should be enabled or not.
<a name="876"><span class="lineNum">     876 </span>            :  * Returns:     Nothing.</a>
<span class="lineNum">     877 </span>            :  */
<span class="lineNum">     878 </span><span class="lineNoCov">          0 : void sdp_debug (sdp_t *sdp_p, sdp_debug_e debug_type, tinybool debug_flag)</span>
<span class="lineNum">     879 </span>            : {
<span class="lineNum">     880 </span><span class="lineNoCov">          0 :     if (!sdp_p) {</span>
<span class="lineNum">     881 </span><span class="lineNoCov">          0 :         return;</span>
<span class="lineNum">     882 </span>            :     }
<span class="lineNum">     883 </span>            : 
<span class="lineNum">     884 </span><span class="lineNoCov">          0 :     if (debug_type &lt; SDP_MAX_DEBUG_TYPES)  {</span>
<span class="lineNum">     885 </span><span class="lineNoCov">          0 :         sdp_p-&gt;debug_flag[debug_type] = debug_flag;</span>
<span class="lineNum">     886 </span>            :     }
<span class="lineNum">     887 </span>            : }
<span class="lineNum">     888 </span>            : 
<span class="lineNum">     889 </span>            : 
<span class="lineNum">     890 </span>            : /* Function:    void sdp_set_string_debug(sdp_t *sdp_p, char *debug_str)
<span class="lineNum">     891 </span>            :  * Description: Define a string to be associated with all debug output
<span class="lineNum">     892 </span>            :  *              for this SDP. The string will be copied into the SDP
<span class="lineNum">     893 </span>            :  *              structure and so the library will not be dependent on
<span class="lineNum">     894 </span>            :  *              the application's memory for this string.
<span class="lineNum">     895 </span>            :  * Parameters:  sdp_p      The SDP handle returned by sdp_init_description.
<span class="lineNum">     896 </span>            :  *              debug_str  Pointer to a string that should be printed out
<span class="lineNum">     897 </span>            :  *                         with every debug msg.
<a name="898"><span class="lineNum">     898 </span>            :  * Returns:     Nothing.</a>
<span class="lineNum">     899 </span>            :  */
<span class="lineNum">     900 </span><span class="lineNoCov">          0 : void sdp_set_string_debug (sdp_t *sdp_p, const char *debug_str)</span>
<span class="lineNum">     901 </span>            : {
<span class="lineNum">     902 </span><span class="lineNoCov">          0 :     if (!sdp_p) {</span>
<span class="lineNum">     903 </span><span class="lineNoCov">          0 :         return;</span>
<span class="lineNum">     904 </span>            :     }
<span class="lineNum">     905 </span>            : 
<span class="lineNum">     906 </span><span class="lineNoCov">          0 :     sstrncpy(sdp_p-&gt;debug_str, debug_str, sizeof(sdp_p-&gt;debug_str));</span>
<span class="lineNum">     907 </span>            : }
<span class="lineNum">     908 </span>            : 
<span class="lineNum">     909 </span>            : 
<span class="lineNum">     910 </span>            : /* Function:    sdp_validate_sdp
<span class="lineNum">     911 </span>            :  * Description: Validate an SDP structure.
<span class="lineNum">     912 </span>            :  * Parameters:  sdp_p    The SDP handle of the struct to validate.
<span class="lineNum">     913 </span>            :  * Returns:     A result value indicating if the validation was successful.
<a name="914"><span class="lineNum">     914 </span>            :  *              If not, what type of error was encountered.</a>
<span class="lineNum">     915 </span>            :  */
<span class="lineNum">     916 </span><span class="lineNoCov">          0 : sdp_result_e sdp_validate_sdp (sdp_t *sdp_p)</span>
<span class="lineNum">     917 </span>            : {
<span class="lineNum">     918 </span>            :     int i;
<span class="lineNum">     919 </span>            :     uint16_t num_media_levels;
<span class="lineNum">     920 </span>            : 
<span class="lineNum">     921 </span>            :     /* Need to validate c= info is specified at session level or
<span class="lineNum">     922 </span>            :      * at all m= levels.
<span class="lineNum">     923 </span>            :      */
<span class="lineNum">     924 </span><span class="lineNoCov">          0 :     if (sdp_connection_valid((void *)sdp_p, SDP_SESSION_LEVEL) == FALSE) {</span>
<span class="lineNum">     925 </span><span class="lineNoCov">          0 :         num_media_levels = sdp_get_num_media_lines((void *)sdp_p);</span>
<span class="lineNum">     926 </span><span class="lineNoCov">          0 :         for (i=1; i &lt;= num_media_levels; i++) {</span>
<span class="lineNum">     927 </span><span class="lineNoCov">          0 :             if (sdp_connection_valid((void *)sdp_p, (unsigned short)i) == FALSE) {</span>
<span class="lineNum">     928 </span><span class="lineNoCov">          0 :                 sdp_parse_error(sdp_p,</span>
<span class="lineNum">     929 </span>            :                     &quot;%s c= connection line not specified for &quot;
<span class="lineNum">     930 </span>            :                     &quot;every media level, validation failed.&quot;,
<span class="lineNum">     931 </span><span class="lineNoCov">          0 :                     sdp_p-&gt;debug_str);</span>
<span class="lineNum">     932 </span><span class="lineNoCov">          0 :                 return (SDP_FAILURE);</span>
<span class="lineNum">     933 </span>            :             }
<span class="lineNum">     934 </span>            :         }
<span class="lineNum">     935 </span>            :     }
<span class="lineNum">     936 </span>            : 
<span class="lineNum">     937 </span>            :     /* Validate required lines were specified */
<span class="lineNum">     938 </span><span class="lineNoCov">          0 :     if ((sdp_owner_valid((void *)sdp_p) == FALSE) &amp;&amp;</span>
<span class="lineNum">     939 </span><span class="lineNoCov">          0 :         (sdp_p-&gt;conf_p-&gt;owner_reqd == TRUE)) {</span>
<span class="lineNum">     940 </span><span class="lineNoCov">          0 :         sdp_parse_error(sdp_p,</span>
<span class="lineNum">     941 </span>            :             &quot;%s o= owner line not specified, validation failed.&quot;,
<span class="lineNum">     942 </span><span class="lineNoCov">          0 :             sdp_p-&gt;debug_str);</span>
<span class="lineNum">     943 </span><span class="lineNoCov">          0 :         return (SDP_FAILURE);</span>
<span class="lineNum">     944 </span>            :     }
<span class="lineNum">     945 </span>            : 
<span class="lineNum">     946 </span><span class="lineNoCov">          0 :     if ((sdp_session_name_valid((void *)sdp_p) == FALSE) &amp;&amp;</span>
<span class="lineNum">     947 </span><span class="lineNoCov">          0 :         (sdp_p-&gt;conf_p-&gt;session_name_reqd == TRUE)) {</span>
<span class="lineNum">     948 </span><span class="lineNoCov">          0 :         sdp_parse_error(sdp_p,</span>
<span class="lineNum">     949 </span>            :             &quot;%s s= session name line not specified, validation failed.&quot;,
<span class="lineNum">     950 </span><span class="lineNoCov">          0 :             sdp_p-&gt;debug_str);</span>
<span class="lineNum">     951 </span><span class="lineNoCov">          0 :         return (SDP_FAILURE);</span>
<span class="lineNum">     952 </span>            :     }
<span class="lineNum">     953 </span>            : 
<span class="lineNum">     954 </span><span class="lineNoCov">          0 :     if ((sdp_timespec_valid((void *)sdp_p) == FALSE) &amp;&amp;</span>
<span class="lineNum">     955 </span><span class="lineNoCov">          0 :         (sdp_p-&gt;conf_p-&gt;timespec_reqd == TRUE)) {</span>
<span class="lineNum">     956 </span><span class="lineNoCov">          0 :         sdp_parse_error(sdp_p,</span>
<span class="lineNum">     957 </span>            :             &quot;%s t= timespec line not specified, validation failed.&quot;,
<span class="lineNum">     958 </span><span class="lineNoCov">          0 :             sdp_p-&gt;debug_str);</span>
<span class="lineNum">     959 </span><span class="lineNoCov">          0 :         return (SDP_FAILURE);</span>
<span class="lineNum">     960 </span>            :     }
<span class="lineNum">     961 </span>            : 
<span class="lineNum">     962 </span><span class="lineNoCov">          0 :     return (SDP_SUCCESS);</span>
<span class="lineNum">     963 </span>            : }
<span class="lineNum">     964 </span>            : 
<span class="lineNum">     965 </span>            : /* Function:    sdp_parse
<span class="lineNum">     966 </span>            :  * Description: Parse an SDP description in the specified buffer.
<span class="lineNum">     967 </span>            :  * Parameters:  sdp_p    The SDP handle returned by sdp_init_description
<span class="lineNum">     968 </span>            :  *              bufp     Pointer to the buffer containing the SDP
<span class="lineNum">     969 </span>            :  *                       description to parse.
<span class="lineNum">     970 </span>            :  *              len      The length of the buffer.
<span class="lineNum">     971 </span>            :  * Returns:     A result value indicating if the parse was successful and
<span class="lineNum">     972 </span>            :  *              if not, what type of error was encountered.  The
<a name="973"><span class="lineNum">     973 </span>            :  *              information from the parse is stored in the sdp_p structure.</a>
<span class="lineNum">     974 </span>            :  */
<span class="lineNum">     975 </span><span class="lineNoCov">          0 : sdp_result_e sdp_parse (sdp_t *sdp_p, const char *buf, size_t len)</span>
<span class="lineNum">     976 </span>            : {
<span class="lineNum">     977 </span>            :     uint8_t           i;
<span class="lineNum">     978 </span><span class="lineNoCov">          0 :     uint16_t          cur_level = SDP_SESSION_LEVEL;</span>
<span class="lineNum">     979 </span>            :     const char  *ptr;
<span class="lineNum">     980 </span><span class="lineNoCov">          0 :     const char  *next_ptr = NULL;</span>
<span class="lineNum">     981 </span>            :     char        *line_end;
<span class="lineNum">     982 </span><span class="lineNoCov">          0 :     sdp_token_e  last_token = SDP_TOKEN_V;</span>
<span class="lineNum">     983 </span><span class="lineNoCov">          0 :     sdp_result_e result = SDP_SUCCESS;</span>
<span class="lineNum">     984 </span><span class="lineNoCov">          0 :     tinybool     parse_done = FALSE;</span>
<span class="lineNum">     985 </span><span class="lineNoCov">          0 :     tinybool     end_found = FALSE;</span>
<span class="lineNum">     986 </span><span class="lineNoCov">          0 :     tinybool     first_line = TRUE;</span>
<span class="lineNum">     987 </span><span class="lineNoCov">          0 :     tinybool     unrec_token = FALSE;</span>
<span class="lineNum">     988 </span><span class="lineNoCov">          0 :     const char   **bufp = &amp;buf;</span>
<span class="lineNum">     989 </span>            : 
<span class="lineNum">     990 </span><span class="lineNoCov">          0 :     if (!sdp_p) {</span>
<span class="lineNum">     991 </span><span class="lineNoCov">          0 :         return (SDP_INVALID_SDP_PTR);</span>
<span class="lineNum">     992 </span>            :     }
<span class="lineNum">     993 </span>            : 
<span class="lineNum">     994 </span><span class="lineNoCov">          0 :     if ((bufp == NULL) || (*bufp == NULL)) {</span>
<span class="lineNum">     995 </span><span class="lineNoCov">          0 :         return (SDP_NULL_BUF_PTR);</span>
<span class="lineNum">     996 </span>            :     }
<span class="lineNum">     997 </span>            : 
<span class="lineNum">     998 </span><span class="lineNoCov">          0 :     if (sdp_p-&gt;debug_flag[SDP_DEBUG_TRACE]) {</span>
<span class="lineNum">     999 </span><span class="lineNoCov">          0 :         SDP_PRINT(&quot;%s Trace SDP Parse:&quot;, sdp_p-&gt;debug_str);</span>
<span class="lineNum">    1000 </span>            :     }
<span class="lineNum">    1001 </span>            : 
<span class="lineNum">    1002 </span><span class="lineNoCov">          0 :     next_ptr = *bufp;</span>
<span class="lineNum">    1003 </span><span class="lineNoCov">          0 :     sdp_p-&gt;conf_p-&gt;num_parses++;</span>
<span class="lineNum">    1004 </span>            : 
<span class="lineNum">    1005 </span>            :     /* Initialize the last valid capability instance to zero.  Used
<span class="lineNum">    1006 </span>            :      * to help in parsing X-cpar attrs. */
<span class="lineNum">    1007 </span><span class="lineNoCov">          0 :     sdp_p-&gt;cap_valid = FALSE;</span>
<span class="lineNum">    1008 </span><span class="lineNoCov">          0 :     sdp_p-&gt;last_cap_inst = 0;</span>
<span class="lineNum">    1009 </span>            : 
<span class="lineNum">    1010 </span><span class="lineNoCov">          0 :     sdp_p-&gt;parse_line = 0;</span>
<span class="lineNum">    1011 </span>            : 
<span class="lineNum">    1012 </span>            :     /* We want to try to find the end of the SDP description, even if
<span class="lineNum">    1013 </span>            :      * we find a parsing error.
<span class="lineNum">    1014 </span>            :      */
<span class="lineNum">    1015 </span><span class="lineNoCov">          0 :     while (!end_found) {</span>
<span class="lineNum">    1016 </span>            :         /* If the last char of this line goes beyond the end of the buffer,
<span class="lineNum">    1017 </span>            :          * we don't parse it.
<span class="lineNum">    1018 </span>            :          */
<span class="lineNum">    1019 </span><span class="lineNoCov">          0 :         ptr = next_ptr;</span>
<span class="lineNum">    1020 </span><span class="lineNoCov">          0 :         sdp_p-&gt;parse_line++;</span>
<span class="lineNum">    1021 </span><span class="lineNoCov">          0 :         line_end = sdp_findchar(ptr, &quot;\n&quot;);</span>
<span class="lineNum">    1022 </span><span class="lineNoCov">          0 :         if ((line_end &gt;= (*bufp + len)) ||</span>
<span class="lineNum">    1023 </span><span class="lineNoCov">          0 :            (*line_end == '\0')) {</span>
<span class="lineNum">    1024 </span>            :             /* As this does not update the result value the SDP up to this point
<span class="lineNum">    1025 </span>            :              * is still accept as valid. So encountering this is not treated as
<span class="lineNum">    1026 </span>            :              * an error.
<span class="lineNum">    1027 </span>            :              */
<span class="lineNum">    1028 </span><span class="lineNoCov">          0 :             sdp_parse_error(sdp_p,</span>
<span class="lineNum">    1029 </span>            :                 &quot;%s End of line beyond end of buffer.&quot;,
<span class="lineNum">    1030 </span><span class="lineNoCov">          0 :                 sdp_p-&gt;debug_str);</span>
<span class="lineNum">    1031 </span><span class="lineNoCov">          0 :             CSFLogError(logTag, &quot;SDP: Invalid SDP, no \\n (len %u): %*s&quot;,</span>
<span class="lineNum">    1032 </span>            :                         (unsigned)len, (int)len, *bufp);
<span class="lineNum">    1033 </span><span class="lineNoCov">          0 :             end_found = TRUE;</span>
<span class="lineNum">    1034 </span><span class="lineNoCov">          0 :             break;</span>
<span class="lineNum">    1035 </span>            :         }
<span class="lineNum">    1036 </span>            : 
<span class="lineNum">    1037 </span>            :         /* Print the line if we're tracing. */
<span class="lineNum">    1038 </span><span class="lineNoCov">          0 :         if ((parse_done == FALSE) &amp;&amp;</span>
<span class="lineNum">    1039 </span><span class="lineNoCov">          0 :           (sdp_p-&gt;debug_flag[SDP_DEBUG_TRACE])) {</span>
<span class="lineNum">    1040 </span><span class="lineNoCov">          0 :             SDP_PRINT(&quot;%s &quot;, sdp_p-&gt;debug_str);</span>
<span class="lineNum">    1041 </span>            : 
<span class="lineNum">    1042 </span><span class="lineNoCov">          0 :             SDP_PRINT(&quot;%*s&quot;, (int)(line_end - ptr), ptr);</span>
<span class="lineNum">    1043 </span>            : 
<span class="lineNum">    1044 </span>            :         }
<span class="lineNum">    1045 </span>            : 
<span class="lineNum">    1046 </span>            :         /* Find out which token this line has, if any. */
<span class="lineNum">    1047 </span><span class="lineNoCov">          0 :         for (i=0; i &lt; SDP_MAX_TOKENS; i++) {</span>
<span class="lineNum">    1048 </span><span class="lineNoCov">          0 :             if (strncmp(ptr, sdp_token[i].name, SDP_TOKEN_LEN) == 0) {</span>
<span class="lineNum">    1049 </span><span class="lineNoCov">          0 :                 break;</span>
<span class="lineNum">    1050 </span>            :             }
<span class="lineNum">    1051 </span>            :         }
<span class="lineNum">    1052 </span><span class="lineNoCov">          0 :         if (i == SDP_MAX_TOKENS) {</span>
<span class="lineNum">    1053 </span>            :             /* See if the second char on the next line is an '=' char.
<span class="lineNum">    1054 </span>            :              * If so, we note this as an unrecognized token line. */
<span class="lineNum">    1055 </span><span class="lineNoCov">          0 :             if (ptr[1] == '=') {</span>
<span class="lineNum">    1056 </span><span class="lineNoCov">          0 :                 unrec_token = TRUE;</span>
<span class="lineNum">    1057 </span>            :             }
<span class="lineNum">    1058 </span><span class="lineNoCov">          0 :             if (first_line == TRUE) {</span>
<span class="lineNum">    1059 </span><span class="lineNoCov">          0 :                 sdp_parse_error(sdp_p,</span>
<span class="lineNum">    1060 </span>            :                     &quot;%s Attempt to parse text not recognized as &quot;
<span class="lineNum">    1061 </span><span class="lineNoCov">          0 :                     &quot;SDP text, parse fails.&quot;, sdp_p-&gt;debug_str);</span>
<span class="lineNum">    1062 </span>            :                     /* If we haven't already printed out the line we
<span class="lineNum">    1063 </span>            :                      * were trying to parse, do it now.
<span class="lineNum">    1064 </span>            :                      */
<span class="lineNum">    1065 </span><span class="lineNoCov">          0 :                 if (!sdp_p-&gt;debug_flag[SDP_DEBUG_TRACE]) {</span>
<span class="lineNum">    1066 </span><span class="lineNoCov">          0 :                     SDP_PRINT(&quot;%s &quot;, sdp_p-&gt;debug_str);</span>
<span class="lineNum">    1067 </span><span class="lineNoCov">          0 :                     SDP_PRINT(&quot;%*s&quot;, (int)(line_end - ptr), ptr);</span>
<span class="lineNum">    1068 </span>            :                 }
<span class="lineNum">    1069 </span><span class="lineNoCov">          0 :                 sdp_p-&gt;conf_p-&gt;num_not_sdp_desc++;</span>
<span class="lineNum">    1070 </span><span class="lineNoCov">          0 :                 return (SDP_NOT_SDP_DESCRIPTION);</span>
<span class="lineNum">    1071 </span>            :             } else {
<span class="lineNum">    1072 </span><span class="lineNoCov">          0 :                 end_found = TRUE;</span>
<span class="lineNum">    1073 </span><span class="lineNoCov">          0 :                 break;</span>
<span class="lineNum">    1074 </span>            :             }
<span class="lineNum">    1075 </span>            :         }
<span class="lineNum">    1076 </span>            : 
<span class="lineNum">    1077 </span>            :         /* This is the beginning of a new SDP description. */
<span class="lineNum">    1078 </span><span class="lineNoCov">          0 :         if ((first_line != TRUE) &amp;&amp; (i == SDP_TOKEN_V)) {</span>
<span class="lineNum">    1079 </span><span class="lineNoCov">          0 :             end_found = TRUE;</span>
<span class="lineNum">    1080 </span><span class="lineNoCov">          0 :             break;</span>
<span class="lineNum">    1081 </span>            :         }
<span class="lineNum">    1082 </span>            : 
<span class="lineNum">    1083 </span>            :         /* Advance the next ptr to one char beyond the end of the line. */
<span class="lineNum">    1084 </span><span class="lineNoCov">          0 :         next_ptr = line_end + 1;</span>
<span class="lineNum">    1085 </span><span class="lineNoCov">          0 :         if (next_ptr &gt;= (*bufp + len)) {</span>
<span class="lineNum">    1086 </span><span class="lineNoCov">          0 :             end_found = TRUE;</span>
<span class="lineNum">    1087 </span>            :         }
<span class="lineNum">    1088 </span>            : 
<span class="lineNum">    1089 </span>            :         /* If we've finished parsing and are just looking for the end of
<span class="lineNum">    1090 </span>            :          * the SDP description, we don't need to do anything else here.
<span class="lineNum">    1091 </span>            :          */
<span class="lineNum">    1092 </span><span class="lineNoCov">          0 :         if (parse_done == TRUE) {</span>
<span class="lineNum">    1093 </span><span class="lineNoCov">          0 :             continue;</span>
<span class="lineNum">    1094 </span>            :         }
<span class="lineNum">    1095 </span>            : 
<span class="lineNum">    1096 </span>            :         /* Only certain tokens are valid at the media level. */
<span class="lineNum">    1097 </span><span class="lineNoCov">          0 :         if (cur_level != SDP_SESSION_LEVEL) {</span>
<span class="lineNum">    1098 </span><span class="lineNoCov">          0 :             if ((i != SDP_TOKEN_I) &amp;&amp; (i != SDP_TOKEN_C) &amp;&amp;</span>
<span class="lineNum">    1099 </span><span class="lineNoCov">          0 :                 (i != SDP_TOKEN_B) &amp;&amp; (i != SDP_TOKEN_K) &amp;&amp;</span>
<span class="lineNum">    1100 </span><span class="lineNoCov">          0 :                 (i != SDP_TOKEN_A) &amp;&amp; (i != SDP_TOKEN_M)) {</span>
<span class="lineNum">    1101 </span><span class="lineNoCov">          0 :                 sdp_p-&gt;conf_p-&gt;num_invalid_token_order++;</span>
<span class="lineNum">    1102 </span><span class="lineNoCov">          0 :                 sdp_parse_error(sdp_p,</span>
<span class="lineNum">    1103 </span>            :                     &quot;%s Warning: Invalid token %s found at media level&quot;,
<span class="lineNum">    1104 </span><span class="lineNoCov">          0 :                     sdp_p-&gt;debug_str, sdp_token[i].name);</span>
<span class="lineNum">    1105 </span><span class="lineNoCov">          0 :                 continue;</span>
<span class="lineNum">    1106 </span>            :             }
<span class="lineNum">    1107 </span>            :         }
<span class="lineNum">    1108 </span>            : 
<span class="lineNum">    1109 </span>            :         /* Verify the token ordering. */
<span class="lineNum">    1110 </span><span class="lineNoCov">          0 :         if (first_line == TRUE) {</span>
<span class="lineNum">    1111 </span><span class="lineNoCov">          0 :             if (i != SDP_TOKEN_V) {</span>
<span class="lineNum">    1112 </span><span class="lineNoCov">          0 :                 if (sdp_p-&gt;conf_p-&gt;version_reqd == TRUE) {</span>
<span class="lineNum">    1113 </span><span class="lineNoCov">          0 :                     sdp_parse_error(sdp_p,</span>
<span class="lineNum">    1114 </span>            :                         &quot;%s First line not v=, parse fails&quot;,
<span class="lineNum">    1115 </span><span class="lineNoCov">          0 :                         sdp_p-&gt;debug_str);</span>
<span class="lineNum">    1116 </span><span class="lineNoCov">          0 :                     sdp_p-&gt;conf_p-&gt;num_invalid_token_order++;</span>
<span class="lineNum">    1117 </span><span class="lineNoCov">          0 :                     result = SDP_INVALID_TOKEN_ORDERING;</span>
<span class="lineNum">    1118 </span><span class="lineNoCov">          0 :                     parse_done = TRUE;</span>
<span class="lineNum">    1119 </span>            :                 } else {
<span class="lineNum">    1120 </span><span class="lineNoCov">          0 :                     last_token = (sdp_token_e)i;</span>
<span class="lineNum">    1121 </span>            :                 }
<span class="lineNum">    1122 </span>            :             } else {
<span class="lineNum">    1123 </span><span class="lineNoCov">          0 :                 last_token = (sdp_token_e)i;</span>
<span class="lineNum">    1124 </span>            :             }
<span class="lineNum">    1125 </span><span class="lineNoCov">          0 :             first_line = FALSE;</span>
<span class="lineNum">    1126 </span>            :         } else {
<span class="lineNum">    1127 </span><span class="lineNoCov">          0 :             if (i &lt; last_token) {</span>
<span class="lineNum">    1128 </span><span class="lineNoCov">          0 :                 sdp_p-&gt;conf_p-&gt;num_invalid_token_order++;</span>
<span class="lineNum">    1129 </span><span class="lineNoCov">          0 :                 sdp_parse_error(sdp_p,</span>
<span class="lineNum">    1130 </span>            :                     &quot;%s Warning: Invalid token ordering detected, &quot;
<span class="lineNum">    1131 </span><span class="lineNoCov">          0 :                     &quot;token %s found after token %s&quot;, sdp_p-&gt;debug_str,</span>
<span class="lineNum">    1132 </span>            :                     sdp_token[i].name, sdp_token[last_token].name);
<span class="lineNum">    1133 </span>            :             }
<span class="lineNum">    1134 </span>            :         }
<span class="lineNum">    1135 </span>            : 
<span class="lineNum">    1136 </span>            :         /* Finally parse the line. */
<span class="lineNum">    1137 </span><span class="lineNoCov">          0 :         ptr += SDP_TOKEN_LEN;</span>
<span class="lineNum">    1138 </span><span class="lineNoCov">          0 :         result = sdp_token[i].parse_func(sdp_p, cur_level, (const char *)ptr);</span>
<span class="lineNum">    1139 </span><span class="lineNoCov">          0 :         last_token = (sdp_token_e)i;</span>
<span class="lineNum">    1140 </span><span class="lineNoCov">          0 :         if (last_token == SDP_TOKEN_M) {</span>
<span class="lineNum">    1141 </span><span class="lineNoCov">          0 :             if (cur_level == SDP_SESSION_LEVEL) {</span>
<span class="lineNum">    1142 </span><span class="lineNoCov">          0 :                 cur_level = 1;</span>
<span class="lineNum">    1143 </span>            :             } else {
<span class="lineNum">    1144 </span><span class="lineNoCov">          0 :                 cur_level++;</span>
<span class="lineNum">    1145 </span>            :             }
<span class="lineNum">    1146 </span>            :             /* The token ordering can start again at i= */
<span class="lineNum">    1147 </span><span class="lineNoCov">          0 :             last_token = (sdp_token_e)(SDP_TOKEN_I - 1);</span>
<span class="lineNum">    1148 </span>            :         }
<span class="lineNum">    1149 </span><span class="lineNoCov">          0 :         if (result != SDP_SUCCESS) {</span>
<span class="lineNum">    1150 </span><span class="lineNoCov">          0 :             parse_done = TRUE;</span>
<span class="lineNum">    1151 </span>            :         }
<span class="lineNum">    1152 </span>            : 
<span class="lineNum">    1153 </span>            :         /* Skip the new line char at the end of this line and see if
<span class="lineNum">    1154 </span>            :          * this is the end of the buffer.
<span class="lineNum">    1155 </span>            :          */
<span class="lineNum">    1156 </span><span class="lineNoCov">          0 :         if ((line_end + 1) == (*bufp + len)) {</span>
<span class="lineNum">    1157 </span><span class="lineNoCov">          0 :             end_found = TRUE;</span>
<span class="lineNum">    1158 </span>            :         }
<span class="lineNum">    1159 </span>            :     }
<span class="lineNum">    1160 </span>            : 
<span class="lineNum">    1161 </span>            :     /* If we found no valid lines, return an error. */
<span class="lineNum">    1162 </span><span class="lineNoCov">          0 :     if (first_line == TRUE) {</span>
<span class="lineNum">    1163 </span><span class="lineNoCov">          0 :         sdp_p-&gt;conf_p-&gt;num_not_sdp_desc++;</span>
<span class="lineNum">    1164 </span><span class="lineNoCov">          0 :         return (SDP_NOT_SDP_DESCRIPTION);</span>
<span class="lineNum">    1165 </span>            :     }
<span class="lineNum">    1166 </span>            : 
<span class="lineNum">    1167 </span>            :     /* If no errors were found yet, validate the overall sdp. */
<span class="lineNum">    1168 </span><span class="lineNoCov">          0 :     if (result == SDP_SUCCESS) {</span>
<span class="lineNum">    1169 </span><span class="lineNoCov">          0 :         result = sdp_validate_sdp(sdp_p);</span>
<span class="lineNum">    1170 </span>            :     }
<span class="lineNum">    1171 </span>            :     /* Return the pointer where we left off. */
<span class="lineNum">    1172 </span><span class="lineNoCov">          0 :     *bufp = next_ptr;</span>
<span class="lineNum">    1173 </span>            :     /* If the SDP is valid, but the next line following was an
<span class="lineNum">    1174 </span>            :      * unrecognized &lt;token&gt;= line, indicate this on the return. */
<span class="lineNum">    1175 </span><span class="lineNoCov">          0 :     if ((result == SDP_SUCCESS) &amp;&amp; (unrec_token == TRUE)) {</span>
<span class="lineNum">    1176 </span><span class="lineNoCov">          0 :         return (SDP_UNRECOGNIZED_TOKEN);</span>
<span class="lineNum">    1177 </span>            :     } else {
<span class="lineNum">    1178 </span><span class="lineNoCov">          0 :         return (result);</span>
<span class="lineNum">    1179 </span>            :     }
<span class="lineNum">    1180 </span>            : }
<span class="lineNum">    1181 </span>            : 
<span class="lineNum">    1182 </span>            : 
<span class="lineNum">    1183 </span>            : /* Function:    sdp_build
<span class="lineNum">    1184 </span>            :  * Description: Build an SDP description in the specified buffer based
<span class="lineNum">    1185 </span>            :  *              on the information in the given SDP structure.
<span class="lineNum">    1186 </span>            :  * Parameters:  sdp_p    The SDP handle returned by sdp_init_description
<span class="lineNum">    1187 </span>            :  *              fs A flex_string where the SDP description should be built.
<span class="lineNum">    1188 </span>            :  * Returns:     A result value indicating if the build was successful and
<span class="lineNum">    1189 </span>            :  *              if not, what type of error was encountered - e.g.,
<a name="1190"><span class="lineNum">    1190 </span>            :  *              description was too long for the given buffer.</a>
<span class="lineNum">    1191 </span>            :  */
<span class="lineNum">    1192 </span><span class="lineNoCov">          0 : sdp_result_e sdp_build (sdp_t *sdp_p, flex_string *fs)</span>
<span class="lineNum">    1193 </span>            : {
<span class="lineNum">    1194 </span>            :     int i, j;
<span class="lineNum">    1195 </span><span class="lineNoCov">          0 :     sdp_result_e        result = SDP_SUCCESS;</span>
<span class="lineNum">    1196 </span>            : 
<span class="lineNum">    1197 </span><span class="lineNoCov">          0 :     if (!sdp_p) {</span>
<span class="lineNum">    1198 </span><span class="lineNoCov">          0 :         return (SDP_INVALID_SDP_PTR);</span>
<span class="lineNum">    1199 </span>            :     }
<span class="lineNum">    1200 </span>            : 
<span class="lineNum">    1201 </span><span class="lineNoCov">          0 :     if (!fs) {</span>
<span class="lineNum">    1202 </span><span class="lineNoCov">          0 :         return (SDP_NULL_BUF_PTR);</span>
<span class="lineNum">    1203 </span>            :     }
<span class="lineNum">    1204 </span>            : 
<span class="lineNum">    1205 </span><span class="lineNoCov">          0 :     if (sdp_p-&gt;debug_flag[SDP_DEBUG_TRACE]) {</span>
<span class="lineNum">    1206 </span><span class="lineNoCov">          0 :         SDP_PRINT(&quot;%s Trace SDP Build:&quot;, sdp_p-&gt;debug_str);</span>
<span class="lineNum">    1207 </span>            :     }
<span class="lineNum">    1208 </span>            : 
<span class="lineNum">    1209 </span><span class="lineNoCov">          0 :     sdp_p-&gt;conf_p-&gt;num_builds++;</span>
<span class="lineNum">    1210 </span>            : 
<span class="lineNum">    1211 </span><span class="lineNoCov">          0 :     for (i=0; ((i &lt; SDP_TOKEN_M) &amp;&amp;</span>
<span class="lineNum">    1212 </span><span class="lineNoCov">          0 :                (result == SDP_SUCCESS)); i++) {</span>
<span class="lineNum">    1213 </span><span class="lineNoCov">          0 :         result = sdp_token[i].build_func(sdp_p, SDP_SESSION_LEVEL, fs);</span>
<span class="lineNum">    1214 </span>            :         /* ok not to check buffer space (yet) as the if() checks it */
<span class="lineNum">    1215 </span>            :     }
<span class="lineNum">    1216 </span>            :     /* If the session level was ok, build the media lines. */
<span class="lineNum">    1217 </span><span class="lineNoCov">          0 :     if (result == SDP_SUCCESS) {</span>
<span class="lineNum">    1218 </span><span class="lineNoCov">          0 :         for (i=1; ((i &lt;= sdp_p-&gt;mca_count) &amp;&amp;</span>
<span class="lineNum">    1219 </span><span class="lineNoCov">          0 :                    (result == SDP_SUCCESS)); i++) {</span>
<span class="lineNum">    1220 </span><span class="lineNoCov">          0 :             result = sdp_token[SDP_TOKEN_M].build_func(sdp_p, (uint16_t)i, fs);</span>
<span class="lineNum">    1221 </span>            : 
<span class="lineNum">    1222 </span>            :             /* ok not to check buffer space (yet) as the for() checks it */
<span class="lineNum">    1223 </span><span class="lineNoCov">          0 :             for (j=SDP_TOKEN_I;</span>
<span class="lineNum">    1224 </span><span class="lineNoCov">          0 :                  ((j &lt; SDP_TOKEN_M) &amp;&amp; (result == SDP_SUCCESS));</span>
<span class="lineNum">    1225 </span><span class="lineNoCov">          0 :                  j++) {</span>
<span class="lineNum">    1226 </span><span class="lineNoCov">          0 :                 if ((j == SDP_TOKEN_U) || (j == SDP_TOKEN_E) ||</span>
<span class="lineNum">    1227 </span><span class="lineNoCov">          0 :                     (j == SDP_TOKEN_P) || (j == SDP_TOKEN_T) ||</span>
<span class="lineNum">    1228 </span><span class="lineNoCov">          0 :                     (j == SDP_TOKEN_R) || (j == SDP_TOKEN_Z)) {</span>
<span class="lineNum">    1229 </span>            :                     /* These tokens not valid at media level. */
<span class="lineNum">    1230 </span><span class="lineNoCov">          0 :                     continue;</span>
<span class="lineNum">    1231 </span>            :                 }
<span class="lineNum">    1232 </span><span class="lineNoCov">          0 :                 result = sdp_token[j].build_func(sdp_p, (uint16_t)i, fs);</span>
<span class="lineNum">    1233 </span>            :                 /* ok not to check buffer space (yet) as the for() checks it */
<span class="lineNum">    1234 </span>            :             }
<span class="lineNum">    1235 </span>            :         }
<span class="lineNum">    1236 </span>            :     }
<span class="lineNum">    1237 </span>            : 
<span class="lineNum">    1238 </span><span class="lineNoCov">          0 :     return (result);</span>
<span class="lineNum">    1239 </span>            : }
<span class="lineNum">    1240 </span>            : 
<span class="lineNum">    1241 </span>            : /* Function:    sdp_free_description
<span class="lineNum">    1242 </span>            :  * Description: Free an SDP description and all memory associated with it.
<span class="lineNum">    1243 </span>            :  * Parameters:  sdp_p  The SDP handle returned by sdp_init_description
<span class="lineNum">    1244 </span>            :  * Returns:     A result value indicating if the free was successful and
<span class="lineNum">    1245 </span>            :  *              if not, what type of error was encountered - e.g., sdp_p
<a name="1246"><span class="lineNum">    1246 </span>            :  *              was invalid and didn't point to an SDP structure.</a>
<span class="lineNum">    1247 </span>            : */
<span class="lineNum">    1248 </span><span class="lineNoCov">          0 : sdp_result_e sdp_free_description (sdp_t *sdp_p)</span>
<span class="lineNum">    1249 </span>            : {
<span class="lineNum">    1250 </span>            :     sdp_timespec_t  *time_p, *next_time_p;
<span class="lineNum">    1251 </span>            :     sdp_attr_t      *attr_p, *next_attr_p;
<span class="lineNum">    1252 </span>            :     sdp_mca_t       *mca_p, *next_mca_p;
<span class="lineNum">    1253 </span>            :     sdp_bw_t        *bw_p;
<span class="lineNum">    1254 </span>            :     sdp_bw_data_t   *bw_data_p;
<span class="lineNum">    1255 </span>            : 
<span class="lineNum">    1256 </span><span class="lineNoCov">          0 :     if (!sdp_p) {</span>
<span class="lineNum">    1257 </span><span class="lineNoCov">          0 :         return (SDP_INVALID_SDP_PTR);</span>
<span class="lineNum">    1258 </span>            :     }
<span class="lineNum">    1259 </span>            : 
<span class="lineNum">    1260 </span>            :     /* Free the config structure */
<span class="lineNum">    1261 </span><span class="lineNoCov">          0 :     sdp_free_config(sdp_p-&gt;conf_p);</span>
<span class="lineNum">    1262 </span>            : 
<span class="lineNum">    1263 </span>            :     /* Free any timespec structures - should be only one since
<span class="lineNum">    1264 </span>            :      * this is all we currently support.
<span class="lineNum">    1265 </span>            :      */
<span class="lineNum">    1266 </span><span class="lineNoCov">          0 :     time_p = sdp_p-&gt;timespec_p;</span>
<span class="lineNum">    1267 </span><span class="lineNoCov">          0 :     while (time_p != NULL) {</span>
<span class="lineNum">    1268 </span><span class="lineNoCov">          0 :         next_time_p = time_p-&gt;next_p;</span>
<span class="lineNum">    1269 </span><span class="lineNoCov">          0 :         SDP_FREE(time_p);</span>
<span class="lineNum">    1270 </span><span class="lineNoCov">          0 :         time_p = next_time_p;</span>
<span class="lineNum">    1271 </span>            :     }
<span class="lineNum">    1272 </span>            : 
<span class="lineNum">    1273 </span><span class="lineNoCov">          0 :     bw_p = &amp;(sdp_p-&gt;bw);</span>
<span class="lineNum">    1274 </span><span class="lineNoCov">          0 :     bw_data_p = bw_p-&gt;bw_data_list;</span>
<span class="lineNum">    1275 </span><span class="lineNoCov">          0 :     while (bw_data_p != NULL) {</span>
<span class="lineNum">    1276 </span><span class="lineNoCov">          0 :         bw_p-&gt;bw_data_list = bw_data_p-&gt;next_p;</span>
<span class="lineNum">    1277 </span><span class="lineNoCov">          0 :         SDP_FREE(bw_data_p);</span>
<span class="lineNum">    1278 </span><span class="lineNoCov">          0 :         bw_data_p = bw_p-&gt;bw_data_list;</span>
<span class="lineNum">    1279 </span>            :     }
<span class="lineNum">    1280 </span>            : 
<span class="lineNum">    1281 </span>            :     /* Free any session attr structures */
<span class="lineNum">    1282 </span><span class="lineNoCov">          0 :     attr_p = sdp_p-&gt;sess_attrs_p;</span>
<span class="lineNum">    1283 </span><span class="lineNoCov">          0 :     while (attr_p != NULL) {</span>
<span class="lineNum">    1284 </span><span class="lineNoCov">          0 :         next_attr_p = attr_p-&gt;next_p;</span>
<span class="lineNum">    1285 </span><span class="lineNoCov">          0 :         sdp_free_attr(attr_p);</span>
<span class="lineNum">    1286 </span><span class="lineNoCov">          0 :         attr_p = next_attr_p;</span>
<span class="lineNum">    1287 </span>            :     }
<span class="lineNum">    1288 </span>            : 
<span class="lineNum">    1289 </span>            :     /* Free any mca structures */
<span class="lineNum">    1290 </span><span class="lineNoCov">          0 :     mca_p = sdp_p-&gt;mca_p;</span>
<span class="lineNum">    1291 </span><span class="lineNoCov">          0 :     while (mca_p != NULL) {</span>
<span class="lineNum">    1292 </span><span class="lineNoCov">          0 :         next_mca_p = mca_p-&gt;next_p;</span>
<span class="lineNum">    1293 </span>            : 
<span class="lineNum">    1294 </span>            :         /* Free any media attr structures */
<span class="lineNum">    1295 </span><span class="lineNoCov">          0 :         attr_p = mca_p-&gt;media_attrs_p;</span>
<span class="lineNum">    1296 </span><span class="lineNoCov">          0 :         while (attr_p != NULL) {</span>
<span class="lineNum">    1297 </span><span class="lineNoCov">          0 :             next_attr_p = attr_p-&gt;next_p;</span>
<span class="lineNum">    1298 </span><span class="lineNoCov">          0 :             sdp_free_attr(attr_p);</span>
<span class="lineNum">    1299 </span><span class="lineNoCov">          0 :             attr_p = next_attr_p;</span>
<span class="lineNum">    1300 </span>            :         }
<span class="lineNum">    1301 </span>            : 
<span class="lineNum">    1302 </span>            :         /* Free the media profiles struct if allocated. */
<span class="lineNum">    1303 </span><span class="lineNoCov">          0 :         if (mca_p-&gt;media_profiles_p != NULL) {</span>
<span class="lineNum">    1304 </span><span class="lineNoCov">          0 :             SDP_FREE(mca_p-&gt;media_profiles_p);</span>
<span class="lineNum">    1305 </span>            :         }
<span class="lineNum">    1306 </span>            : 
<span class="lineNum">    1307 </span><span class="lineNoCov">          0 :         bw_p = &amp;(mca_p-&gt;bw);</span>
<span class="lineNum">    1308 </span><span class="lineNoCov">          0 :         bw_data_p = bw_p-&gt;bw_data_list;</span>
<span class="lineNum">    1309 </span><span class="lineNoCov">          0 :         while (bw_data_p != NULL) {</span>
<span class="lineNum">    1310 </span><span class="lineNoCov">          0 :             bw_p-&gt;bw_data_list = bw_data_p-&gt;next_p;</span>
<span class="lineNum">    1311 </span><span class="lineNoCov">          0 :             SDP_FREE(bw_data_p);</span>
<span class="lineNum">    1312 </span><span class="lineNoCov">          0 :             bw_data_p = bw_p-&gt;bw_data_list;</span>
<span class="lineNum">    1313 </span>            :         }
<span class="lineNum">    1314 </span>            : 
<span class="lineNum">    1315 </span><span class="lineNoCov">          0 :         SDP_FREE(mca_p);</span>
<span class="lineNum">    1316 </span><span class="lineNoCov">          0 :         mca_p = next_mca_p;</span>
<span class="lineNum">    1317 </span>            :     }
<span class="lineNum">    1318 </span>            : 
<span class="lineNum">    1319 </span><span class="lineNoCov">          0 :     SDP_FREE(sdp_p);</span>
<span class="lineNum">    1320 </span>            : 
<span class="lineNum">    1321 </span><span class="lineNoCov">          0 :     return (SDP_SUCCESS);</span>
<span class="lineNum">    1322 </span>            : }
<span class="lineNum">    1323 </span>            : 
<span class="lineNum">    1324 </span>            : /*
<span class="lineNum">    1325 </span>            :  * sdp_parse_error
<a name="1326"><span class="lineNum">    1326 </span>            :  * Send SDP parsing errors to log and up to peerconnection</a>
<span class="lineNum">    1327 </span>            :  */
<span class="lineNum">    1328 </span><span class="lineNoCov">          0 : void sdp_parse_error(sdp_t* sdp, const char *format, ...) {</span>
<span class="lineNum">    1329 </span>            :     flex_string fs;
<span class="lineNum">    1330 </span>            :     va_list ap;
<span class="lineNum">    1331 </span>            : 
<span class="lineNum">    1332 </span><span class="lineNoCov">          0 :     flex_string_init(&amp;fs);</span>
<span class="lineNum">    1333 </span>            : 
<span class="lineNum">    1334 </span><span class="lineNoCov">          0 :     va_start(ap, format);</span>
<span class="lineNum">    1335 </span><span class="lineNoCov">          0 :     flex_string_vsprintf(&amp;fs, format, ap);</span>
<span class="lineNum">    1336 </span><span class="lineNoCov">          0 :     va_end(ap);</span>
<span class="lineNum">    1337 </span>            : 
<span class="lineNum">    1338 </span><span class="lineNoCov">          0 :     CSFLogError(&quot;SDP Parse&quot;, &quot;SDP Parse Error %s, line %u&quot;, fs.buffer,</span>
<span class="lineNum">    1339 </span>            :                 sdp-&gt;parse_line);
<span class="lineNum">    1340 </span>            : 
<span class="lineNum">    1341 </span><span class="lineNoCov">          0 :     if (sdp-&gt;conf_p-&gt;error_handler) {</span>
<span class="lineNum">    1342 </span><span class="lineNoCov">          0 :         sdp-&gt;conf_p-&gt;error_handler(sdp-&gt;conf_p-&gt;error_handler_context,</span>
<span class="lineNum">    1343 </span>            :                                    sdp-&gt;parse_line,
<span class="lineNum">    1344 </span><span class="lineNoCov">          0 :                                    fs.buffer);</span>
<span class="lineNum">    1345 </span>            :     }
<span class="lineNum">    1346 </span>            : 
<span class="lineNum">    1347 </span><span class="lineNoCov">          0 :     flex_string_free(&amp;fs);</span>
<span class="lineNum">    1348 </span><span class="lineNoCov">          0 : }</span>
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../../../../../../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.13</a></td></tr>
  </table>
  <br>

</body>
</html>
